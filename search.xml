<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[一个简单的checkView]]></title>
      <url>/2017/10/24/%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84checkView/</url>
      <content type="html"><![CDATA[<p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fkthe2n1e4g30b9064x6r.gif" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div></pre></td><td class="code"><pre><div class="line">public class CheckView extends View &#123;</div><div class="line">    private Context mContext;</div><div class="line">    //圆环画笔</div><div class="line">    private Paint mPaintRing;</div><div class="line">    //对号画笔</div><div class="line">    private Paint mPaintTick;</div><div class="line">    //圆的画笔</div><div class="line">    private Paint mPaintCircle;</div><div class="line"></div><div class="line">    private int unCheckBaseColor;</div><div class="line">    private int checkBaseColor;</div><div class="line">    private int checkTickColor;</div><div class="line">    private RectF mRectF = new RectF();</div><div class="line">    private float centerX, centerY;</div><div class="line">    private float[] mPoints = new float[8];</div><div class="line">    private boolean mIsChecked;</div><div class="line">    private int radius;</div><div class="line">    private float tickRadius;</div><div class="line">    private float tickRadiusOffset;</div><div class="line"></div><div class="line">    private int ringProgress = 0;</div><div class="line">    private int circleProgress = 0;</div><div class="line">    private int rightAlpha = 0;</div><div class="line">    private boolean IsAnimeRuning;</div><div class="line">    private boolean ringAnimeEnd;</div><div class="line"></div><div class="line">    private OnCheckChangeListener mCheckChangeListener;</div><div class="line">    public CheckView(Context context) &#123;</div><div class="line">        this(context, null);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public CheckView(Context context, @Nullable AttributeSet attrs) &#123;</div><div class="line">        this(context, attrs, 0);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public CheckView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">        mContext = context;</div><div class="line">        init(attrs);</div><div class="line">        initPaint();</div><div class="line">        setClickEvent();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void initPaint() &#123;</div><div class="line">        mPaintRing = new Paint(Paint.ANTI_ALIAS_FLAG);</div><div class="line">        mPaintRing.setStyle(Paint.Style.STROKE);</div><div class="line">        mPaintRing.setColor(mIsChecked ? checkBaseColor : unCheckBaseColor);</div><div class="line">        mPaintRing.setStrokeWidth(dp2px(mContext, 2.5f));</div><div class="line">        mPaintRing.setStrokeCap(Paint.Cap.ROUND);</div><div class="line"></div><div class="line">        mPaintCircle = new Paint(Paint.ANTI_ALIAS_FLAG);</div><div class="line">        mPaintCircle.setColor(checkTickColor);</div><div class="line">        mPaintCircle.setStrokeWidth(dp2px(mContext, 1));</div><div class="line"></div><div class="line">        mPaintTick = new Paint(Paint.ANTI_ALIAS_FLAG);</div><div class="line">        mPaintTick.setColor(mIsChecked ? checkTickColor : unCheckBaseColor);</div><div class="line">        mPaintTick.setStyle(Paint.Style.STROKE);</div><div class="line">        mPaintTick.setStrokeCap(Paint.Cap.ROUND);</div><div class="line">        mPaintTick.setStrokeWidth(dp2px(mContext, 2.5f));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void init(AttributeSet attrs) &#123;</div><div class="line">        TypedArray a = mContext.obtainStyledAttributes(attrs, R.styleable.CheckView);</div><div class="line">        unCheckBaseColor = a.getColor(R.styleable.CheckView_uncheck_color, getResources().getColor(R.color.tick_gray));</div><div class="line">        checkBaseColor = a.getColor(R.styleable.CheckView_check_color, getResources().getColor(R.color.tick_yellow));</div><div class="line">        checkTickColor = a.getColor(R.styleable.CheckView_check_right_color, getResources().getColor(R.color.tick_white));</div><div class="line"></div><div class="line">        a.recycle();</div><div class="line">        radius = dp2px(mContext, 30);</div><div class="line">        tickRadius = dp2px(mContext, 12);</div><div class="line">        tickRadiusOffset = dp2px(mContext, 4);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</div><div class="line">        super.onMeasure(widthMeasureSpec, heightMeasureSpec);</div><div class="line"></div><div class="line">        int width = getMySize(radius * 2, widthMeasureSpec);</div><div class="line">        int height = getMySize(radius * 2, heightMeasureSpec);</div><div class="line"></div><div class="line">        int res = Math.max(width, height);</div><div class="line"></div><div class="line">        setMeasuredDimension(res, res);</div><div class="line"></div><div class="line">        centerX = getMeasuredWidth() / 2;</div><div class="line">        centerY = getMeasuredHeight() / 2;</div><div class="line"></div><div class="line">        mRectF.set(centerX - radius, centerY - radius, centerX + radius, centerY + radius);</div><div class="line"></div><div class="line"></div><div class="line">        //设置打钩的几个点坐标</div><div class="line">        mPoints[0] = centerX - tickRadius + tickRadiusOffset;</div><div class="line">        mPoints[1] = (float) centerY;</div><div class="line">        mPoints[2] = centerX - tickRadius / 2 + tickRadiusOffset;</div><div class="line">        mPoints[3] = centerY + tickRadius / 2;</div><div class="line">        mPoints[4] = centerX - tickRadius / 2 + tickRadiusOffset;</div><div class="line">        mPoints[5] = centerY + tickRadius / 2;</div><div class="line">        mPoints[6] = centerX + tickRadius * 2 / 4 + tickRadiusOffset;</div><div class="line">        mPoints[7] = centerY - tickRadius * 2 / 4;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(final Canvas canvas) &#123;</div><div class="line">        super.onDraw(canvas);</div><div class="line"></div><div class="line">        if (!mIsChecked) &#123;</div><div class="line">            canvas.drawArc(mRectF, 90, 360, false, mPaintRing);</div><div class="line">            canvas.drawLines(mPoints, mPaintTick);</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        if (ringAnimeEnd)&#123;</div><div class="line">            mPaintCircle.setColor(checkBaseColor);</div><div class="line">            //画满黄色的圆</div><div class="line">            canvas.drawCircle(centerX,centerY,radius,mPaintCircle);</div><div class="line">            mPaintCircle.setColor(checkTickColor);</div><div class="line">        &#125;</div><div class="line">        //画圆环</div><div class="line">        canvas.drawArc(mRectF, 90, ringProgress, false, mPaintRing);</div><div class="line">        //画逐渐缩小的白圆</div><div class="line">        canvas.drawCircle(centerX,centerY,radius-circleProgress,mPaintCircle);</div><div class="line">        //画对号</div><div class="line">        mPaintTick.setAlpha(rightAlpha);</div><div class="line">        canvas.drawLines(mPoints,mPaintTick);</div><div class="line">        if (!IsAnimeRuning) &#123;</div><div class="line">            IsAnimeRuning = true;</div><div class="line">            ObjectAnimator ringAnimator = ObjectAnimator.ofInt(this,&quot;ringProgress&quot;,0,360);</div><div class="line">            ObjectAnimator circleAnimator = ObjectAnimator.ofInt(this,&quot;circleProgress&quot;,0,radius);</div><div class="line">            ObjectAnimator rightAnimator = ObjectAnimator.ofInt(this,&quot;rightAlpha&quot;,0,255);</div><div class="line">            ringAnimator.addListener(new AnimatorListenerAdapter() &#123;</div><div class="line">                @Override</div><div class="line">                public void onAnimationEnd(Animator animation) &#123;</div><div class="line">                    super.onAnimationEnd(animation);</div><div class="line">                    ringAnimeEnd = true;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            PropertyValuesHolder holder1 = PropertyValuesHolder.ofFloat(&quot;scaleX&quot;, 1f,1.2f,1f);</div><div class="line">            PropertyValuesHolder holder2 = PropertyValuesHolder.ofFloat(&quot;scaleY&quot;, 1f,1.2f,1f);</div><div class="line">            ObjectAnimator scaleAnimator = ObjectAnimator.ofPropertyValuesHolder(this, holder1, holder2);</div><div class="line">            AnimatorSet animatorSet = new AnimatorSet();</div><div class="line">            animatorSet.playSequentially(ringAnimator,circleAnimator,rightAnimator,scaleAnimator);</div><div class="line">            animatorSet.start();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    private void reset() &#123;</div><div class="line">        initPaint();</div><div class="line">        ringProgress = 0;</div><div class="line">        circleProgress = 0;</div><div class="line">        rightAlpha = 0;</div><div class="line">        IsAnimeRuning = false;</div><div class="line">        ringAnimeEnd = false;</div><div class="line">        mRectF.set(centerX - radius, centerY - radius, centerX + radius, centerY + radius);</div><div class="line"></div><div class="line">        invalidate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void setClickEvent() &#123;</div><div class="line">        this.setOnClickListener(new OnClickListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                mIsChecked = !mIsChecked;</div><div class="line">                reset();</div><div class="line">                if (mCheckChangeListener!=null)&#123;</div><div class="line">                    mCheckChangeListener.onCheckChange((TestTickView)v,mIsChecked);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //用于属性动画的getter和setter</div><div class="line">    public int getRingProgress() &#123;</div><div class="line">        return ringProgress;</div><div class="line">    &#125;</div><div class="line">    public void setRingProgress(int ringProgress) &#123;</div><div class="line">        this.ringProgress = ringProgress;</div><div class="line">        invalidate();</div><div class="line">    &#125;</div><div class="line">    public int getCircleProgress() &#123;</div><div class="line">        return circleProgress;</div><div class="line">    &#125;</div><div class="line">    public void setCircleProgress(int circleProgress) &#123;</div><div class="line">        this.circleProgress = circleProgress;</div><div class="line">        invalidate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public int getRightAlpha() &#123;</div><div class="line">        return rightAlpha;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setRightAlpha(int rightAlpha) &#123;</div><div class="line">        this.rightAlpha = rightAlpha;</div><div class="line">        invalidate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private int getMySize(int defSize, int measureSpec) &#123;</div><div class="line">        int result;</div><div class="line">        int mode = MeasureSpec.getMode(measureSpec);</div><div class="line">        int size = MeasureSpec.getSize(measureSpec);</div><div class="line"></div><div class="line">        if (mode == MeasureSpec.UNSPECIFIED || mode == MeasureSpec.AT_MOST) &#123;</div><div class="line">            result = defSize;</div><div class="line">        &#125; else &#123;</div><div class="line">            result = size;</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private static int dp2px(Context context, float dpValue) &#123;</div><div class="line">        final float scale = context.getResources().getDisplayMetrics().density;</div><div class="line">        return (int) (dpValue * scale + 0.5f);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setCheckChangeListener(OnCheckChangeListener checkChangeListener) &#123;</div><div class="line">        mCheckChangeListener = checkChangeListener;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public interface OnCheckChangeListener&#123;</div><div class="line">        void onCheckChange(TestTickView testTickView,boolean checked);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;declare-styleable name=&quot;CheckView&quot;&gt;</div><div class="line">        &lt;attr name=&quot;uncheck_color&quot; format=&quot;color&quot; /&gt;</div><div class="line">        &lt;!--选中后的基调颜色--&gt;</div><div class="line">        &lt;attr name=&quot;check_color&quot; format=&quot;color&quot; /&gt;</div><div class="line">        &lt;!--选中后钩的颜色--&gt;</div><div class="line">        &lt;attr name=&quot;check_right_color&quot; format=&quot;color&quot; /&gt;</div><div class="line">        &lt;!--圆的半径--&gt;</div><div class="line">        &lt;attr name=&quot;radius_size&quot; format=&quot;dimension&quot; /&gt;</div><div class="line">&lt;/declare-styleable&gt;</div></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[(转)中国国内可用API合集]]></title>
      <url>/2017/10/20/%E8%BD%AC-%E4%B8%AD%E5%9B%BD%E5%9B%BD%E5%86%85%E5%8F%AF%E7%94%A8API%E5%90%88%E9%9B%86/</url>
      <content type="html"><![CDATA[<h1 id="中国国内可用API合集"><a href="#中国国内可用API合集" class="headerlink" title="中国国内可用API合集"></a>中国国内可用API合集</h1><p>转自<a href="https://microzz.com/2017/02/03/API/" target="_blank" rel="external">https://microzz.com/2017/02/03/API/</a></p>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a><a href="https://microzz.com/2017/02/03/API/#%E7%9B%AE%E5%BD%95" title="目录" target="_blank" rel="external"></a>目录</h3><ul>
<li><a href="https://microzz.com/2017/02/03/API/#%E7%AC%94%E8%AE%B0" target="_blank" rel="external">笔记</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%87%BA%E8%A1%8C" target="_blank" rel="external">出行</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E8%AF%8D%E5%85%B8" target="_blank" rel="external">词典</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E7%94%B5%E5%95%86" target="_blank" rel="external">电商</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%9C%B0%E5%9B%BE" target="_blank" rel="external">地图</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E7%94%B5%E5%BD%B1" target="_blank" rel="external">电影</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF" target="_blank" rel="external">即时通讯</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%BC%80%E5%8F%91%E8%80%85%E7%BD%91%E7%AB%99" target="_blank" rel="external">开发者网站</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%BF%AB%E9%80%92%E6%9F%A5%E8%AF%A2" target="_blank" rel="external">快递查询</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E6%97%85%E6%B8%B8" target="_blank" rel="external">旅游</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E7%A4%BE%E4%BA%A4" target="_blank" rel="external">社交</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E8%A7%86%E9%A2%91" target="_blank" rel="external">视频</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%A4%A9%E6%B0%94" target="_blank" rel="external">天气</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C" target="_blank" rel="external">团队协作</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%9B%BE%E7%89%87%E4%B8%8E%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86" target="_blank" rel="external">图片与图像处理</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E5%A4%96%E5%8D%96" target="_blank" rel="external">外卖</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81" target="_blank" rel="external">消息推送</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E9%9F%B3%E4%B9%90" target="_blank" rel="external">音乐</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E4%BA%91" target="_blank" rel="external">云</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB" target="_blank" rel="external">语音识别</a></li>
<li><a href="https://microzz.com/2017/02/03/API/#%E7%BB%BC%E5%90%88" target="_blank" rel="external">综合</a></li>
</ul>
<h4 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a><a href="https://microzz.com/2017/02/03/API/#%E7%AC%94%E8%AE%B0" title="笔记" target="_blank" rel="external"></a>笔记</h4><ul>
<li><a href="https://msdn.microsoft.com/en-us/office/office365/howto/onenote-landing" target="_blank" rel="external">OneNote</a> - OneNote支持获取，复制，创建，更新，导入与导出笔记，支持为笔记添加多媒体内容，管理权限等。提供SDK和Demo。</li>
<li><a href="http://www.wiz.cn/manual/plugin/" target="_blank" rel="external">为知笔记</a> - 为知笔记Windows客户端开放了大量的API，其中绝大部分，都通过COM提供，可以在javascript, C#, C++, Delphi等语言中使用。接口通过IDL(Interface description language)语言描述。</li>
<li><a href="https://dev.yinxiang.com/" target="_blank" rel="external">印象笔记</a> - 印象笔记提供了ActionScript 3, Android, C++, Windows, iOS, Java, JavaScript, OS X, Perl, PHP, Python, Ruby等平台的SDK和完整的API参考文档，可通过API进行认证，笔记，笔记本，附件，搜索，同步等操作，同时提供企业版和本地API。</li>
<li><a href="http://note.youdao.com/open/" target="_blank" rel="external">有道云笔记</a> - 有道云笔记提供了Android SDK，同时Open API允许进行授权，用户，笔记本，笔记，分享，附件等方面的操作。</li>
</ul>
<h4 id="出行"><a href="#出行" class="headerlink" title="出行"></a><a href="https://microzz.com/2017/02/03/API/#%E5%87%BA%E8%A1%8C" title="出行" target="_blank" rel="external"></a>出行</h4><ul>
<li><a href="http://open.xiaojukeji.com/" target="_blank" rel="external">滴滴</a> - 滴滴提供了iOS和Android SDK, 可实现拉起滴滴叫车等方面的操作。</li>
<li><a href="http://developerpre.10101111.com/" target="_blank" rel="external">神州专车</a> - 神州专车提供了API模式和H5模式两种接入模式，允许进行基础信息，订单，支付，充值，用户，发票，代金券，企业等方面的操作。</li>
<li><a href="https://developer.uber.com/" target="_blank" rel="external">Uber</a> - Uber提供了Android和iOS的SDK,允许进行乘客，行程体验，司机，派送次数等四大方面的操作。</li>
</ul>
<h4 id="词典"><a href="#词典" class="headerlink" title="词典"></a><a href="https://microzz.com/2017/02/03/API/#%E8%AF%8D%E5%85%B8" title="词典" target="_blank" rel="external"></a>词典</h4><ul>
<li><a href="http://api.fanyi.baidu.com/api/trans/product/index" target="_blank" rel="external">百度翻译</a> - 百度翻译支持多种语言互相翻译，包含PHP, JS, Python, C, Java版Demo。</li>
<li><a href="https://www.microsoft.com/en-us/translator/translatorapi.aspx" target="_blank" rel="external">必应词典</a> - 微软翻译API支持文字和语音两种类型，支持多种语言互相翻译，提供C#版本Demo。</li>
<li><a href="http://open.iciba.com/?c=api" target="_blank" rel="external">金山词霸</a> - 金山词霸允许进行简单的翻译操作。</li>
<li><a href="https://www.shanbay.com/help/developer/api_v1/" target="_blank" rel="external">扇贝</a> - 扇贝提供了完整的API，允许进行用户，查询，添加学习记录，忘记单词，例句，笔记等方面的操作。</li>
<li><a href="http://fanyi.youdao.com/openapi" target="_blank" rel="external">有道词典</a> - 有道词典允许进行简单的翻译操作。</li>
</ul>
<h4 id="电商"><a href="#电商" class="headerlink" title="电商"></a><a href="https://microzz.com/2017/02/03/API/#%E7%94%B5%E5%95%86" title="电商" target="_blank" rel="external"></a>电商</h4><ul>
<li><a href="http://open.dangdang.com/" target="_blank" rel="external">当当</a> - 当当允许商家用户和网站接入授权，可进行商品，订单，图片，问答，店铺和促销等方面的操作。</li>
<li><a href="https://jos.jd.com/api/index.htm" target="_blank" rel="external">京东</a> - 京东提供了Java, PHP, .net的SDK，授权后可进行多种操作。</li>
<li><a href="http://open.suning.com/ospos/apipage/toApiListMenu.do" target="_blank" rel="external">苏宁开放服务</a> - 苏宁提供了Java, PHP, .Net, Python版本的SDK，授权后可进行多种操作。</li>
<li><a href="https://open.taobao.com/doc2/api_list.htm" target="_blank" rel="external">淘宝开放平台</a> - 淘宝提供了Java, .Net, PHP, Python版本的SDK，授权后提供多种操作。</li>
<li><a href="https://developer.amazon.com/public/zh" target="_blank" rel="external">亚马逊</a> - 亚马逊提供多种语言版本的SDK，授权后允许多种操作。</li>
</ul>
<h4 id="地图"><a href="#地图" class="headerlink" title="地图"></a><a href="https://microzz.com/2017/02/03/API/#%E5%9C%B0%E5%9B%BE" title="地图" target="_blank" rel="external"></a>地图</h4><ul>
<li><a href="http://lbsyun.baidu.com/" target="_blank" rel="external">百度地图</a> - 百度地图提供了Android, iOS版本的SDK和JavaScript API，可进行定位、地图、数据、出行、鹰眼轨迹和分析服务。</li>
<li><a href="http://lbs.amap.com/" target="_blank" rel="external">高德地图</a> - 高德地图提供了JavaScript和web服务API，Android和iOS SDK，支持地图，定位，搜索，路线规划，导航和室内地图等。</li>
<li><a href="http://lbs.qq.com/" target="_blank" rel="external">腾讯地图</a> - 腾讯地图提供了JavaScript API，Android和iOS SDK，支持定位，地图，地点搜索，路线和导航等。</li>
<li><a href="http://lbs.tianditu.com/api-new/home.html" target="_blank" rel="external">天地图</a> - 天地图提供了H5 API和JavaScript API等web API，同时提供了Android和iOS SDK，支持基础地图服务，图层管理，地图覆盖物，地图工具，地名搜索和出行规划服务。</li>
<li><a href="http://open.mapbar.com/" target="_blank" rel="external">图吧地图</a> - 图吧提供了JavaScript和Flash API，Android和iOS SDK，支持定位，地址解析，位置标注，位置截图，路线规划，周边查询，兴趣点搜索和在线导航。</li>
</ul>
<h4 id="电影"><a href="#电影" class="headerlink" title="电影"></a><a href="https://microzz.com/2017/02/03/API/#%E7%94%B5%E5%BD%B1" title="电影" target="_blank" rel="external"></a>电影</h4><ul>
<li><a href="https://developers.douban.com/wiki/?title=movie_v2" target="_blank" rel="external">豆瓣电影</a> - 豆瓣电影支持电影条目，影人条目，搜索和榜单等。</li>
<li><a href="http://www.jianshu.com/p/9855610eb1d4" target="_blank" rel="external">猫眼电影(非官方)</a> - 支持查询首页电影列表，电影详情(含评论)，本地影院和影院详情，选座。 #非官方</li>
<li><a href="https://github.com/avenwu/vplus/blob/master/doc/v%E7%94%B5%E5%BD%B1api%E6%8E%A5%E5%8F%A3.md" target="_blank" rel="external">V电影(非官方)</a> - 支持获取<a href="http://www.vmovier.com/" target="_blank" rel="external">V电影</a>网站的数据。 #非官方</li>
<li><a href="https://github.com/jokermonn/-Api/blob/master/Time.md" target="_blank" rel="external">Time时光(非官方)</a> - 支持获取<a href="http://www.mtime.com/" target="_blank" rel="external">时光网</a>网站数据。 #非官方</li>
</ul>
<h4 id="即时通讯"><a href="#即时通讯" class="headerlink" title="即时通讯"></a><a href="https://microzz.com/2017/02/03/API/#%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF" title="即时通讯" target="_blank" rel="external"></a>即时通讯</h4><ul>
<li><a href="http://www.easemob.com/" target="_blank" rel="external">环信</a> - 支持Android, iOS, WebIM, Linux, REST集成，支持多种消息类型。</li>
<li><a href="http://rongcloud.cn/" target="_blank" rel="external">融云</a> - 支持Android, iOS, Web, 游戏集成，支持多种消息类型。</li>
<li><a href="http://netease.im/" target="_blank" rel="external">网易云信</a> - 支持IM实时通讯，实时音视频，教学白班，专线电话，短信，聊天室，提供iOS, Android, Windows和Web SDK。</li>
<li><a href="https://www.qcloud.com/product/im" target="_blank" rel="external">腾讯云通信IM</a> - 提供iOS, Android, Windows和Web SDK，支持多种消息类型。</li>
</ul>
<h4 id="开发者网站"><a href="#开发者网站" class="headerlink" title="开发者网站"></a><a href="https://microzz.com/2017/02/03/API/#%E5%BC%80%E5%8F%91%E8%80%85%E7%BD%91%E7%AB%99" title="开发者网站" target="_blank" rel="external"></a>开发者网站</h4><ul>
<li><a href="https://open.coding.net/" target="_blank" rel="external">Coding</a> - 授权后可访问coding.net网站的内容。</li>
<li><a href="http://gank.io/api" target="_blank" rel="external">干货集中营</a> - 提供妹子图和Android, iOS, 前端，拓展资源等内容。</li>
<li><a href="https://www.diycode.cc/api" target="_blank" rel="external">diycode</a> - 授权后可访问diycode网站的内容。</li>
<li><a href="http://www.oschina.net/openapi" target="_blank" rel="external">开源中国</a> - 授权后可访问开源中国网站的内容。</li>
<li><a href="https://laravel-china.org/topics/3097" target="_blank" rel="external">Laravel China</a> - 授权后可访问 Laravel China 网站的内容。</li>
<li><a href="https://ruby-china.org/api-doc/" target="_blank" rel="external">Ruby China</a> - 授权后可访问Ruby China网站的内容。</li>
<li><a href="https://www.v2ex.com/p/7v9TEc53" target="_blank" rel="external">V2EX</a> - 可访问V2EX网站的内容。</li>
</ul>
<h4 id="快递查询"><a href="#快递查询" class="headerlink" title="快递查询"></a><a href="https://microzz.com/2017/02/03/API/#%E5%BF%AB%E9%80%92%E6%9F%A5%E8%AF%A2" title="快递查询" target="_blank" rel="external"></a>快递查询</h4><ul>
<li><a href="http://www.aikuaidi.cn/api/" target="_blank" rel="external">爱快递</a> - 爱快递支持国内90多家快递物流订单查询服务，免费版有使用次数限制，可用于电子商城单号跟踪,手机应用,微信快递接口等服务。</li>
<li><a href="http://www.kuaidi100.com/openapi/" target="_blank" rel="external">快递100</a> - 快递100支持300家国内国际快递，免费版有使用次数限制。</li>
<li><a href="http://www.kdniao.com/" target="_blank" rel="external">快递鸟</a> - 快递鸟支持国内外400多家快递公司，免费版有使用次数限制，包含.Net, PHP, Java版Demo。</li>
<li><a href="http://www.kuaidi.com/openapi.html" target="_blank" rel="external">快递网</a> - 快递网支持上百家快递查询服务，免费版有使用次数限制。</li>
</ul>
<h4 id="旅游"><a href="#旅游" class="headerlink" title="旅游"></a><a href="https://microzz.com/2017/02/03/API/#%E6%97%85%E6%B8%B8" title="旅游" target="_blank" rel="external"></a>旅游</h4><ul>
<li><a href="http://open.qunar.com/" target="_blank" rel="external">去哪儿</a> - 支持获取去哪儿网的内容。</li>
<li><a href="http://open.tuniu.cn/" target="_blank" rel="external">途牛</a> - 支持途牛网的内容，仅开放给供应商系统。</li>
<li><a href="http://u.ctrip.com/union/help/Termsofuse.aspx" target="_blank" rel="external">携程</a> - 支持携程网的内容。</li>
<li><a href="http://open.elong.com/wiki/API%E6%96%87%E6%A1%A3" target="_blank" rel="external">艺龙</a> - 支持获取产品数据，完成用户的预订，进行订单查询、更改或取消。提供在线工具，以及H5, Java, C#, PHP, Ruby版本的Demo。</li>
<li><a href="https://github.com/jokermonn/-Api/blob/master/12306.md" target="_blank" rel="external">12306(非官方)</a> - 支持获取12306火车票票数、票价查询。 #非官方</li>
</ul>
<h4 id="社交"><a href="#社交" class="headerlink" title="社交"></a><a href="https://microzz.com/2017/02/03/API/#%E7%A4%BE%E4%BA%A4" title="社交" target="_blank" rel="external"></a>社交</h4><ul>
<li><a href="https://open-doc.dingtalk.com/" target="_blank" rel="external">钉钉</a> - 支持免登，企业通讯录，服务窗，钉盘，地图，会话，DING，电话，音频，扫码，支付，分享等服务，提供SDK和Demo，PC版UI规范，调试工具和钉钉UI组件库。</li>
<li><a href="https://developers.douban.com/wiki/?title=guide" target="_blank" rel="external">豆瓣</a> - 支持图书，电影，音乐，同城，广播，用户，日记，相册，线上活动，论坛，回复和我去等功能，提供豆瓣组件，豆瓣标示和Demo。</li>
<li><a href="http://open.kaixin001.com/document.php" target="_blank" rel="external">开心网</a> - 支持用户信息，登录授权，好友，传播应用，支付，分享内容，消息，交互，开心网应用等内容，提供SDK，开源插件和标示素材。</li>
<li><a href="http://wiki.connect.qq.com/api%E5%88%97%E8%A1%A8" target="_blank" rel="external">QQ互联</a> - 支持用户资料，QQ会员信息，空间相册，腾讯微博资料，分享到腾讯微博，微博好友信息，财付通信息等内容，提供SDK, Demo, 以及设计资源。</li>
<li><a href="http://open.weibo.com/wiki/API" target="_blank" rel="external">微博</a> - 支持粉丝服务，微博，评论，用户，关系，账号，收藏，搜索，提醒，短链，公共服务，位置服务，地理信息，地图引擎，支付以及OAuth2.0授权等内容，提供微博标示及SDK。</li>
<li><a href="https://open.weixin.qq.com/" target="_blank" rel="external">微信</a> - 支持移动应用，网站应用，公众账号，公众号第三方平台等内容，提供SDK, Demo, 以及设计资源。</li>
</ul>
<h4 id="视频"><a href="#视频" class="headerlink" title="视频"></a><a href="https://microzz.com/2017/02/03/API/#%E8%A7%86%E9%A2%91" title="视频" target="_blank" rel="external"></a>视频</h4><ul>
<li><a href="http://open.iqiyi.com/" target="_blank" rel="external">爱奇艺</a> - 支持弹幕，全色彩播放器，高清码流，视频托管，播放爱奇艺视频，应用分发，IOCP等内容。</li>
<li><a href="https://github.com/fython/BilibiliAPIDocs" target="_blank" rel="external">Bilibili(非官方)</a> - 支持登录，我的信息，番剧专题，视频/专题收藏、关注，番剧，弹幕等。 #非官方</li>
<li><a href="http://www.lecloud.com/zh-cn/help/api.html" target="_blank" rel="external">乐视</a> - 支持标准直播，标准点播，视频发行平台，移动直播等内容，提供SDK下载。</li>
<li><a href="http://lm.tv.sohu.com/union/open_platform.do" target="_blank" rel="external">搜狐视频</a> - 支持一二级内容获取，内容分类获取，视频详情信息，专辑详情信息，分级列表获取，关键词搜索等内容。</li>
<li><a href="http://api.tudou.com/apidoc/index.php/%E9%A6%96%E9%A1%B5" target="_blank" rel="external">土豆</a> - 支持视频模块，豆单模块，影视库模块，用户模块，转帖模块，字段定义模块等内容。</li>
<li><a href="http://doc.open.youku.com/?spm=0.0.0.0.fOn6ND" target="_blank" rel="external">优酷</a> - 支持内容输出，视频搜索，智能推荐，用户登录，用户互动，用户信息，视频上传至优酷，视频互动等内容，提供SDK。</li>
</ul>
<h4 id="天气"><a href="#天气" class="headerlink" title="天气"></a><a href="https://microzz.com/2017/02/03/API/#%E5%A4%A9%E6%B0%94" title="天气" target="_blank" rel="external"></a>天气</h4><ul>
<li><a href="http://wiki.swarma.net/index.php/%E5%BD%A9%E4%BA%91%E5%A4%A9%E6%B0%94API/v2" target="_blank" rel="external">彩云天气</a> - 支持全球天气数据，两种空气质量数据，天气预报，实况天气，独家降水预报，独家空气质量预报，六种天气数据，四种生活指数数据等内容，部分功能收费。</li>
<li><a href="http://www.kancloud.cn/hefengyun/weather/222344" target="_blank" rel="external">和风天气</a> - 支持7-10天预报，实况天气，每小时预报，生活指数，灾害预警，景点天气，历史天气，城市查询等内容，仅国内数据免费。</li>
<li><a href="http://www.thinkpage.cn/doc" target="_blank" rel="external">心知天气</a> - 支持天气实况，逐日预报和历史，24小时逐小时预报，过去24小时天气历史记录，气象灾害预警，空气质量实况与城市排行，逐日和逐小时空气质量预报，过去24小时空气质量历史记录，生活指数，农历、节气、生肖，机动车尾号限行，日出日落，月初月落和月像，城市搜索等内容，仅国内数据免费。</li>
</ul>
<h4 id="团队协作"><a href="#团队协作" class="headerlink" title="团队协作"></a><a href="https://microzz.com/2017/02/03/API/#%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C" title="团队协作" target="_blank" rel="external"></a>团队协作</h4><ul>
<li><a href="https://www.teambition.com/developer/open-platform" target="_blank" rel="external">Teambition</a> - 支持详细的文档说明，部分平台提供demo。</li>
</ul>
<h4 id="图片与图像处理"><a href="#图片与图像处理" class="headerlink" title="图片与图像处理"></a><a href="https://microzz.com/2017/02/03/API/#%E5%9B%BE%E7%89%87%E4%B8%8E%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86" title="图片与图像处理" target="_blank" rel="external"></a>图片与图像处理</h4><ul>
<li><a href="https://www.v2ex.com/t/157267" target="_blank" rel="external">Bing每日壁纸(非官方)</a> - 支持图片URL和图片描述，可获取不同地区的数据。 #非官方</li>
<li><a href="https://github.com/pinguo/PGSkinPrettifyEngine" target="_blank" rel="external">Camera360</a> - 支持全帧率直播美白滤镜，提供SDK和Demo。</li>
<li><a href="http://imgsdk.com/" target="_blank" rel="external">嗨图</a> - 支持图片标注，仅提供iOS版本SDK。</li>
<li><a href="https://dev.camcard.com/?language=zh-cn" target="_blank" rel="external">名片全能王</a> - 支持精准识别几十种语言的名片，自动切边并美化名片图像，自动返回识别结果，提供多种版本SDK，收费。</li>
<li><a href="http://www.intsig.com/zh/products/camcard_for_id" target="_blank" rel="external">企业证件识别</a> - 支持身份证，驾驶证，护照等，收费。</li>
<li><a href="https://dev.camscanner.com/?language=zh-cn" target="_blank" rel="external">扫描全能王</a> - 支持图像智能剪裁，五种图像增强模式，手动调节图像细节，自动返回扫描结果等，提供iOS与Android版本SDK，收费。</li>
<li><a href="http://api1.wozhitu.com/" target="_blank" rel="external">我知图</a> - 支持相似图像搜索，图像识别匹配，图像识别关键词推荐，重复图片探测等内容。</li>
<li><a href="http://www.intsig.com/zh/products/creditcard" target="_blank" rel="external">银行卡|信用卡识别</a> - 提供SDK和API，收费。</li>
</ul>
<h4 id="外卖"><a href="#外卖" class="headerlink" title="外卖"></a><a href="https://microzz.com/2017/02/03/API/#%E5%A4%96%E5%8D%96" title="外卖" target="_blank" rel="external"></a>外卖</h4><ul>
<li><a href="http://dev.waimai.baidu.com/" target="_blank" rel="external">百度外卖</a> - 支持商户，菜品，商品，订单和基础数据等内容，提供SDK和Demo。</li>
<li><a href="http://developer.dianping.com/" target="_blank" rel="external">大众点评</a> - 支持商户，团购，在线预定，商品点评，数据统计，元数据等内容。</li>
<li><a href="http://openapi.eleme.io/v2/quickstart.html" target="_blank" rel="external">饿了么</a> - 支持查询，预定，订单，其他订单，数据推送，支付，评价，活动，账户同步，数据落地同步等内容。</li>
<li><a href="http://developer.waimai.meituan.com/doc/show" target="_blank" rel="external">美团外卖</a> - 支持门店，配送范围，菜品，药品，订单，订单推送等内容。</li>
</ul>
<h4 id="消息推送"><a href="#消息推送" class="headerlink" title="消息推送"></a><a href="https://microzz.com/2017/02/03/API/#%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81" title="消息推送" target="_blank" rel="external"></a>消息推送</h4><ul>
<li><a href="http://push.baidu.com/doc/restapi/restapi" target="_blank" rel="external">百度云推送</a> - 支持iOS, Android和服务器端，支持推送，统计，组管理等Rest API接口。服务器端支持Java, Python, PHP, REST API。提供所支持各语言版本的SDK。</li>
<li><a href="http://developer.huawei.com/push" target="_blank" rel="external">华为推送</a> - 支持Android，提供SDK。</li>
<li><a href="https://docs.jiguang.cn/jpush/server/push/rest_api_v3_push/" target="_blank" rel="external">极光</a> - 支持Android, iOS, WindowsPhone, 服务器端REST API, 提供Java, Python, PHP, Ruby, C#, Node.js等版本的SDK。</li>
<li><a href="https://leancloud.cn/docs/push_guide.html" target="_blank" rel="external">LeanCloud</a> - 支持Android, iOS, WindowsPhone和Web网页推送，使用云引擎和JavaScript创建推送，使用REST API推送消息。提供Objectvie-C(开放源码), JavaScript(开放源码), Android, Unity, .Net, WindowsPhone, Java(开放源码), Python(开放源码), PHP(开放源码), C++(开放源码), Swift(开放源码)版本SDK。同时提供Demo。</li>
<li><a href="http://xg.qq.com/" target="_blank" rel="external">腾讯信鸽</a> - 支持iOS和Android平台，服务器端采用Rest API, 同时服务器端支持Java, PHP, Python等语言并提供SDK。</li>
<li><a href="http://dev.xiaomi.com/console/appservice/push.html" target="_blank" rel="external">小米</a> - 支持Android和iOS平台，服务器端支持Java, Python并提供SDK。</li>
<li><a href="http://dev.umeng.com/push/android/api-doc" target="_blank" rel="external">友盟</a> - 支持Android和iOS平台，服务器端支持PHP, Java, Python并提供SDK。</li>
</ul>
<h4 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a><a href="https://microzz.com/2017/02/03/API/#%E9%9F%B3%E4%B9%90" title="音乐" target="_blank" rel="external"></a>音乐</h4><ul>
<li><a href="https://my.oschina.net/skiden/blog/102025" target="_blank" rel="external">百度音乐(非官方)</a> - 支持频道歌曲列表，专辑的歌曲列表，歌曲的详细信息，歌手专辑信息，搜索，歌手的所有歌曲，排行榜，所有专辑，所有歌手，歌手的专辑列表，歌手信息，歌词搜索，歌曲文件详细信息。 #非官方</li>
<li><a href="https://developers.douban.com/wiki/?title=music_v2" target="_blank" rel="external">豆瓣音乐</a> - 支持音乐信息，评论信息，标签信息，搜索音乐，某个音乐中标记最多的标签，发表、修改、删除评论，用户对音乐的所有标签等内容。</li>
<li><a href="https://github.com/kaolafm/api" target="_blank" rel="external">考拉FM</a> - 支持获取指定分类下列表和内容，搜索指定关键字内容，专辑/电台/直播详情，指定专辑下列表，指定电台播单，分类下专辑TOP50，指定期(碎片)所在专辑最新分页功能，分类下全部直播计划，版本升级接口，排行榜，精选，传统电台列表/详情/地区等。</li>
<li><a href="http://119.29.39.252/index.php/2016/10/20/1-2/" target="_blank" rel="external">酷狗音乐(非官方)</a> - 支持搜索，各种排行榜，歌手专辑信息，下载和获取播放地址。 #非官方</li>
<li><a href="http://wq.qq.com/" target="_blank" rel="external">企鹅FM</a> - 支持获取电台分类列表，电台分类下的专辑信息列表，专辑下节目信息列表，电台节目播放链接，搜索关键字相关主播/专辑/节目，主播名下专辑，特定时间段内新增主播/更新的专辑/新增的专辑等。</li>
<li><a href="https://github.com/ccchangkong/article/issues/23" target="_blank" rel="external">QQ音乐(非官方)</a> - 支持歌曲榜单，歌曲/歌词地址，歌曲图片。 #非官方</li>
<li><a href="http://open.qingting.fm/" target="_blank" rel="external">蜻蜓FM</a> - 支持OAuth2.0授权，音频数据中心，分类，点播，直播，临时直播，排行榜，搜索，内容更新状态，主播，此刻，专题，活动等内容。</li>
<li><a href="https://github.com/darknessomi/musicbox/wiki/%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E6%96%B0%E7%89%88WebAPI%E5%88%86%E6%9E%90%E3%80%82" target="_blank" rel="external">网易云音乐(非官方)</a> - 支持获取用户歌单，歌单详情，歌曲URL。 #非官方</li>
<li><a href="http://open.ximalaya.com/index" target="_blank" rel="external">喜马拉雅FM</a> - 支持Android和iOS平台，并提供相应的SDK和Demo，具体支持内容请下载相关文件查看。</li>
</ul>
<h4 id="云"><a href="#云" class="headerlink" title="云"></a><a href="https://microzz.com/2017/02/03/API/#%E4%BA%91" title="云" target="_blank" rel="external"></a>云</h4><ul>
<li><a href="https://develop.aliyun.com/api?spm=5176.8142029.388261.274.4FJSwV" target="_blank" rel="external">阿里云</a> - 支持弹性计算，数据库，存储与CDN，网络，应用服务，域名与网站等类别的内容，并提供了相关SDK。</li>
<li><a href="https://cloud.baidu.com/doc/index.html" target="_blank" rel="external">百度云</a> - 支持计算和网络，存储和CDN，数据库，安全和管理，数据分析，智能多媒体服务，物联网服务，人工智能，应用服务，网站服务，数字营销服务等内容，并提供相关的SDK。</li>
<li><a href="http://www.bmob.cn/" target="_blank" rel="external">Bmob</a> - 支持云数据库，容器服务，消息推送，文件存储，短信验证码，及时通讯，云端逻辑，定时任务，地理位置等。</li>
<li><a href="https://leancloud.cn/" target="_blank" rel="external">LeanCloud</a> - 支持云存储，数据分析，用户关系，实时通讯，消息推送，移动统计等。</li>
<li><a href="http://www.qiniu.com/" target="_blank" rel="external">七牛云</a> - 支持对象存储，融合CDN，直播云，数据处理等。</li>
<li><a href="https://www.qcloud.com/doc/api" target="_blank" rel="external">腾讯云</a> - 支持计算，网络，存储与CDN，数据库，安全服务，监控与管理，域名服务，视频服务，大数据与AI等内容，提供相关SDK。</li>
<li><a href="https://www.upyun.com/" target="_blank" rel="external">又拍云</a> - 支持 CDN、云存储、直播云、点播云、SSL证书服务、云处理、流量营销等。</li>
<li><a href="https://www.wilddog.com/" target="_blank" rel="external">野狗</a> - 支持实时数据同步，实时视频通话，及时通讯，短信，身份认证等。</li>
</ul>
<h4 id="语音识别"><a href="#语音识别" class="headerlink" title="语音识别"></a><a href="https://microzz.com/2017/02/03/API/#%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB" title="语音识别" target="_blank" rel="external"></a>语音识别</h4><ul>
<li><a href="http://yuyin.baidu.com/" target="_blank" rel="external">百度语音</a> - 支持全平台REST API, 离线在线融合模式，深度语义解析，场景识别定制，自定义上传语料、训练模型，基础服务永久免费。提供相应SDK和Demo应用。</li>
<li><a href="http://openspeech.sogou.com/Sogou/php/index.php" target="_blank" rel="external">搜狗语音云开放平台</a> - 支持在线/离线语音识别，在线听歌识曲，离线语音合成等内容。提供相应平台SDK。</li>
<li><a href="http://www.xfyun.cn/" target="_blank" rel="external">讯飞开放平台</a> - 支持语音听写/转写，在线/离线命令词识别，语音唤醒等内容，平台支持广泛，提供相应SDK。</li>
</ul>
<h4 id="杂志"><a href="#杂志" class="headerlink" title="杂志"></a><a href="https://microzz.com/2017/02/03/API/#%E6%9D%82%E5%BF%97" title="杂志" target="_blank" rel="external"></a>杂志</h4><ul>
<li><a href="https://github.com/ZongweiBai/DoubanOpenDaily/blob/b87473b90911e687d291e847b133b5c4c4a700a3/app/src/main/java/com/monosky/daily/constant/APIConstData.java" target="_blank" rel="external">豆瓣一刻(非官方)</a> - 支持获取指定日期文章列表，栏目总览，推荐作者，作者信息，作者更多文章信息，栏目文章列表及翻页，文章评论及热门评论列表。 #非官方</li>
<li><a href="https://github.com/jokermonn/-Api/blob/master/ONEv3.5.0~.md" target="_blank" rel="external">One一个(非官方)</a> - 支持获取首页图片，文章，音乐及电影。 #非官方</li>
<li><a href="https://github.com/izzyleung/ZhihuDailyPurify/wiki/%E7%9F%A5%E4%B9%8E%E6%97%A5%E6%8A%A5-API-%E5%88%86%E6%9E%90" target="_blank" rel="external">知乎日报(非官方)</a> - 支持获取界面启动图像，软件版本查询，最新消息，消息内容获取与离线下载，过往消息，新闻额外消息，新闻对应长/短评论查看，主题日报列表，主题日报内容，热门消息，栏目总览，栏目具体消息，新闻的推荐者，某个专栏之前的新闻，Editor的主页等。 #非官方</li>
<li><a href="https://github.com/marktony/zhuanlan/wiki" target="_blank" rel="external">知乎专栏(非官方)</a> - 支持获取指定专栏的信息，指定专栏的文章列表，指定的文章内容，评论列表，点赞信息。 #非官方</li>
</ul>
<h4 id="综合"><a href="#综合" class="headerlink" title="综合"></a><a href="https://microzz.com/2017/02/03/API/#%E7%BB%BC%E5%90%88" title="综合" target="_blank" rel="external"></a>综合</h4><ul>
<li><a href="http://www.avatardata.cn/Docs" target="_blank" rel="external">阿凡达数据</a> - 支持金融股票，充值认证，便民类，新闻文章，医药交通，科教文艺，创意数据，及时通讯等内容。</li>
<li><a href="http://www.alidayu.com/" target="_blank" rel="external">阿里大于</a> - 支持验证码，短信通知，语音通知，流量钱包充值，私密专线，群发助手等内容。</li>
<li><a href="https://www.apix.cn/" target="_blank" rel="external">APiX</a> - 支持基础征信数据，信用分析服务，支付缴费接口等数据，部分免费。</li>
<li><a href="http://apistore.baidu.com/" target="_blank" rel="external">百度API STORE</a> - 支持多种类型数据，部分免费，提供SDK。</li>
<li><a href="http://www.haoservice.com/" target="_blank" rel="external">HaoService</a> - 支持多种类型数据。</li>
<li><a href="https://www.juhe.cn/" target="_blank" rel="external">聚合数据</a> - 支持多种类型数据，部分免费。</li>
<li><a href="https://m.datayes.com/" target="_blank" rel="external">通联数据</a> - 提供金融类数据，支持免费试用。</li>
</ul>
]]></content>
      
        
        <tags>
            
            <tag> API </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[(转)2017下半年，一二线互联网公司Android面试题汇总]]></title>
      <url>/2017/10/12/%E8%BD%AC-2017%E4%B8%8B%E5%8D%8A%E5%B9%B4%EF%BC%8C%E4%B8%80%E4%BA%8C%E7%BA%BF%E4%BA%92%E8%81%94%E7%BD%91%E5%85%AC%E5%8F%B8Android%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB/</url>
      <content type="html"><![CDATA[<p>2017下半年，一二线互联网公司Android面试题汇总</p>
<p>阿里巴巴</p>
<ul>
<li>LRUCache原理</li>
<li>图片加载原理</li>
<li>模块化实现（好处，原因）</li>
<li>JVM</li>
<li>视频加密传输</li>
<li>统计启动时长,标准</li>
<li>如何保持应用的稳定性</li>
<li>ThreadLocal 原理</li>
<li>谈谈classloader</li>
<li>动态布局</li>
<li>热修复,插件化</li>
<li>HashMap源码,SpareArray原理</li>
<li>性能优化,怎么保证应用启动不卡顿</li>
<li>怎么去除重复代码</li>
<li>SP是进程同步的吗?有什么方法做到同步</li>
<li>介绍下SurfView</li>
<li>HashMap实现原理，ConcurrentHashMap 的实现原理</li>
<li>BroadcastReceiver，LocalBroadcastReceiver 区别</li>
<li>Bundle 机制</li>
<li>Handler 机制</li>
<li>android 事件传递机制</li>
<li>线程间 操作 List</li>
<li>App启动流程，从点击桌面开始</li>
<li>动态加载</li>
<li>类加载器</li>
<li>OSGI</li>
<li>Https请求慢的解决办法，DNS，携带数据，直接访问IP</li>
<li>GC回收策略</li>
<li>画出 Android 的大体架构图</li>
<li>描述清点击 Android Studio 的 build 按钮后发生了什么</li>
<li>大体说清一个应用程序安装到手机上时发生了什么；</li>
<li>对 Dalvik、ART 虚拟机有基本的了解；</li>
<li>Android 上的 Inter-Process-Communication 跨进程通信时如何工作的；</li>
<li>App 是如何沙箱化，为什么要这么做；</li>
<li>权限管理系统（底层的权限是如何进行 grant 的）</li>
<li>进程和 Application 的生命周期；</li>
<li>系统启动流程 Zygote进程 –&gt; SystemServer进程 –&gt; 各种系统服务 –&gt; 应用进程</li>
<li>recycleview listview 的区别,性能</li>
<li>排序，快速排序的实现</li>
<li>树：B+树的介绍</li>
<li>图：有向无环图的解释</li>
<li>TCP/UDP的区别</li>
<li>synchronized与Lock的区别</li>
<li>volatile</li>
<li>Java线程池</li>
<li>Java中对象的生命周期</li>
<li>类加载机制</li>
<li>双亲委派模型</li>
<li>Android事件分发机制</li>
<li>MVP模式</li>
<li>RxJava</li>
<li>抽象类和接口的区别</li>
<li>集合 Set实现 Hash 怎么防止碰撞</li>
<li>JVM 内存区域 开线程影响哪块内存</li>
<li>垃圾收集机制 对象创建，新生代与老年代</li>
<li>二叉树 深度遍历与广度遍历</li>
<li>B树、B+树</li>
<li>消息机制</li>
<li>进程调度</li>
<li>进程与线程</li>
<li>死锁</li>
<li>进程状态</li>
<li>JVM内存模型</li>
<li>并发集合了解哪些</li>
<li>ConCurrentHashMap实现</li>
<li>CAS介绍</li>
<li>开启线程的三种方式,run()和start()方法区别</li>
<li>线程池</li>
<li>常用数据结构简介</li>
<li>判断环（猜测应该是链表环）</li>
<li>排序，堆排序实现</li>
<li>链表反转</li>
</ul>
<p>腾讯</p>
<ul>
<li>synchronized用法</li>
<li>volatile用法</li>
<li>动态权限适配方案，权限组的概念</li>
<li>网络请求缓存处理，okhttp如何处理网络缓存的</li>
<li>图片加载库相关，bitmap如何处理大图，如一张30M的大图，如何预防OOM</li>
<li>进程保活</li>
<li>listview图片加载错乱的原理和解决方案</li>
<li>https相关，如何验证证书的合法性，https中哪里用了对称加密，哪里用了非对称加密，对加密算法（如RSA）等是否有了解</li>
</ul>
<p>滴滴</p>
<ul>
<li>MVP</li>
<li>广播（动态注册和静态注册区别，有序广播和标准广播）</li>
<li>service生命周期</li>
<li>handler实现机制（很多细节需要关注：如线程如何建立和退出消息循环等等）</li>
<li>多线程（关于AsyncTask缺陷引发的思考）</li>
<li>数据库数据迁移问题</li>
<li>设计模式相关（例如Android中哪里使用了观察者模式，单例模式相关）</li>
<li>x个苹果，一天只能吃一个、两个、或者三个，问多少天可以吃完</li>
<li>TCP与UDP区别与应用（三次握手和四次挥手）涉及到部分细节（如client如何确定自己发送的消息被server收到） HTTP相关 提到过Websocket 问了WebSocket相关以及与socket的区别</li>
<li>是否熟悉Android jni开发，jni如何调用java层代码</li>
<li>进程间通信的方式</li>
<li>java注解</li>
<li>计算一个view的嵌套层级</li>
<li>项目组件化的理解</li>
<li>多线程断点续传原理</li>
<li>Android系统为什么会设计ContentProvider，进程共享和线程安全问题</li>
<li>jvm相关</li>
<li>Android相关优化（如内存优化、网络优化、布局优化、电量优化、业务优化）</li>
<li>EventBus实现原理</li>
</ul>
<p>美团</p>
<ul>
<li>static synchronized 方法的多线程访问和作用，同一个类里面两个synchronized方法，两个线程同时访问的问题</li>
<li>内部类和静态内部类和匿名内部类，以及项目中的应用</li>
<li>handler发消息给子线程，looper怎么启动</li>
<li>View事件传递</li>
<li>activity栈</li>
<li>封装view的时候怎么知道view的大小</li>
<li>arraylist和linkedlist的区别，以及应用场景</li>
<li>怎么启动service，service和activity怎么进行数据交互</li>
<li>下拉状态栏是不是影响activity的生命周期，如果在onStop的时候做了网络请求，onResume的时候怎么恢复</li>
<li>view渲染</li>
</ul>
<p>今日头条</p>
<ul>
<li>数据结构中堆的概念，堆排序</li>
<li>死锁的概念，怎么避免死锁</li>
<li>ReentrantLock 、synchronized和volatile（n面）</li>
<li>HashMap</li>
<li>singleTask启动模式</li>
<li>用到的一些开源框架，介绍一个看过源码的，内部实现过程。</li>
<li>消息机制实现</li>
<li>ReentrantLock的内部实现</li>
<li>App启动崩溃异常捕捉</li>
<li>事件传递机制的介绍</li>
<li>ListView的优化</li>
<li>二叉树，给出根节点和目标节点，找出从根节点到目标节点的路径</li>
<li>模式MVP，MVC介绍</li>
<li>断点续传的实现</li>
<li>集合的接口和具体实现类，介绍</li>
<li>TreeMap具体实现</li>
<li>synchronized与ReentrantLock</li>
<li>手写生产者/消费者模式</li>
<li>逻辑地址与物理地址，为什么使用逻辑地址</li>
<li>一个无序，不重复数组，输出N个元素，使得N个元素的和相加为M，给出时间复杂度、空间复杂度。手写算法</li>
<li>.Android进程分类</li>
<li>前台切换到后台，然后再回到前台，Activity生命周期回调方法。弹出Dialog，生命值周期回调方法。</li>
<li>Activity的启动模式</li>
</ul>
<p>爱奇艺</p>
<ul>
<li>RxJava的功能与原理实现</li>
<li>RecycleView的使用，原理，RecycleView优化</li>
<li>ANR的原因</li>
<li>四大组件</li>
<li>Service的开启方式</li>
<li>Activity与Service通信的方式</li>
<li>Activity之间的通信方式</li>
<li>HashMap的实现，与HashSet的区别</li>
<li>JVM内存模型，内存区域</li>
<li>Java中同步使用的关键字，死锁</li>
<li>MVP模式</li>
<li>Java设计模式，观察者模式</li>
<li>Activity与Fragment之间生命周期比较</li>
<li><p>广播的使用场景</p>
<p>百度</p>
</li>
</ul>
<hr>
<ul>
<li>Bitmap 使用时候注意什么？</li>
<li>Oom 是否可以try catch ？</li>
<li>内存泄露如何产生？</li>
<li>适配器模式，装饰者模式，外观模式的异同？</li>
<li>ANR 如何产生？</li>
<li>String buffer 与string builder 的区别？</li>
<li>如何保证线程安全？</li>
<li>java四中引用</li>
<li>Jni 用过么？</li>
<li>多进程场景遇见过么？</li>
<li>关于handler，在任何地方new handler 都是什么线程下</li>
<li>sqlite升级，增加字段的语句</li>
<li>bitmap recycler 相关</li>
<li>强引用置为null，会不会被回收？</li>
<li>glide 使用什么缓存？</li>
<li>Glide 内存缓存如何控制大小？</li>
<li>如何保证多线程读写文件的安全？</li>
</ul>
<p>携程</p>
<ul>
<li>Activity启动模式</li>
<li>广播的使用方式，场景</li>
<li>App中唤醒其他进程的实现方式</li>
<li>AndroidManifest的作用与理解</li>
<li>List,Set,Map的区别</li>
<li>HashSet与HashMap怎么判断集合元素重复</li>
<li>Java中内存区域与垃圾回收机制</li>
<li>EventBus作用，实现方式，代替EventBus的方式</li>
<li>Android中开启摄像头的主要步骤</li>
</ul>
<p>网易</p>
<ul>
<li>集合</li>
<li>concurrenthashmap</li>
<li>volatile</li>
<li>synchronized与Lock</li>
<li>Java线程池</li>
<li>wait/notify</li>
<li>NIO</li>
<li>垃圾收集器</li>
<li>Activity生命周期</li>
<li>AlertDialog,popupWindow,Activity区别</li>
</ul>
<p>小米</p>
<ul>
<li>String 为什么要设计成不可变的？</li>
<li>fragment 各种情况下的生命周期</li>
<li>Activity 上有 Dialog 的时候按 home 键时的生命周期</li>
<li>横竖屏切换的时候，Activity 各种情况下的生命周期</li>
<li>Application 和 Activity 的 context 对象的区别</li>
<li>序列化的作用，以及 Android 两种序列化的区别。</li>
<li>List 和 Map 的实现方式以及存储方式。</li>
<li>静态内部类的设计意图。</li>
<li>线程如何关闭，以及如何防止线程的内存泄漏</li>
</ul>
<p>360</p>
<ul>
<li>软引用、弱引用区别</li>
<li>垃圾回收</li>
<li>多线程：怎么用、有什么问题要注意；Android线程有没有上限，然后提到线程池的上限</li>
<li>JVM</li>
<li>锁</li>
<li>OOM，内存泄漏</li>
<li>ANR怎么分析解决</li>
<li>LinearLayout、RelativeLayout、FrameLayout的特性、使用场景</li>
<li>如何实现Fragment的滑动</li>
<li>ViewPager使用细节，如何设置成每次只初始化当前的Fragment，其他的不初始化</li>
<li>ListView重用的是什么</li>
<li>进程间通信的机制</li>
<li>AIDL机制</li>
<li>AsyncTask机制</li>
<li>如何取消AsyncTask</li>
<li>序列化</li>
<li>Android为什么引入Parcelable</li>
<li>有没有尝试简化Parcelable的使用</li>
<li>AIDL机制</li>
<li>项目：拉活怎么做的</li>
<li>应用安装过程</li>
</ul>
<p>某海外直播公司</p>
<ul>
<li>线程和进程的区别？</li>
<li>为什么要有线程，而不是仅仅用进程？</li>
<li>算法判断单链表成环与否？</li>
<li>如何实现线程同步？</li>
<li>hashmap数据结构？</li>
<li>arraylist 与 linkedlist 异同？</li>
<li>object类的equal 和hashcode 方法重写，为什么？</li>
<li>hashmap如何put数据（从hashmap源码角度讲解）？</li>
<li>简述IPC？</li>
<li>fragment之间传递数据的方式？</li>
<li>简述tcp四次挥手?</li>
<li>threadlocal原理</li>
<li>内存泄漏的可能原因？</li>
<li>用IDE如何分析内存泄漏？</li>
<li>OOM的可能原因？</li>
<li>线程死锁的4个条件？</li>
<li>差值器&amp;估值器</li>
<li>简述消息机制相关</li>
<li>进程间通信方式？</li>
<li>Binder相关？</li>
<li>触摸事件的分发？</li>
<li>简述Activity启动全部过程？</li>
<li>okhttp源码？</li>
<li>RxJava简介及其源码解读？</li>
<li>性能优化如何分析systrace？</li>
<li>广播的分类？</li>
<li>点击事件被拦截，但是相传到下面的view，如何操作？</li>
<li>Glide源码？</li>
<li>ActicityThread相关？</li>
<li>volatile的原理</li>
<li>synchronize的原理</li>
<li>lock原理</li>
<li>翻转一个单项链表</li>
<li>string to integer</li>
<li>合并多个单有序链表（假设都是递增的）</li>
</ul>
<p>其他公司</p>
<ul>
<li>四大组件</li>
<li>Android中数据存储方式</li>
<li>微信主页面的实现方式</li>
<li>微信上消息小红点的原理</li>
<li>两个不重复的数组集合中，求共同的元素。</li>
<li>上一问扩展，海量数据，内存中放不下，怎么求出。</li>
<li>Java中String的了解。</li>
<li>ArrayList与LinkedList区别</li>
<li>堆排序过程，时间复杂度，空间复杂度</li>
<li>快速排序的时间复杂度，空间复杂度</li>
<li>RxJava的作用，与平时使用的异步操作来比，优势</li>
<li>Android消息机制原理</li>
<li>Binder机制介绍</li>
<li>为什么不能在子线程更新UI</li>
<li>JVM内存模型</li>
<li>Android中进程内存的分配，能不能自己分配定额内存</li>
<li>垃圾回收机制与调用System.gc()区别</li>
<li>Android事件分发机制</li>
<li>断点续传的实现</li>
<li>RxJava的作用，优缺点</li>
</ul>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Interview </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[(转)Java中Synchronized的用法]]></title>
      <url>/2017/10/12/%E8%BD%AC-Java%E4%B8%ADSynchronized%E7%9A%84%E7%94%A8%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>本文转自<a href="http://blog.csdn.net/luoweifu/article/details/46613015" target="_blank" rel="external">This</a></p>
<p>synchronized是Java中的关键字，是一种同步锁。它修饰的对象有以下几种： </p>
<ol>
<li>修饰一个代码块，被修饰的代码块称为同步语句块，其作用的范围是大括号{}括起来的代码，作用的对象是调用这个代码块的对象； </li>
<li>修饰一个方法，被修饰的方法称为同步方法，其作用的范围是整个方法，作用的对象是调用这个方法的对象； </li>
<li>修改一个静态的方法，其作用的范围是整个静态方法，作用的对象是这个类的所有对象； </li>
<li>修改一个类，其作用的范围是synchronized后面括号括起来的部分，作用主的对象是这个类的所有对象。</li>
</ol>
<hr>
<h1 id="修饰一个代码块"><a href="#修饰一个代码块" class="headerlink" title="修饰一个代码块"></a>修饰一个代码块</h1><ol>
<li>一个线程访问一个对象中的synchronized(this)同步代码块时，其他试图访问该对象的线程将被阻塞。<br>我们看下面一个例子：</li>
</ol>
<p><strong>【Demo1】：synchronized的用法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 同步线程</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SyncThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="title">SyncThread</span><span class="params">()</span> </span>&#123;</div><div class="line">      count = <span class="number">0</span>;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="keyword">synchronized</span>(<span class="keyword">this</span>) &#123;</div><div class="line">         <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">               System.out.println(Thread.currentThread().getName() + <span class="string">":"</span> + (count++));</div><div class="line">               Thread.sleep(<span class="number">100</span>);</div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">               e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> count;</div><div class="line">   &#125;</div><div class="line">&#125;<span class="number">123456789101112131415161718192021222324252627</span></div></pre></td></tr></table></figure>
<p>SyncThread的调用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">SyncThread syncThread = new SyncThread();</div><div class="line">Thread thread1 = new Thread(syncThread, &quot;SyncThread1&quot;);</div><div class="line">Thread thread2 = new Thread(syncThread, &quot;SyncThread2&quot;);</div><div class="line">thread1.start();</div><div class="line">thread2.start();</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<blockquote>
<p>SyncThread1:0<br>SyncThread1:1<br>SyncThread1:2<br>SyncThread1:3<br>SyncThread1:4<br>SyncThread2:5<br>SyncThread2:6<br>SyncThread2:7<br>SyncThread2:8<br>SyncThread2:9*</p>
</blockquote>
<p>当两个并发线程(thread1和thread2)访问同一个对象(syncThread)中的synchronized代码块时，在同一时刻只能有一个线程得到执行，另一个线程受阻塞，必须等待当前线程执行完这个代码块以后才能执行该代码块。Thread1和thread2是互斥的，因为在执行synchronized代码块时会锁定当前的对象，只有执行完该代码块才能释放该对象锁，下一个线程才能执行并锁定该对象。<br>我们再把SyncThread的调用稍微改一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Thread thread1 = new Thread(new SyncThread(), &quot;SyncThread1&quot;);</div><div class="line">Thread thread2 = new Thread(new SyncThread(), &quot;SyncThread2&quot;);</div><div class="line">thread1.start();</div><div class="line">thread2.start();</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<blockquote>
<p>SyncThread1:0<br>SyncThread2:1<br>SyncThread1:2<br>SyncThread2:3<br>SyncThread1:4<br>SyncThread2:5<br>SyncThread2:6<br>SyncThread1:7<br>SyncThread1:8<br>SyncThread2:9</p>
</blockquote>
<p>不是说一个线程执行synchronized代码块时其它的线程受阻塞吗？为什么上面的例子中thread1和thread2同时在执行。这是因为synchronized只锁定对象，每个对象只有一个锁（lock）与之相关联，而上面的代码等同于下面这段代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SyncThread syncThread1 = <span class="keyword">new</span> SyncThread();</div><div class="line">SyncThread syncThread2 = <span class="keyword">new</span> SyncThread();</div><div class="line">Thread thread1 = <span class="keyword">new</span> Thread(syncThread1, <span class="string">"SyncThread1"</span>);</div><div class="line">Thread thread2 = <span class="keyword">new</span> Thread(syncThread2, <span class="string">"SyncThread2"</span>);</div><div class="line">thread1.start();</div><div class="line">thread2.start();<span class="number">123456</span></div></pre></td></tr></table></figure>
<p>这时创建了两个SyncThread的对象syncThread1和syncThread2，线程thread1执行的是syncThread1对象中的synchronized代码(run)，而线程thread2执行的是syncThread2对象中的synchronized代码(run)；我们知道synchronized锁定的是对象，这时会有两把锁分别锁定syncThread1对象和syncThread2对象，而这两把锁是互不干扰的，不形成互斥，所以两个线程可以同时执行。</p>
<p>2.当一个线程访问对象的一个synchronized(this)同步代码块时，另一个线程仍然可以访问该对象中的非synchronized(this)同步代码块。<br><strong>【Demo2】：多个线程访问synchronized和非synchronized代码块</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">class Counter implements Runnable&#123;</div><div class="line">   private int count;</div><div class="line"></div><div class="line">   public Counter() &#123;</div><div class="line">      count = 0;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public void countAdd() &#123;</div><div class="line">      synchronized(this) &#123;</div><div class="line">         for (int i = 0; i &lt; 5; i ++) &#123;</div><div class="line">            try &#123;</div><div class="line">               System.out.println(Thread.currentThread().getName() + &quot;:&quot; + (count++));</div><div class="line">               Thread.sleep(100);</div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">               e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   //非synchronized代码块，未对count进行读写操作，所以可以不用synchronized</div><div class="line">   public void printCount() &#123;</div><div class="line">      for (int i = 0; i &lt; 5; i ++) &#123;</div><div class="line">         try &#123;</div><div class="line">            System.out.println(Thread.currentThread().getName() + &quot; count:&quot; + count);</div><div class="line">            Thread.sleep(100);</div><div class="line">         &#125; catch (InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public void run() &#123;</div><div class="line">      String threadName = Thread.currentThread().getName();</div><div class="line">      if (threadName.equals(&quot;A&quot;)) &#123;</div><div class="line">         countAdd();</div><div class="line">      &#125; else if (threadName.equals(&quot;B&quot;)) &#123;</div><div class="line">         printCount();</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Counter counter = new Counter();</div><div class="line">Thread thread1 = new Thread(counter, &quot;A&quot;);</div><div class="line">Thread thread2 = new Thread(counter, &quot;B&quot;);</div><div class="line">thread1.start();</div><div class="line">thread2.start();</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<blockquote>
<p>A:0<br>B count:1<br>A:1<br>B count:2<br>A:2<br>B count:3<br>A:3<br>B count:4<br>A:4<br>B count:5</p>
</blockquote>
<p>上面代码中countAdd是一个synchronized的，printCount是非synchronized的。从上面的结果中可以看出一个线程访问一个对象的synchronized代码块时，别的线程可以访问该对象的非synchronized代码块而不受阻塞。</p>
<ol>
<li>指定要给某个对象加锁</li>
</ol>
<p><strong>【Demo3】:指定要给某个对象加锁</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 银行账户类</div><div class="line"> */</div><div class="line">class Account &#123;</div><div class="line">   String name;</div><div class="line">   float amount;</div><div class="line"></div><div class="line">   public Account(String name, float amount) &#123;</div><div class="line">      this.name = name;</div><div class="line">      this.amount = amount;</div><div class="line">   &#125;</div><div class="line">   //存钱</div><div class="line">   public  void deposit(float amt) &#123;</div><div class="line">      amount += amt;</div><div class="line">      try &#123;</div><div class="line">         Thread.sleep(100);</div><div class="line">      &#125; catch (InterruptedException e) &#123;</div><div class="line">         e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">   //取钱</div><div class="line">   public  void withdraw(float amt) &#123;</div><div class="line">      amount -= amt;</div><div class="line">      try &#123;</div><div class="line">         Thread.sleep(100);</div><div class="line">      &#125; catch (InterruptedException e) &#123;</div><div class="line">         e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public float getBalance() &#123;</div><div class="line">      return amount;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 账户操作类</div><div class="line"> */</div><div class="line">class AccountOperator implements Runnable&#123;</div><div class="line">   private Account account;</div><div class="line">   public AccountOperator(Account account) &#123;</div><div class="line">      this.account = account;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public void run() &#123;</div><div class="line">      synchronized (account) &#123;</div><div class="line">         account.deposit(500);</div><div class="line">         account.withdraw(500);</div><div class="line">         System.out.println(Thread.currentThread().getName() + &quot;:&quot; + account.getBalance());</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Account account = new Account(&quot;zhang san&quot;, 10000.0f);</div><div class="line">AccountOperator accountOperator = new AccountOperator(account);</div><div class="line"></div><div class="line">final int THREAD_NUM = 5;</div><div class="line">Thread threads[] = new Thread[THREAD_NUM];</div><div class="line">for (int i = 0; i &lt; THREAD_NUM; i ++) &#123;</div><div class="line">   threads[i] = new Thread(accountOperator, &quot;Thread&quot; + i);</div><div class="line">   threads[i].start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<blockquote>
<p>Thread3:10000.0<br>Thread2:10000.0<br>Thread1:10000.0<br>Thread4:10000.0<br>Thread0:10000.0</p>
</blockquote>
<p>在AccountOperator 类中的run方法里，我们用synchronized 给account对象加了锁。这时，当一个线程访问account对象时，其他试图访问account对象的线程将会阻塞，直到该线程访问account对象结束。也就是说谁拿到那个锁谁就可以运行它所控制的那段代码。<br>当有一个明确的对象作为锁时，就可以用类似下面这样的方式写程序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public void method3(SomeObject obj)</div><div class="line">&#123;</div><div class="line">   //obj 锁定的对象</div><div class="line">   synchronized(obj)</div><div class="line">   &#123;</div><div class="line">      // todo</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当没有明确的对象作为锁，只是想让一段代码同步时，可以创建一个特殊的对象来充当锁：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">class Test implements Runnable</div><div class="line">&#123;</div><div class="line">   private byte[] lock = new byte[0];  // 特殊的instance变量</div><div class="line">   public void method()</div><div class="line">   &#123;</div><div class="line">      synchronized(lock) &#123;</div><div class="line">         // todo 同步代码块</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public void run() &#123;</div><div class="line"></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>说明：零长度的byte数组对象创建起来将比任何对象都经济――查看编译后的字节码：生成零长度的byte[]对象只需3条操作码，而Object lock = new Object()则需要7行操作码。</p>
<hr>
<h1 id="修饰一个方法"><a href="#修饰一个方法" class="headerlink" title="修饰一个方法"></a>修饰一个方法</h1><p>Synchronized修饰一个方法很简单，就是<strong>在方法的前面加synchronized</strong>，public synchronized void method(){//todo}; synchronized修饰方法和修饰一个代码块类似，只是作用范围不一样，修饰代码块是大括号括起来的范围，而修饰方法范围是整个函数。如将【Demo1】中的run方法改成如下的方式，实现的效果一样。</p>
<p><strong>【Demo4】：synchronized修饰一个方法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">public synchronized void run() &#123;</div><div class="line">   for (int i = 0; i &lt; 5; i ++) &#123;</div><div class="line">      try &#123;</div><div class="line">         System.out.println(Thread.currentThread().getName() + &quot;:&quot; + (count++));</div><div class="line">         Thread.sleep(100);</div><div class="line">      &#125; catch (InterruptedException e) &#123;</div><div class="line">         e.printStackTrace();</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Synchronized作用于整个方法的写法。<br>写法一：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public synchronized void method()</div><div class="line">&#123;</div><div class="line">   // todo</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>写法二：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public void method()</div><div class="line">&#123;</div><div class="line">   synchronized(this) &#123;</div><div class="line">      // todo</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>写法一修饰的是一个方法，写法二修饰的是一个代码块，但写法一与写法二是等价的，都是锁定了整个方法时的内容。</p>
<p>在用synchronized修饰方法时要注意以下几点：<br>1. synchronized关键字不能继承。<br>虽然可以使用synchronized来定义方法，但synchronized并不属于方法定义的一部分，因此，synchronized关键字不能被继承。如果在父类中的某个方法使用了synchronized关键字，而在子类中覆盖了这个方法，在子类中的这个方法默认情况下并不是同步的，而必须显式地在子类的这个方法中加上synchronized关键字才可以。当然，还可以在子类方法中调用父类中相应的方法，这样虽然子类中的方法不是同步的，但子类调用了父类的同步方法，因此，子类的方法也就相当于同步了。这两种方式的例子代码如下：<br>在子类方法中加上synchronized关键字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class Parent &#123;</div><div class="line">   public synchronized void method() &#123; &#125;</div><div class="line">&#125;</div><div class="line">class Child extends Parent &#123;</div><div class="line">   public synchronized void method() &#123; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在子类方法中调用父类的同步方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class Parent &#123;</div><div class="line">   public synchronized void method() &#123;   &#125;</div><div class="line">&#125;</div><div class="line">class Child extends Parent &#123;</div><div class="line">   public void method() &#123; super.method();   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>在定义接口方法时不能使用synchronized关键字。</li>
<li><p>构造方法不能使用synchronized关键字，但可以使用synchronized代码块来进行同步。 </p>
<hr>
</li>
</ol>
<h1 id="修饰一个静态的方法"><a href="#修饰一个静态的方法" class="headerlink" title="修饰一个静态的方法"></a>修饰一个静态的方法</h1><p>Synchronized也可修饰一个静态方法，用法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public synchronized static void method() &#123;</div><div class="line">   // todo</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们知道静态方法是属于类的而不属于对象的。同样的，synchronized修饰的静态方法锁定的是这个类的所有对象。我们对Demo1进行一些修改如下：</p>
<p><strong>【Demo5】：synchronized修饰静态方法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 同步线程</div><div class="line"> */</div><div class="line">class SyncThread implements Runnable &#123;</div><div class="line">   private static int count;</div><div class="line"></div><div class="line">   public SyncThread() &#123;</div><div class="line">      count = 0;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public synchronized static void method() &#123;</div><div class="line">      for (int i = 0; i &lt; 5; i ++) &#123;</div><div class="line">         try &#123;</div><div class="line">            System.out.println(Thread.currentThread().getName() + &quot;:&quot; + (count++));</div><div class="line">            Thread.sleep(100);</div><div class="line">         &#125; catch (InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public synchronized void run() &#123;</div><div class="line">      method();</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SyncThread syncThread1 = new SyncThread();</div><div class="line">SyncThread syncThread2 = new SyncThread();</div><div class="line">Thread thread1 = new Thread(syncThread1, &quot;SyncThread1&quot;);</div><div class="line">Thread thread2 = new Thread(syncThread2, &quot;SyncThread2&quot;);</div><div class="line">thread1.start();</div><div class="line">thread2.start();</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<blockquote>
<p>SyncThread1:0<br>SyncThread1:1<br>SyncThread1:2<br>SyncThread1:3<br>SyncThread1:4<br>SyncThread2:5<br>SyncThread2:6<br>SyncThread2:7<br>SyncThread2:8<br>SyncThread2:9</p>
</blockquote>
<p>syncThread1和syncThread2是SyncThread的两个对象，但在thread1和thread2并发执行时却保持了线程同步。这是因为run中调用了静态方法method，而静态方法是属于类的，所以syncThread1和syncThread2相当于用了同一把锁。这与Demo1是不同的。</p>
<hr>
<h1 id="修饰一个类"><a href="#修饰一个类" class="headerlink" title="修饰一个类"></a>修饰一个类</h1><p>Synchronized还可作用于一个类，用法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class ClassName &#123;</div><div class="line">   public void method() &#123;</div><div class="line">      synchronized(ClassName.class) &#123;</div><div class="line">         // todo</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们把Demo5再作一些修改。<br><strong>【Demo6】:修饰一个类</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 同步线程</div><div class="line"> */</div><div class="line">class SyncThread implements Runnable &#123;</div><div class="line">   private static int count;</div><div class="line"></div><div class="line">   public SyncThread() &#123;</div><div class="line">      count = 0;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public static void method() &#123;</div><div class="line">      synchronized(SyncThread.class) &#123;</div><div class="line">         for (int i = 0; i &lt; 5; i ++) &#123;</div><div class="line">            try &#123;</div><div class="line">               System.out.println(Thread.currentThread().getName() + &quot;:&quot; + (count++));</div><div class="line">               Thread.sleep(100);</div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">               e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public synchronized void run() &#123;</div><div class="line">      method();</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其效果和【Demo5】是一样的，synchronized作用于一个类T时，是给这个类T加锁，T的所有对象用的是同一把锁。</p>
<hr>
<h1 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h1><p>A. 无论synchronized关键字加在方法上还是对象上，如果它作用的对象是非静态的，则它取得的锁是对象；如果synchronized作用的对象是一个静态方法或一个类，则它取得的锁是对类，该类所有的对象同一把锁。<br>B. 每个对象只有一个锁（lock）与之相关联，谁拿到这个锁谁就可以运行它所控制的那段代码。<br>C. 实现同步是要很大的系统开销作为代价的，甚至可能造成死锁，所以尽量避免无谓的同步控制。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> Synchronized </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android 图片的加载]]></title>
      <url>/2017/10/07/Android-%E5%9B%BE%E7%89%87%E7%9A%84%E5%8A%A0%E8%BD%BD/</url>
      <content type="html"><![CDATA[<h3 id="Android-图片的加载"><a href="#Android-图片的加载" class="headerlink" title="Android 图片的加载"></a>Android 图片的加载</h3><blockquote>
<p>忽然想起在以前公司做Android的时候，有个哥们在首页放图片的时候，总是因为OOM而崩溃，今天打算正式找一下原因</p>
</blockquote>
<h4 id="首先来一个demo如下"><a href="#首先来一个demo如下" class="headerlink" title="首先来一个demo如下"></a>首先来一个demo如下</h4><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fk9ggjczxkj30uk1iqb29.jpg" alt="本图片格式为1024 * 707，199.62KB"></p>
<p>用同样的图片，同样大小的ImageView加载，不同的方法测试，其中第一个图片采用最优加载，第二个图片采用<code>setBackgroundResource</code>，第三个图片采用<code>setBackground</code>，第四个图片采用<code>Glide</code>加载。</p>
<p>查看源码可知，<code>setBackgroundResource</code>和<code>setBackground</code>最后调用的其实都是<code>setBackgroundDrawable</code>。</p>
<p>如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public void setBackgroundResource(@DrawableRes int resid) &#123;</div><div class="line">    if (resid != 0 &amp;&amp; resid == mBackgroundResource) &#123;</div><div class="line">        return;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">    Drawable d = null;</div><div class="line"> if (resid != 0) &#123;</div><div class="line">        d = mContext.getDrawable(resid);</div><div class="line">  &#125;</div><div class="line">    setBackground(d);    mBackgroundResource = resid; &#125;</div><div class="line"></div><div class="line"></div><div class="line">public void setBackground(Drawable background) &#123;</div><div class="line">    //noinspection deprecation</div><div class="line">  setBackgroundDrawable(background); &#125;</div></pre></td></tr></table></figure></p>
<p>简单查看<code>setBackgroundDrawable</code>的源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line">public void setBackgroundDrawable(Drawable background) &#123;</div><div class="line">    computeOpaqueFlags();   if (background == mBackground) &#123;</div><div class="line">        return;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">    boolean requestLayout = false;    mBackgroundResource = 0;    /*</div><div class="line"> * Regardless of whether we&apos;re setting a new background or not, we want * to clear the previous drawable. setVisible first while we still have the callback set. */  if (mBackground != null) &#123;</div><div class="line">        if (isAttachedToWindow()) &#123;</div><div class="line">            mBackground.setVisible(false, false);</div><div class="line">  &#125;</div><div class="line">        mBackground.setCallback(null);</div><div class="line">  unscheduleDrawable(mBackground);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">    if (background != null) &#123;</div><div class="line">        Rect padding = sThreadLocal.get();</div><div class="line"> if (padding == null) &#123;</div><div class="line">            padding = new Rect();</div><div class="line">  sThreadLocal.set(padding);</div><div class="line">  &#125;</div><div class="line">        resetResolvedDrawablesInternal();</div><div class="line">  background.setLayoutDirection(getLayoutDirection());</div><div class="line"> if (background.getPadding(padding)) &#123;</div><div class="line">            resetResolvedPaddingInternal();</div><div class="line"> switch (background.getLayoutDirection()) &#123;</div><div class="line">                case LAYOUT_DIRECTION_RTL:</div><div class="line">                    mUserPaddingLeftInitial = padding.right;</div><div class="line">  mUserPaddingRightInitial = padding.left;</div><div class="line">  internalSetPadding(padding.right, padding.top, padding.left, padding.bottom);</div><div class="line"> break; case LAYOUT_DIRECTION_LTR:</div><div class="line">                default:</div><div class="line">                    mUserPaddingLeftInitial = padding.left;</div><div class="line">  mUserPaddingRightInitial = padding.right;</div><div class="line">  internalSetPadding(padding.left, padding.top, padding.right, padding.bottom);</div><div class="line">  &#125;</div><div class="line">            mLeftPaddingDefined = false;</div><div class="line">  mRightPaddingDefined = false;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">        // Compare the minimum sizes of the old Drawable and the new.  If there isn&apos;t an old or</div><div class="line"> // if it has a different minimum size, we should layout again  if (mBackground == null</div><div class="line">  || mBackground.getMinimumHeight() != background.getMinimumHeight()</div><div class="line">                || mBackground.getMinimumWidth() != background.getMinimumWidth()) &#123;</div><div class="line">            requestLayout = true;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">        // Set mBackground before we set this as the callback and start making other</div><div class="line"> // background drawable state change calls. In particular, the setVisible call below // can result in drawables attempting to start animations or otherwise invalidate, // which requires the view set as the callback (us) to recognize the drawable as // belonging to it as per verifyDrawable.  mBackground = background;</div><div class="line"> if (background.isStateful()) &#123;</div><div class="line">            background.setState(getDrawableState());</div><div class="line">  &#125;</div><div class="line">        if (isAttachedToWindow()) &#123;</div><div class="line">            background.setVisible(getWindowVisibility() == VISIBLE &amp;&amp; isShown(), false);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">        applyBackgroundTint();    // Set callback last, since the view may still be initializing.</div><div class="line">  background.setCallback(this);   if ((mPrivateFlags &amp; PFLAG_SKIP_DRAW) != 0) &#123;</div><div class="line">            mPrivateFlags &amp;= ~PFLAG_SKIP_DRAW;</div><div class="line">  requestLayout = true;</div><div class="line">  &#125;</div><div class="line">    &#125; else &#123;</div><div class="line">        /* Remove the background */</div><div class="line">  mBackground = null;</div><div class="line"> if ((mViewFlags &amp; WILL_NOT_DRAW) != 0</div><div class="line">  &amp;&amp; (mForegroundInfo == null || mForegroundInfo.mDrawable == null)) &#123;</div><div class="line">            mPrivateFlags |= PFLAG_SKIP_DRAW;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">        /*</div><div class="line"> * When the background is set, we try to apply its padding to this * View. When the background is removed, we don&apos;t touch this View&apos;s * padding. This is noted in the Javadocs. Hence, we don&apos;t need to * requestLayout(), the invalidate() below is sufficient. */   // The old background&apos;s minimum size could have affected this // View&apos;s layout, so let&apos;s requestLayout  requestLayout = true;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">    computeOpaqueFlags();   if (requestLayout) &#123;</div><div class="line">        requestLayout();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">    mBackgroundSizeChanged = true;</div><div class="line">  invalidate(true);</div><div class="line">  invalidateOutline(); &#125;</div></pre></td></tr></table></figure></p>
<p>这个方法首先查看这个Drawable是否和之前设置的相等，如果一样的话，直接结束方法。然后查看以前设置的<code>mBackground</code>是否为<code>null</code>，如果不为null，则清除之前设置的。接下来就是查看这个Drawable是否为null，如果不为null，就进行一系列的设置，为null的话，就移除之前的。</p>
<p>分析到这里好像也没发现图片大小的关键，不急，继续分析。</p>
<h4 id="图片占用的大小"><a href="#图片占用的大小" class="headerlink" title="图片占用的大小"></a>图片占用的大小</h4><p>app启动占用内存<br><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fk9h7k1tkej30qo05cwep.jpg" alt=""><br>经测试<br>a. 调用<code>setBackgroundResource</code><br><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fk9h9694ouj30im058glt.jpg" alt=""><br>b. 调用<code>setBackground</code><br><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fk9ha2b5waj30je04sgls.jpg" alt=""><br>c. 直接加载src<br><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fk9hc4vzy6j30hu04ugls.jpg" alt=""><br>d. Glide加载<br><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fk9hfu92hsj30h804gq32.jpg" alt=""><br>e. 计算相关数值后加载<br><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fk9hh9izzfj30iu054wen.jpg" alt=""><br><strong>what!!</strong> 怪不得会OOM，直接设置的话，加载一张200K的图片至少占用了24.5mb的内存，不卡才怪。</p>
<h4 id="图片加载的优化"><a href="#图片加载的优化" class="headerlink" title="图片加载的优化"></a>图片加载的优化</h4><blockquote>
<p>核心思想: 加载所需的尺寸，通过设置<code>BitmapFactory的Options</code></p>
</blockquote>
<p>关键代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public Bitmap decodeSimpleBitmapFromResource(Resources res, int resId,</div><div class="line"> int reqWidth, int reqHeight) &#123;</div><div class="line">    BitmapFactory.Options options = new BitmapFactory.Options();</div><div class="line">  options.inJustDecodeBounds = true;</div><div class="line">  BitmapFactory.decodeResource(res, resId, options);    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);    options.inJustDecodeBounds = false;</div><div class="line"> return BitmapFactory.decodeResource(res,resId,options); &#125;</div><div class="line"></div><div class="line">private int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) &#123;</div><div class="line">    int outWidth = options.outWidth;</div><div class="line"> int outHeight = options.outHeight;   int sampleSize = 1;   if (outHeight &gt; outWidth || outWidth &gt; outHeight) &#123;</div><div class="line">        int halfWidth = outWidth / 2;</div><div class="line"> int halfHeight = outHeight / 2;   while ((halfHeight / sampleSize) &gt;= reqHeight &amp;&amp;</div><div class="line">                (halfWidth / sampleSize) &gt;= reqWidth) &#123;</div><div class="line">            sampleSize *= 2;</div><div class="line">  &#125;</div><div class="line">    &#125;</div><div class="line">    return sampleSize; &#125;</div></pre></td></tr></table></figure></p>
<p>Options有两个关键参数 ，<code>inJustDecodeBounds</code>和<code>inSampleSize</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * If set to true, the decoder will return null (no bitmap), but * the out... fields will still be set, allowing the caller to query * the bitmap without having to allocate the memory for its pixels. */ public boolean inJustDecodeBounds;</div></pre></td></tr></table></figure></p>
<p>当这个参数设置为<code>true</code>的时候，它不会立刻加载图片，而是允许调用者计算需要的大小。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * If set to a value &gt; 1, requests the decoder to subsample the original * image, returning a smaller image to save memory. The sample size is * the number of pixels in either dimension that correspond to a single * pixel in the decoded bitmap. For example, inSampleSize == 4 returns * an image that is 1/4 the width/height of the original, and 1/16 the * number of pixels. Any value &lt;= 1 is treated the same as 1. Note: the * decoder uses a final value based on powers of 2, any other value will * be rounded down to the nearest power of 2. */ public int inSampleSize;</div></pre></td></tr></table></figure>
<p><code>inSampleSize</code>为采样率，总是大于1并且建议为2的倍数。比如一个ImageView为100<em>100像素，图片为200</em>200，那么我们设置采样率为2，就可以。</p>
<p>完整的步骤如下。</p>
<ul>
<li>将<code>BitmapFactory的Options</code>的<code>inJustDecodeBounds</code>设置为<code>true</code>并加载图片。</li>
<li>从<code>BitmapFactory的Options</code>中取出图片的原始宽高信息</li>
<li>根据规则计算采样率</li>
<li>将<code>BitmapFactory的Options</code>的<code>inJustDecodeBounds</code>设置为<code>false</code>,重新加载图片。</li>
</ul>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> 图片加载 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android的ANR文件导出]]></title>
      <url>/2017/10/07/Android%E7%9A%84ANR%E6%96%87%E4%BB%B6%E5%AF%BC%E5%87%BA/</url>
      <content type="html"><![CDATA[<h2 id="—"><a href="#—" class="headerlink" title="—-"></a>—-</h2><p>在应用程序ANR的时候，会在<code>/data/anr</code>下面生成<code>traces.txt</code>文件<br>使用 <code>adb pull /data/anr/traces.txt /Users/wangchangqin/Downloads</code>命令可以导出分析</p>
]]></content>
      
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> ANR </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iterm2快捷键]]></title>
      <url>/2017/09/14/iterm2%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
      <content type="html"><![CDATA[<h2 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h2><ul>
<li><p>新建标签：command + t</p>
</li>
<li><p>关闭标签：command + w</p>
</li>
<li><p>切换标签：command + 数字 command + 左右方向键</p>
</li>
<li><p>切换全屏：command + enter</p>
</li>
<li><p>查找：command + f</p>
</li>
</ul>
<hr>
<h2 id="分屏"><a href="#分屏" class="headerlink" title="分屏"></a>分屏</h2><ul>
<li><p>垂直分屏：command + d</p>
</li>
<li><p>水平分屏：command + shift + d</p>
</li>
<li><p>切换屏幕：command + option + 方向键 command + [ 或 command + ]</p>
</li>
<li><p>查看历史命令：command + ;</p>
</li>
<li><p>查看剪贴板历史：command + shift + h</p>
</li>
</ul>
<hr>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li><p>清除当前行：ctrl + u</p>
</li>
<li><p>到行首：ctrl + a</p>
</li>
<li><p>到行尾：ctrl + e</p>
</li>
<li><p>前进后退：ctrl + f/b (相当于左右方向键)</p>
</li>
<li><p>上一条命令：ctrl + p</p>
</li>
<li><p>搜索命令历史：ctrl + r</p>
</li>
<li><p>删除当前光标的字符：ctrl + d</p>
</li>
<li><p>删除光标之前的字符：ctrl + h</p>
</li>
<li><p>删除光标之前的单词：ctrl + w</p>
</li>
<li><p>删除到文本末尾：ctrl + k</p>
</li>
<li><p>交换光标处文本：ctrl + t</p>
</li>
<li><p>清屏1：command + r</p>
</li>
<li><p>清屏2：ctrl + l</p>
</li>
</ul>
<hr>
<h2 id="自带有哪些很实用的功能-快捷键"><a href="#自带有哪些很实用的功能-快捷键" class="headerlink" title="自带有哪些很实用的功能/快捷键"></a>自带有哪些很实用的功能/快捷键</h2><ul>
<li><p>⌘ + 数字在各 tab 标签直接来回切换</p>
</li>
<li><p>选择即复制 + 鼠标中键粘贴，这个很实用</p>
</li>
<li><p>⌘ + f 所查找的内容会被自动复制</p>
</li>
<li><p>⌘ + d 横着分屏 / ⌘ + shift + d 竖着分屏</p>
</li>
<li><p>⌘ + r = clear，而且只是换到新一屏，不会想 clear 一样创建一个空屏</p>
</li>
<li><p>ctrl + u 清空当前行，无论光标在什么位置</p>
</li>
<li><p>输入开头命令后 按 ⌘ + ; 会自动列出输入过的命令</p>
</li>
<li><p>⌘ + shift + h 会列出剪切板历史</p>
</li>
<li><p>可以在 Preferences &gt; keys 设置全局快捷键调出 iterm，这个也可以用过 Alfred 实现</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> Mac </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac iterm2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[(转)AppBarLayout的五种ScrollFlags]]></title>
      <url>/2017/09/13/%E8%BD%AC-AppBarLayout%E7%9A%84%E4%BA%94%E7%A7%8DScrollFlags/</url>
      <content type="html"><![CDATA[<h3 id="转-AppBarLayout的五种ScrollFlags"><a href="#转-AppBarLayout的五种ScrollFlags" class="headerlink" title="(转)AppBarLayout的五种ScrollFlags"></a>(转)AppBarLayout的五种ScrollFlags</h3><h1 id="scroll"><a href="#scroll" class="headerlink" title="scroll"></a>scroll</h1><hr>
<blockquote>
<p>The view will be scroll in direct relation to scroll events. This flag needs to be set for any of the other flags to take effect. If any sibling views before this one do not have this flag, then this value has no effect.</p>
</blockquote>
<p>Child View 伴随着滚动事件而滚出或滚进屏幕。注意两点：第一点，如果使用了其他值，必定要使用这个值才能起作用；第二点：如果在这个child View前面的任何其他Child View没有设置这个值，那么这个Child View的设置将失去作用。<br>示例XML代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;android.support.design.widget.AppBarLayout</div><div class="line">    android:id=&quot;@+id/appbar&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;wrap_content&quot;</div><div class="line">    android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;&gt;</div><div class="line"></div><div class="line">    &lt;android.support.v7.widget.Toolbar</div><div class="line">        xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</div><div class="line">        android:id=&quot;@+id/tb_toolbar&quot;</div><div class="line">        android:layout_width=&quot;match_parent&quot;</div><div class="line">        android:layout_height=&quot;@dimen/dp_56&quot;</div><div class="line">        app:titleTextColor=&quot;@color/white&quot;</div><div class="line">        app:title=&quot;@string/app_name&quot;</div><div class="line">        app:theme=&quot;@style/OverFlowMenuTheme&quot;</div><div class="line">        app:popupTheme=&quot;@style/AppTheme&quot;</div><div class="line">        android:background=&quot;@color/blue&quot;</div><div class="line">        app:layout_scrollFlags=&quot;scroll|enterAlways&quot;/&gt;</div><div class="line"></div><div class="line">&lt;/android.support.design.widget.AppBarLayout&gt;</div></pre></td></tr></table></figure>
<p>对应效果图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1094967-877bd6d61a4e22f9.gif?imageMogr2/auto-orient/strip" alt=""></p>
<p>Samples01.gif</p>
<h1 id="enterAlways"><a href="#enterAlways" class="headerlink" title="enterAlways"></a>enterAlways</h1><hr>
<blockquote>
<p>When entering (scrolling on screen) the view will scroll on any downwards scroll event, regardless of whether the scrolling view is also scrolling. This is commonly referred to as the ‘quick return’ pattern.</p>
</blockquote>
<p>快速返回模式。其实就是向下滚动时Scrolling View和Child View之间的滚动优先级问题。对比<code>scroll</code>和<code>scroll | enterAlways</code>设置，发生向下滚动事件时，前者优先滚动Scrolling View，后者优先滚动Child View，当优先滚动的一方已经全部滚进屏幕之后，另一方才开始滚动。</p>
<p>示例XML代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">app:layout_scrollFlags=&quot;scroll|enterAlways&quot;</div><div class="line">...</div></pre></td></tr></table></figure>
<p>对应效果图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1094967-e0873ea34c4637a5.gif?imageMogr2/auto-orient/strip" alt=""></p>
<p>Samples02.gif</p>
<h1 id="enterAlwaysCollapsed"><a href="#enterAlwaysCollapsed" class="headerlink" title="enterAlwaysCollapsed"></a>enterAlwaysCollapsed</h1><hr>
<blockquote>
<p>An additional flag for ‘enterAlways’ which modifies the returning view to only initially scroll back to it’s collapsed height. Once the scrolling view has reached the end of it’s scroll range, the remainder of this view will be scrolled into view. The collapsed height is defined by the view’s minimum height.</p>
</blockquote>
<p>enterAlways的附加值。这里涉及到Child View的高度和最小高度，向下滚动时，Child View先向下滚动最小高度值，然后Scrolling View开始滚动，到达边界时，Child View再向下滚动，直至显示完全。</p>
<p>示例XML代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">android:layout_height=&quot;@dimen/dp_200&quot;</div><div class="line">android:minHeight=&quot;@dimen/dp_56&quot;</div><div class="line">...</div><div class="line">app:layout_scrollFlags=&quot;scroll|enterAlways|enterAlwaysCollapsed&quot;</div><div class="line">...</div></pre></td></tr></table></figure>
<p>对应效果图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1094967-4ab6365b7fac590e.gif?imageMogr2/auto-orient/strip" alt=""></p>
<p>Samples03.gif</p>
<h1 id="exitUntilCollapsed"><a href="#exitUntilCollapsed" class="headerlink" title="exitUntilCollapsed"></a>exitUntilCollapsed</h1><hr>
<blockquote>
<p>When exiting (scrolling off screen) the view will be scrolled until it is ‘collapsed’. The collapsed height is defined by the view’s minimum height.</p>
</blockquote>
<p>这里也涉及到最小高度。发生向上滚动事件时，Child View向上滚动退出直至最小高度，然后Scrolling View开始滚动。也就是，Child View不会完全退出屏幕。</p>
<p>示例SML代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">android:layout_height=&quot;@dimen/dp_200&quot;</div><div class="line">android:minHeight=&quot;@dimen/dp_56&quot;</div><div class="line">...</div><div class="line">app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;</div><div class="line">...</div></pre></td></tr></table></figure>
<p>对应效果图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1094967-6f683857f6d567ca.gif?imageMogr2/auto-orient/strip" alt=""></p>
<p>Samples04.gif</p>
<h1 id="snap"><a href="#snap" class="headerlink" title="snap"></a>snap</h1><hr>
<blockquote>
<p>Upon a scroll ending, if the view is only partially visible then it will be snapped and scrolled to it’s closest edge. For example, if the view only has it’s bottom 25% displayed, it will be scrolled off screen completely. Conversely, if it’s bottom 75% is visible then it will be scrolled fully into view.</p>
</blockquote>
<p>简单理解，就是Child View滚动比例的一个吸附效果。也就是说，Child View不会存在局部显示的情况，滚动Child View的部分高度，当我们松开手指时，Child View要么向上全部滚出屏幕，要么向下全部滚进屏幕，有点类似ViewPager的左右滑动。</p>
<p>示例XML代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">android:layout_height=&quot;@dimen/dp_200&quot;</div><div class="line">...</div><div class="line">app:layout_scrollFlags=&quot;scroll|snap&quot;</div><div class="line">...</div></pre></td></tr></table></figure>
<p>对应效果图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1094967-7d9619ee3fb0d974.gif?imageMogr2/auto-orient/strip" alt=""></p>
<p>Samples05.gif</p>
<p>本文转载自<a href="http://www.jianshu.com/p/7caa5f4f49bd" target="_blank" rel="external">http://www.jianshu.com/p/7caa5f4f49bd</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[安卓自动化测试文档]]></title>
      <url>/2017/09/08/%E5%AE%89%E5%8D%93%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E6%96%87%E6%A1%A3/</url>
      <content type="html"><![CDATA[<h2 id="安卓自动化测试文档"><a href="#安卓自动化测试文档" class="headerlink" title="安卓自动化测试文档"></a>安卓自动化测试文档</h2><h3 id="Monkey"><a href="#Monkey" class="headerlink" title="Monkey"></a>Monkey</h3><h4 id="1-Monkey"><a href="#1-Monkey" class="headerlink" title="1. Monkey"></a>1. Monkey</h4><pre><code>安卓SDK自带的测试工具，    顾名思义，Monkey就是一只猴子，到处乱抓、乱按，属于压力测试软件。
特点： 1.测试对象为程序包，有一定局限性 2.伪随机事件，不能自定义 3.可对事件数量、类型、频率设置
</code></pre><h4 id="2-环境变量配置"><a href="#2-环境变量配置" class="headerlink" title="2. 环境变量配置"></a>2. 环境变量配置</h4><p>以macOs为例<br>运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open ~/.zshrc</div></pre></td></tr></table></figure></p>
<p>新增环境变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">export PATH=$&#123;PATH&#125;:/Users/wangchangqin/develop/android/sdk/platform-tools</div><div class="line">export PATH=$&#123;PATH&#125;:/Users/wangchangqin/develop/android/sdk/tools</div><div class="line">export PATH=$&#123;PATH&#125;:/Users/wangchangqin/develop/android/sdk/tools/bin</div></pre></td></tr></table></figure></p>
<p>这样就把monkeyrunner 配置到环境变量了。<br><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fjbygk3zpuj30em050756.jpg" alt=""></p>
<h4 id="3-Monkey基本用法"><a href="#3-Monkey基本用法" class="headerlink" title="3. Monkey基本用法"></a>3. Monkey基本用法</h4><pre><code>**adb shell monkey [option]**
option为可选参数，如果不加的话,默认会测试所有的APP。

**adb shell monkey -p your.package.name &lt;event count &gt;**
-p用来指定需要测试的APP，后面跟测试APP的包名 event count 表示需要发送事件的个数。
</code></pre><h4 id="4-Monkey基础参数"><a href="#4-Monkey基础参数" class="headerlink" title="4. Monkey基础参数"></a>4. Monkey基础参数</h4><ul>
<li><strong>-p</strong> <your.package.name><br>  用于指定一个包或多个包，指定了包之后，Monkey将只启动指定的APP，不指定的话，将允许启动所有的APP。</your.package.name></li>
<li><strong>-c</strong> <category><br>  如果用此参数指定了一个或几个类别，Monkey将只允许系统启动被这些类别中的某个类别列出的Activity。如果不指定任何类别，Monkey将选择下列类别中列出的Activity:Intent.CATEGORY.LAUNCHER或Intent.CATEGORY.MONKEY。要指定多个类别，需要使用多个-c选项，每个-c选项只能用于一个类别。</category></li>
<li><strong>-v</strong> 日志反馈级别。总共分3个级别，分别对应的参数如下所示：<br>  | Level | cmd | Info |<br>  | — | — | – |<br>  | -v | Level 0  :  adb shell monkey -p your.package.name -v 100 | 缺省值，仅提供启动提示、测试完        成和最终结果等少量信息 |<br>  | -v -v | adb shell monkey -p your.package.name -v  -v 100 | 提供较为详细的日志，包括每个发送到Activity的事件信息 |<br>  | -v -v -v | adb shell monkey -p your.package.name -v  -v  -v 100 | 最详细的日志，包括了测试中选中/未选中的Activity信息 |</li>
<li><strong>-s</strong> (随机数种子)<br>  用于指定伪随机数生成器的seed值，如果seed相同，则两次Monkey测试所产生的事件序列也相同的。  示例：<br>  monkey测试1：adb shell monkey -p your.package.name –s 10 100<br>  monkey测试2：adb shell monkey -p your.package.name –s 10 100    </li>
<li><strong>–throttle</strong> &lt;毫秒&gt;<br>  用于指定用户操作（即事件）间的时延，单位是毫秒；如果不指定这个参数，monkey会尽可能快的 生成和发送消息。<br>  例：adb shell monkey -p your.package.name –throttle 3000 100</li>
</ul>
<h4 id="5-Monkey发送事件的类型"><a href="#5-Monkey发送事件的类型" class="headerlink" title="5. Monkey发送事件的类型"></a>5. Monkey发送事件的类型</h4><ul>
<li><strong>–pct-touch<percent></percent></strong><br>  调整触摸事件的百分比（触摸事件是一个down-up事件），它发生在屏幕上的某单一位置</li>
<li><strong>–pct-motion<percent></percent></strong><br>  调整动作事件的百分比（动作事件是由屏幕上某处的一个down事件、一系列的伪随机事件和一个up事件组成）</li>
<li><strong>–pct-trackball<percent></percent></strong><br>  调整轨迹事件的百分比（轨迹事件由一个或几个随机的移动组成，有时还伴随有点击）事件</li>
<li><strong>–pct-nav<percent></percent></strong><br>  调整“基本”导航时间的百分比（导航事件由来自方向输入设备的up/down/left/right组成）</li>
<li><strong>–pct-majornav<percent></percent></strong><br>  调整“主要”导航事件的百分比（这些导航事件通常引发图形界面中的动作，如5-way键盘的中间按键、回退按键、菜单按键）</li>
<li><strong>–pct-syskeys<percent></percent></strong><br>  调整“系统”按钮事件的百分比（这些按键通常被保留，由系统使用，如Home、Back、StartCall、End   Call及音量控制键）</li>
<li><strong>–pct-appswitch</strong><br>  调整启动Activity的百分比。在随机间隔里，Monkey执行一个startActivity()调用，作为最大程度覆盖包中全部Activity的一种方法</li>
<li><strong>–pct-anyevent<percent></percent></strong><br>  调整其他类型事件的百分比。它包罗了所有其他类型的事件，如：按键、其他不常用的设备按钮等</li>
<li><strong>–pct-flip<percent></percent></strong></li>
<li><strong>–pct-pinchzoom<percnet></percnet></strong></li>
</ul>
<h4 id="6-Monkey调试参数"><a href="#6-Monkey调试参数" class="headerlink" title="6. Monkey调试参数"></a>6. Monkey调试参数</h4><ul>
<li><strong>–dbg-no-events</strong><br>  设置此选项，Monkey将执行初始启动，进入到一个测试Activity，然后不会再进一步生成事件。最好将它与-v、一个或几个包约束。以及一个保持Monkey运行30秒或更长事件的非零值联合起来，从而提供一个环境，可以监视应用程序所调用的包之间的转换</li>
<li><strong>–hprof</strong><br>  设置此选项，将在Monkey事件序列之前和之后立即生成profiling报告，这将在data/misc中生成大文件（~5MB），所以要小心使用</li>
<li><strong>–ignore-crashes</strong><br>  通常，当应用程序崩溃或发生任何失控异常时，Monkey将停止运行。如果设置此选项，Monkey将继续向系统发送事件，直到计数完成</li>
<li><strong>–ignore-timeouts</strong><br>  应用程序发生任何超时错误（如”Application   Not Responding”对话框）时，Monkey将停止运行。如果设置此选项，Monkey将继续向系统发送事件，直到计数完成</li>
<li><strong>–ingore-security-exceptions</strong><br>  当应用程序发生权限许可错误时，Monkey将停止运行。如果设置了此选项，Monkey将继续向系统发送事件，直到计数完成</li>
<li><strong>–ingnore-native-crashes</strong><br>  当应用程序发生底层C/C++代码引起的崩溃事件时，Monkey将停止运行。选择此项，Monkey将继续向系统发送事件，直到计数完成</li>
<li><strong>–monitor-native-crashes</strong><br>  监视并报告Android系统中Android   C/C++引起的崩溃事件。如果设置了–kill-process-after-error，系统将停止运行</li>
<li><strong>–kill-process-after-error</strong><br>  当Monkey由于一个错误而停止时，出错的应用程序将继续处于运行状态。当设置了此选项时，将会通知系统停止发生错误的进程。注意，当Monkey正常执行完毕，它不会关闭所有启动的应用，设备依然保留Monkey结束时的状态</li>
<li><strong>–wait-dbq</strong><pre><code>启动Monkey后，先中断其运行，等待调试器附加上来
</code></pre></li>
</ul>
<h4 id="7-Monkey黑名单与白名单"><a href="#7-Monkey黑名单与白名单" class="headerlink" title="7. Monkey黑名单与白名单"></a>7. Monkey黑名单与白名单</h4><pre><code>***黑名单：不测试的应用***
***白名单：只测试这部分应用***
***注意：不能同时设置黑名单和白名单***
</code></pre><ul>
<li><strong>–pkg-blacklist-file</strong><br>  apk黑名单，屏蔽掉黑名单中的apk</li>
<li><strong>–pkg-whitelist-file</strong><br>  apk白名单，只测试包含在白名单中的apk</li>
</ul>
<p>以黑名单为例，具体的步骤如下：</p>
<pre><code>1.  查找系统的包，并输出到e盘的pkg文档里。adb shell pm list package&gt;e:\pkg.txt
2.  将想要加入黑名单的apk的包名放到blacklist.txt里，最后push进设备。adb push e:\blacklist.txt /data/local/tmp/
3.  执行Monkey命令。adb shell monkey --pkg-blacklist-file /data/local/tmp/blacklist.txt --throttle 200 200
</code></pre><h4 id="8-MonkeyRunner常用的按键介绍"><a href="#8-MonkeyRunner常用的按键介绍" class="headerlink" title="8. MonkeyRunner常用的按键介绍"></a>8. MonkeyRunner常用的按键介绍</h4><p>Home键：KEYCOD_HOME<br> Back键：KEYCODE_BACK<br>send键：KEYCODE_CALL<br>end键：KEYCODE_ENDCALL  </p>
<p>上导航键：KEYCODE_DPAD_UP（现在手机已经没有这个键）<br>下导航键：KEYCODE_DPAD_DOWN（现在手机已经没有这个键）<br>左导航：KEYCODE_DPAD_LEFT   现在手机已经没有这个键<br>右导航键：KEYCODE_DPAD_RIGHT 现在手机已经没有这个键 </p>
<p>ok键：KEYCODE_DPAD_CENTER </p>
<p>上音量键：KEYCODE_VOLUME_UP<br>下音量键：KEYCODE_VOLUME_DOWN </p>
<p>power键：KEYCODE_POWER<br>camera键：KEYCODE_CAMERA<br>menu键：KEYCODE_MENU<br>search键：KEYCODE_SEARCH<br>call键：KEYCODE_CALL </p>
<p>按下HOME键 device.press(‘KEYCODE_HOME’,MonkeyDevice.DOWN_AND_UP)<br>按下BACK键 device.press(‘KEYCODE_BACK’,MonkeyDevice.DOWN_AND_UP)<br>按下下导航键 device.press(‘KEYCODE_DPAD_DOWN’,MonkeyDevice.DOWN_AND_UP)<br>按下上导航键 device.press(‘KEYCODE_DPAD_UP’,MonkeyDevice.DOWN_AND_UP)<br>按下OK键 device.press(‘KEYCODE_DPAD_CENTER’,MonkeyDevice.DOWN_AND_UP)   </p>
<p>device.press(‘KEYCODE_ENTER’,MonkeyDevice.DOWN_AND_UP)#输入回车</p>
<p>device.press(‘KEYCODE_BACK’,MonkeyDevice.DOWN_AND_UP)#点击返回</p>
<h4 id="9-停止命令"><a href="#9-停止命令" class="headerlink" title="9. 停止命令"></a>9. 停止命令</h4><p>adb shell ps | grep monkey<br>返回来的第一个数字，即是monkey的进程号<br>adb shell kill [刚才查到的进程号]</p>
<h2 id="UiAutomator2"><a href="#UiAutomator2" class="headerlink" title="UiAutomator2"></a>UiAutomator2</h2><h4 id="1-环境配置，以Android-Studio为例"><a href="#1-环境配置，以Android-Studio为例" class="headerlink" title="1. 环境配置，以Android Studio为例"></a>1. 环境配置，以Android Studio为例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    ...</div><div class="line">    //测试框架</div><div class="line">    // Force usage of support annotations in the test app, since it is internally used by the runner module.</div><div class="line">    androidTestCompile &apos;com.android.support:support-annotations:25.4.0&apos;</div><div class="line">    androidTestCompile &apos;com.android.support.test:runner:1.0.0&apos;</div><div class="line">    // UiAutomator Testing</div><div class="line">    androidTestCompile &apos;com.android.support.test.uiautomator:uiautomator-v18:2.1.3&apos;</div><div class="line">    androidTestCompile &apos;org.hamcrest:hamcrest-integration:1.3&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    compileSdkVersion 25</div><div class="line">    buildToolsVersion &quot;25.0.3&quot;</div><div class="line">    defaultConfig &#123;</div><div class="line">       ...</div><div class="line">        testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="2-Google官方Demo"><a href="#2-Google官方Demo" class="headerlink" title="2. Google官方Demo"></a>2. Google官方Demo</h4><ul>
<li><code>[Demo](https://github.com/googlesamples/android-testing/tree/master/ui/uiautomator/BasicSample)</code></li>
<li><code>[文档](https://developer.android.com/training/testing/ui-automator.html)</code></li>
</ul>
<h4 id="3-常见API"><a href="#3-常见API" class="headerlink" title="3. 常见API"></a>3. 常见API</h4><ul>
<li></li>
</ul>
<h2 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h2><ul>
<li><a href="http://t.leborn.me/blog/home/detail/1509242157594151495" target="_blank" rel="external">http://t.leborn.me/blog/home/detail/1509242157594151495</a></li>
<li><a href="http://www.cnblogs.com/ITGirl00/p/4141277.html" target="_blank" rel="external">http://www.cnblogs.com/ITGirl00/p/4141277.html</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
            <category> Test </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Test </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Linux下添加FTP账号和服务器、增加密码和用户，更改FTP目录]]></title>
      <url>/2017/09/07/Linux%E4%B8%8B%E6%B7%BB%E5%8A%A0FTP%E8%B4%A6%E5%8F%B7%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E5%A2%9E%E5%8A%A0%E5%AF%86%E7%A0%81%E5%92%8C%E7%94%A8%E6%88%B7%EF%BC%8C%E6%9B%B4%E6%94%B9FTP%E7%9B%AE%E5%BD%95/</url>
      <content type="html"><![CDATA[<p><strong>1、 启动VSFTP服务器</strong></p>
<p>A:cenos下运行:yum  install  vsftpd</p>
<p>B. 登录Linux主机后，运行命令：”service vsftpd start”</p>
<p>C. 要让FTP每次开机自动启动，运行命令:  “chkconfig –level 35 vsftpd on”</p>
<blockquote>
<p><strong>2、设置FTP权限</strong></p>
</blockquote>
<p>A. 编辑VSFTP配置文件，运行命令：”vi /etc/vsftpd/vsftpd.conf “</p>
<p>B. 将配置文件中”anonymous_enable=YES “改为 “anonymous_enable=NO”</p>
<p>C. 保存修改，按ESC键，运行命令：“：wq”</p>
<p>这样关闭了匿名登录功能。</p>
<blockquote>
<p><strong>3、添加FTP账号</strong></p>
</blockquote>
<p>A. 登录Linux主机后，运行命令：”useradd ftpadmin -s /sbin/nologin “。该账户路径默认指向/home/ftpadmin目录；如果需要将用户指向其他目录，请运行命令：useradd ftpadmin -s /sbin/nologin –d /www(其他目录)</p>
<p>B. 设置ftpadmin用户密码，运行命令：”passwd ftpadmin” ; 输入两次密码，匹配成功后，就设置好了ftpadmin用户的密码了。</p>
<p>C.测试连接，您可以在“我的电脑”地址栏中输入<strong> ftp://IP </strong>来连接FTP服务器，根据提示输入账户密码。</p>
<blockquote>
<p><strong>4、FTP数据传输注意事项</strong></p>
</blockquote>
<p>A. 尽量把文件打包后上传。Linux无法识别RAR压缩包，可以使用ZIP压缩。</p>
<p>B.上传数据时请选择二进制编码，如果选择其他编码，可能会导致上传的压缩包无法打开。</p>
<p><a href="http://www.cnblogs.com/Anders888/p/4169710.html" target="_blank" rel="external">centos FTP 用户指定目录禁用上级目录</a></p>
<p>在默认配置下，本地用户登入FTP后可以使用cd命令切换到其他目录，这样会对系统带来安全隐患。可以通过以下三条配置文件来控制用户切换目录。<br>chroot_list_enable=YES/NO（NO）<br>设置是否启用chroot_list_file配置项指定的用户列表文件。默认值为NO。<br>chroot_list_file=/etc/vsftpd.chroot_list<br>用于指定用户列表文件，该文件用于控制哪些用户可以切换到用户家目录的上级目录。<br>chroot_local_user=YES/NO（NO）<br>用于指定用户列表文件中的用户是否允许切换到上级目录。默认值为NO。<br>通过搭配能实现以下几种效果：<br>①当chroot_list_enable=YES，chroot_local_user=YES时，在/etc/vsftpd.chroot_list文件中列出的用户，可以切换到其他目录；未在文件中列出的用户，不能切换到其他目录。<br>②当chroot_list_enable=YES，chroot_local_user=NO时，在/etc/vsftpd.chroot_list文件中列出的用户，不能切换到其他目录；未在文件中列出的用户，可以切换到其他目录。<br>③当chroot_list_enable=NO，chroot_local_user=YES时，所有的用户均不能切换到其他目录。<br>④当chroot_list_enable=NO，chroot_local_user=NO时，所有的用户均可以切换到其他目录。</p>
<p>转自<a href="http://blog.csdn.net/xinguan1267/article/details/47751137" target="_blank" rel="external">http://blog.csdn.net/xinguan1267/article/details/47751137</a></p>
]]></content>
      
        <categories>
            
            <category> Centos </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Centos </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[go 入门资料]]></title>
      <url>/2017/09/05/go%E5%85%A5%E9%97%A8%E8%B5%84%E6%96%99/</url>
      <content type="html"><![CDATA[<h2 id="go-官方-tour"><a href="#go-官方-tour" class="headerlink" title="go 官方 tour"></a>go 官方 tour</h2><p><a href="https://tour.golang.org/welcome/1" target="_blank" rel="external">https://tour.golang.org/welcome/1</a> </p>
<h2 id="An-Introduction-to-Programming-in-Go"><a href="#An-Introduction-to-Programming-in-Go" class="headerlink" title="An Introduction to Programming in Go"></a>An Introduction to Programming in Go</h2><p><a href="https://www.golang-book.com/books/intro" target="_blank" rel="external">https://www.golang-book.com/books/intro</a></p>
<p>英文书，但是写的通俗易懂，入门非常合适</p>
<h2 id="The-Little-Go-Book"><a href="#The-Little-Go-Book" class="headerlink" title="The Little Go Book"></a>The Little Go Book</h2><p><a href="http://openmymind.net/The-Little-Go-Book/" target="_blank" rel="external">http://openmymind.net/The-Little-Go-Book/</a></p>
<p>英文书，入门读物</p>
<h2 id="Learning-Go"><a href="#Learning-Go" class="headerlink" title="Learning Go"></a>Learning Go</h2><p><a href="https://www.miek.nl/go/" target="_blank" rel="external">https://www.miek.nl/go/</a></p>
<p>每章附有习题可以练习</p>
<h2 id="Go-入门指南"><a href="#Go-入门指南" class="headerlink" title="Go 入门指南"></a>Go 入门指南</h2><p><a href="https://github.com/Unknwon/the-way-to-go_ZH_CN" target="_blank" rel="external">https://github.com/Unknwon/the-way-to-go_ZH_CN</a></p>
<h2 id="build-web-application-with-golang"><a href="#build-web-application-with-golang" class="headerlink" title="build-web-application-with-golang"></a>build-web-application-with-golang</h2><p>Beego 作者写的，中文，除了 go 语言基础也涉及 Go web 编程。</p>
<p><a href="https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/preface.md" target="_blank" rel="external">https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/preface.md</a></p>
<h2 id="大量-web-示例"><a href="#大量-web-示例" class="headerlink" title="大量 web 示例"></a>大量 web 示例</h2><p><a href="https://gowebexamples.github.io/" target="_blank" rel="external">https://gowebexamples.github.io/</a></p>
<h2 id="大量-go-基础示例"><a href="#大量-go-基础示例" class="headerlink" title="大量 go 基础示例"></a>大量 go 基础示例</h2><p><a href="https://gobyexample.com/" target="_blank" rel="external">https://gobyexample.com/</a></p>
<h2 id="完整教程的项目练习"><a href="#完整教程的项目练习" class="headerlink" title="完整教程的项目练习"></a>完整教程的项目练习</h2><p><a href="https://github.com/tuvttran/project-based-learning#go" target="_blank" rel="external">https://github.com/tuvttran/project-based-learning#go</a></p>
<h2 id="其他资源"><a href="#其他资源" class="headerlink" title="其他资源"></a>其他资源</h2><ul>
<li><p><a href="https://github.com/dariubs/GoBooks" target="_blank" rel="external">https://github.com/dariubs/GoBooks</a> go 书籍</p>
</li>
<li><p><a href="https://golang.org/doc/effective_go.html" target="_blank" rel="external">https://golang.org/doc/effective_go.html</a> 官方 effective go</p>
</li>
<li><p><a href="https://github.com/golang/go/wiki/Learn" target="_blank" rel="external">https://github.com/golang/go/wiki/Learn</a> 官方 learn wiki</p>
</li>
</ul>
<p>本文转自!(这里)[<a href="https://mp.weixin.qq.com/s?__biz=MzA4NzAzMjk4Mw==&amp;mid=2247483738&amp;idx=1&amp;sn=784b773657b8738881267e7beba6417b&amp;chksm=903ed4a2a7495db4d67176dc37bc568f3b36ad6b3ed5a1e3df1b905c166e83c479d71b04166d&amp;scene=0&amp;key=dc7dfb672b5ac5a8ea6981f3dc3fefb0b9aff7f2e96ccb64f33c5b30774246dfd9b88b659424ca039c88e28cbfb14dd13b9b13e34e3a322859f23d516437d53b3f3cf03618e2c216452736100a95f304&amp;ascene=0&amp;uin=OTUyMjY5NDgw&amp;devicetype=iMac16,1%20OSX%20OSX%2010.12.3%20build(16D32)&amp;version=12020810&amp;nettype=WIFI&amp;fontScale=100&amp;pass_ticket=UCnt2mlbLQK0LQCE2WJzZ83b21CwTB3t3tmP+caHdGQf7ENogbeVafHJkNSqJs3F" target="_blank" rel="external">https://mp.weixin.qq.com/s?__biz=MzA4NzAzMjk4Mw==&amp;mid=2247483738&amp;idx=1&amp;sn=784b773657b8738881267e7beba6417b&amp;chksm=903ed4a2a7495db4d67176dc37bc568f3b36ad6b3ed5a1e3df1b905c166e83c479d71b04166d&amp;scene=0&amp;key=dc7dfb672b5ac5a8ea6981f3dc3fefb0b9aff7f2e96ccb64f33c5b30774246dfd9b88b659424ca039c88e28cbfb14dd13b9b13e34e3a322859f23d516437d53b3f3cf03618e2c216452736100a95f304&amp;ascene=0&amp;uin=OTUyMjY5NDgw&amp;devicetype=iMac16,1%20OSX%20OSX%2010.12.3%20build(16D32)&amp;version=12020810&amp;nettype=WIFI&amp;fontScale=100&amp;pass_ticket=UCnt2mlbLQK0LQCE2WJzZ83b21CwTB3t3tmP+caHdGQf7ENogbeVafHJkNSqJs3F</a> ]</p>
]]></content>
      
        <categories>
            
            <category> Go </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Go </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CoordinatorLayout.Behavior学习]]></title>
      <url>/2017/08/30/CoordinatorLayout-Behavior%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<h2 id="Behavior常用的方法"><a href="#Behavior常用的方法" class="headerlink" title="Behavior常用的方法"></a>Behavior常用的方法</h2><p>构造方法有两个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">默认：public Behavior() &#123;&#125;</div><div class="line"></div><div class="line">布局：public Behavior(Context context, AttributeSet attrs) &#123;  &#125;</div></pre></td></tr></table></figure>
<p>两个构造方法也比较容易理解，一个是默认的空参的构造方法，一个是带有布局属性<code>AttributeSet</code>的方法，有了这个构造方法，可以直接在布局文件中使用</p>
<hr>
<p>根据<code>Behavior</code>的特性，可以将内部的方法分以下类：</p>
<ul>
<li><strong>测量与布局：</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">测量：public boolean onMeasureChild()&#123;&#125;</div><div class="line">布局：public boolean onLayoutChild()&#123;&#125;</div></pre></td></tr></table></figure>
<ul>
<li><strong>特定状态：</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">//当Behavior添加到参数实例时，回调</div><div class="line">public void onAttachedToLayoutParams()&#123;&#125;</div><div class="line"></div><div class="line">//当Behavior与参数实例分离时，回调</div><div class="line">public void onDetachedFromLayoutParams()&#123;&#125;</div><div class="line"></div><div class="line">//当Behavior关联的对象想要定位到特定的矩形时，回调</div><div class="line">public boolean onRequestChildRectangleOnScreen()&#123;&#125;</div><div class="line"></div><div class="line">//当一个ChildView设置为回避属性时，回调</div><div class="line">public boolean getInsetDodgeRect()&#123;&#125;</div><div class="line"></div><div class="line">//当窗口发生改变时，回调</div><div class="line">public WindowInsetsCompat onApplyWindowInsets()&#123;&#125;</div><div class="line"></div><div class="line">//需要保存临时状态信息，回调</div><div class="line">public Parcelable onSaveInstanceState()&#123;&#125;</div><div class="line"></div><div class="line">//需要恢复临时状态信息，回调</div><div class="line">public void onRestoreInstanceState()&#123;&#125;</div><div class="line"></div><div class="line">//作用未知</div><div class="line">public int getScrimColor()&#123;&#125;</div><div class="line"></div><div class="line">//作用未知</div><div class="line">public float getScrimOpacity()&#123;&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p><strong>确定依赖与绑定对象：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//根据参数来确定依赖与绑定对象</div><div class="line">public boolean layoutDependsOn()&#123;&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>当依赖对象发生改变时：</strong></p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//当依赖对象发生改变，包括位置，大小，颜色，进行回调</div><div class="line">public boolean onDependentViewChanged()&#123;&#125;</div><div class="line"></div><div class="line">//当依赖对象被移除时，进行回调</div><div class="line">public void onDependentViewRemoved()&#123;&#125;</div></pre></td></tr></table></figure>
<ul>
<li><strong>事件相关：</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//拦截事件，在CoordinatorLayout把事件分发到childView之前</div><div class="line">public boolean onInterceptTouchEvent()&#123;&#125;</div><div class="line"></div><div class="line">//消费事件</div><div class="line">public boolean onTouchEvent()&#123;&#125;</div></pre></td></tr></table></figure>
<ul>
<li><strong>嵌套滑动：</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">//CoordinatorLayout中的滑动嵌套childView开始启动一次嵌套滚动时，回调</div><div class="line">public boolean onStartNestedScroll()&#123;&#125;</div><div class="line"></div><div class="line">//嵌套滑动结束时，回调</div><div class="line">public void onStopNestedScroll()&#123;&#125;</div><div class="line"></div><div class="line">//当一次嵌套滑动被CoordiantorLayout识别并确定时，进行回调</div><div class="line">public void onNestedScrollAccepted()&#123;&#125;</div><div class="line"></div><div class="line">//嵌套滚动正在进行中并且绑定目标childView已经开始滚动或者被CoordinatorLayout接受后试图滚动</div><div class="line">public void onNestedScroll()&#123;&#125;</div><div class="line"></div><div class="line">//嵌套滚动正在准备更新进度，并且是在绑定目标childView已经出现滚动距离之前，回调</div><div class="line">public void onNestedPreScroll()&#123;&#125;</div><div class="line"></div><div class="line">//当嵌套滚动的childView正在开始fling或者一个动作确认为fling</div><div class="line">public boolean onNestedFling()&#123;&#125;</div><div class="line"></div><div class="line">//当滑动嵌套childView检测到适当的条件，马上开始一次fling事件前回调</div><div class="line">public boolean onNestedPreFling()&#123;&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Mater Design </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[android studio jni 入门实战]]></title>
      <url>/2017/08/26/android-studio-jni-%E5%85%A5%E9%97%A8%E5%AE%9E%E6%88%98/</url>
      <content type="html"><![CDATA[<h2 id="—"><a href="#—" class="headerlink" title="—-"></a>—-</h2><h3 id="1-NDK的下载与环境配置"><a href="#1-NDK的下载与环境配置" class="headerlink" title="1. NDK的下载与环境配置."></a>1. NDK的下载与环境配置.</h3><p>首先进入as的设置，下载NDK<br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fix8ep6czcj31kw111k1f.jpg" alt=""><br>然后进入project structure设置路径<br><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fix8glb610j319k124jwk.jpg" alt=""><br>在local.properties里设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ndk.dir=/Users/wangchangqin/develop/android/sdk/ndk-bundle sdk.dir=/Users/wangchangqin/develop/android/sdk</div></pre></td></tr></table></figure></p>
<p>在gradle.properties里设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">org.gradle.jvmargs=-Xmx1536m android.useDeprecatedNdk=true</div></pre></td></tr></table></figure></p>
<h3 id="2-新建一个实体类"><a href="#2-新建一个实体类" class="headerlink" title="2.  新建一个实体类"></a>2.  新建一个实体类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public class JniTest &#123;</div><div class="line">    static &#123;</div><div class="line">        System.loadLibrary(&quot;wcqtest&quot;);</div><div class="line">    &#125;</div><div class="line">    public static native String getJniString(); </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这个wcqtest需要在build.gradle里配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;com.android.application&apos;   </div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion 26</div><div class="line">  buildToolsVersion &quot;26.0.1&quot;</div><div class="line">  defaultConfig &#123;</div><div class="line">        applicationId &quot;com.example.wangchangqin.ndkdemo2&quot;</div><div class="line">  minSdkVersion 23</div><div class="line">  targetSdkVersion 26</div><div class="line">  versionCode 1</div><div class="line">  versionName &quot;1.0&quot;</div><div class="line">  testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</div><div class="line">  ndk &#123;</div><div class="line">        moduleName &quot;wcqtest&quot;</div><div class="line">      abiFilters &quot;armeabi&quot;, &quot;armeabi-v7a&quot;, &quot;x86&quot;, &quot;mips&quot; </div><div class="line">    //输出指定三种abi体系结构下的so库。</div><div class="line">  &#125;</div><div class="line"> &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled false</div><div class="line">        proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">  &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">    compile fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;])</div><div class="line">    androidTestCompile(&apos;com.android.support.test.espresso:espresso-core:2.2.2&apos;, &#123;</div><div class="line">        exclude group: &apos;com.android.support&apos;, module: &apos;support-annotations&apos;</div><div class="line">  &#125;)</div><div class="line">    compile &apos;com.android.support:appcompat-v7:26.+&apos;</div><div class="line">  compile &apos;com.android.support.constraint:constraint-layout:1.0.2&apos;</div><div class="line">  testCompile &apos;junit:junit:4.12&apos; &#125;</div></pre></td></tr></table></figure>
<h3 id="3-头文件的生成"><a href="#3-头文件的生成" class="headerlink" title="3.  头文件的生成"></a>3.  头文件的生成</h3><p>进入java目录，make project<br>执行<br><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fix8oi7i4fj30o204474k.jpg" alt=""><br>在java目录下会生成.h头文件<br><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fix8qssmupj30jw03mq3g.jpg" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">/* DO NOT EDIT THIS FILE - it is machine generated */ #include &lt;jni.h&gt; /* Header for class com_example_wangchangqin_ndkdemo2_JniTest */   #ifndef _Included_com_example_wangchangqin_ndkdemo2_JniTest #define _Included_com_example_wangchangqin_ndkdemo2_JniTest #ifdef __cplusplus</div><div class="line">extern &quot;C&quot; &#123;</div><div class="line">#endif /*</div><div class="line"> * Class:     com_example_wangchangqin_ndkdemo2_JniTest * Method:    getJniString * Signature: ()Ljava/lang/String; */ JNIEXPORT jstring JNICALL Java_com_example_wangchangqin_ndkdemo2_JniTest_getJniString</div><div class="line">  (JNIEnv *, jclass);   #ifdef __cplusplus</div><div class="line">&#125;</div><div class="line">#endif #endif</div></pre></td></tr></table></figure></p>
<h3 id="4-新建jni目录，创建c或c-文件"><a href="#4-新建jni目录，创建c或c-文件" class="headerlink" title="4.  新建jni目录，创建c或c++文件"></a>4.  新建jni目录，创建c或c++文件</h3><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fix8u9fvwdj319e0wmagx.jpg" alt=""><br>把生成的头文件放到jni目录，创建tmp.c文件(名字随便)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#include &quot;com_example_wangchangqin_ndkdemo2_JniTest.h&quot;   JNIEXPORT jstring JNICALL Java_com_example_wangchangqin_ndkdemo2_JniTest_getJniString</div><div class="line">  (JNIEnv *env, jclass obj)&#123;</div><div class="line">    return (*env) -&gt; NewStringUTF(env,&quot;hello jni&quot;);</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<h3 id="5-运行"><a href="#5-运行" class="headerlink" title="5.  运行"></a>5.  运行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends AppCompatActivity &#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">  protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">  setContentView(R.layout.activity_main);                 Log.e(&quot;qqq&quot;,JniTest.getJniString());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>成功！<br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fix94t22zcj30y202smyw.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> JNI </tag>
            
            <tag> NDK </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[(转)30多个短小而又专业的最佳安卓开发者建议]]></title>
      <url>/2017/08/24/%E8%BD%AC-30%E5%A4%9A%E4%B8%AA%E7%9F%AD%E5%B0%8F%E8%80%8C%E5%8F%88%E4%B8%93%E4%B8%9A%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E8%80%85%E5%BB%BA%E8%AE%AE/</url>
      <content type="html"><![CDATA[<h1 id="【翻译】30多个短小而又专业的最佳安卓开发者建议"><a href="#【翻译】30多个短小而又专业的最佳安卓开发者建议" class="headerlink" title="【翻译】30多个短小而又专业的最佳安卓开发者建议"></a>【翻译】30多个短小而又专业的最佳安卓开发者建议</h1><p>2017-08-14 by Liuqingwen | Tags: <a href="http://liuqingwen.me/blog/tags/Android/" target="_blank" rel="external">Android</a></p>
<p><img src="http://liuqingwen.me/blog/2017/08/14/translation-of-30-bite-sized-pro-tips-to-become-a-better-android-developer/30tips.jpg" alt=""></p>
<h2 id="一、原文"><a href="#一、原文" class="headerlink" title="一、原文"></a><a href="http://liuqingwen.me/blog/2017/08/14/translation-of-30-bite-sized-pro-tips-to-become-a-better-android-developer/#一、原文" title="一、原文" target="_blank" rel="external"></a>一、原文</h2><p>文章是我在自己的 <a href="https://feedly.com/" target="_blank" rel="external">Feedly</a> 订阅上看到的，两个地方有原文的发布（新版和旧版）：<br><a href="https://blog.aritraroy.in/30-bite-sized-pro-tips-to-become-a-better-android-developer-b311fd641089" target="_blank" rel="external">30+ Bite-Sized Pro Tips to Become a Better Android Developer</a><br><a href="https://techbeacon.com/how-become-better-android-developer-30-bite-sized-pro-tips" target="_blank" rel="external">https://techbeacon.com/how-become-better-android-developer-30-bite-sized-pro-tips</a></p>
<p>小建议大用处！建议有能力的朋友优先阅读原版，翻译有不当之处请海涵哈!</p>
<h2 id="二、译文"><a href="#二、译文" class="headerlink" title="二、译文"></a><a href="http://liuqingwen.me/blog/2017/08/14/translation-of-30-bite-sized-pro-tips-to-become-a-better-android-developer/#二、译文" title="二、译文" target="_blank" rel="external"></a>二、译文</h2><h3 id="标题：-30-多个为成为一名更好的安卓开发者的短小而又专业的建议"><a href="#标题：-30-多个为成为一名更好的安卓开发者的短小而又专业的建议" class="headerlink" title="标题： 30 多个为成为一名更好的安卓开发者的短小而又专业的建议"></a><a href="http://liuqingwen.me/blog/2017/08/14/translation-of-30-bite-sized-pro-tips-to-become-a-better-android-developer/#标题：-30-多个为成为一名更好的安卓开发者的短小而又专业的建议" title="标题： 30 多个为成为一名更好的安卓开发者的短小而又专业的建议" target="_blank" rel="external"></a>标题： 30 多个为成为一名更好的安卓开发者的短小而又专业的建议</h3><p>成为一名安卓开发者很容易，但是<strong>要成为一名成功的、突出的安卓开发者</strong>却不那么容易。这需要付出很多的努力，耐心，奉献和毅力才能做到。</p>
<p>我并没有什么捷径或者简单的方法来告诉你让你成为一名成功的开发者。但是如果你愿意身心投入且付出努力的话，你肯定会得到应得的成功的。</p>
<p>应大家的请求为成为一名更优秀的安卓开发者，这里有<strong>一些从我的经验中吸收的小巧而专业的小窍门</strong>来助你一臂之力。所以，如果你决定从事安卓开发或者已经是一名安卓开发者的话，那么你算是找对地方了。</p>
<p>好了，不需要再浪费口舌了，让我们开始吧。</p>
<p><strong>1. 进一步熟悉安卓内部框架</strong></p>
<p>我并不是告诉你怎样去熟悉文档，我指的是实实在在的安卓框架的源码。我见过很多开发者很害怕查看或者深入安卓框架的内部，探索其实际工作原理和不同的模块之间是如何正确地一起运作。</p>
<p>如果你需要提升你的安卓技能，那么请克服对安卓 SDK 内部工作机制的恐惧感，并开始和它成为好朋友吧。</p>
<p><strong>2. 尝试克服对未知的害怕（ FoMo ）</strong></p>
<p>安卓系统很大，非常大。你不可能在一两个月内完全掌握它。随着学习越深入，你会发现越多的内容需要学习。作为一名初学者，很容易也很正常地会出现这种对未知恐惧的害怕。</p>
<p>但是尝试去克服它把。学习那些你确实需要用到的东西，能够让你开始手头正在构建的应用，然后慢慢地开拓你的视野。</p>
<p><strong>3. 开始阅读更多的代码</strong></p>
<p>大部分的开发者不会抽时间阅读其他开发者所写的代码。他们大部分时间只是花在写他们已经知道了的事情上。</p>
<p>但是那并不利于你成长为一名优秀的开发者。也不会增长你的见识。你应该从现在开始看一些开源的应用和类库并开始学习它们。每天 30 分钟的代码阅读量是个非常好的开始。你将会惊讶的发现：还有如此多的东西是你没见过的。</p>
<p>小贴士：<em>这里有一些最好的开源应用程序助你起航</em></p>
<p><a href="https://blog.aritraroy.in/20-awesome-open-source-android-apps-to-boost-your-development-skills-b62832cf0fa4" target="_blank" rel="external">20多个开源安卓程序大大提升你的开发技巧<br>https://blog.aritraroy.in/20-awesome-open-source-android-apps-to-boost-your-development-skills-b62832cf0fa4</a><a href="https://blog.aritraroy.in/20-awesome-open-source-android-apps-to-boost-your-development-skills-b62832cf0fa4" target="_blank" rel="external"></a></p>
<p><strong>4. 考虑学习更多的语言</strong></p>
<p>我并不是要你去学习西班牙语或者中文，而是学习新的编程语言。随着科技的发展，你需要保持自己的知识更新，而不是把自己固定死在安卓一个方面。</p>
<p>这能够开阔你的视野，并能够显著地提升你的安卓开发技巧。下定决心每年至少学习一门新的编程语言吧。但是，请不要在仅仅一周的尝试后就跳过这门语言而放弃学习。尝试着深入这门语言并弄懂它内部的工作原理。</p>
<p>小贴士：<em>看看<a href="https://medium.freecodecamp.org/what-programming-language-should-i-learn-first-%CA%87d%C4%B1%C9%B9%C9%94s%C9%90%CA%8C%C9%90%C9%BE-%C9%B9%C7%9D%CA%8Dsu%C9%90-19a33b0a467d" target="_blank" rel="external">这篇神奇的文章</a>，来帮助你做一个更好的选择。（剧透 —— 答案是 JavaScript ）</em></p>
<p><strong>5. 是时候学习 Java 设计模式了</strong></p>
<p>在长远看来，我并不能完全阐明这会对你的安卓开发生涯有多大的影响。任何时刻，你被卡在需要解决的某个严重的程序问题的时候，设计模式着实能帮助你构建一个优雅的解决方案。</p>
<p>你也需要保持和其他程序员一致的节奏，因此他们在谈论关于使用<a href="https://www.tutorialspoint.com/design_pattern/factory_pattern.htm" target="_blank" rel="external">工厂模式</a>或者<a href="https://www.tutorialspoint.com/design_pattern/decorator_pattern.htm" target="_blank" rel="external">装饰着模式</a>或者<a href="https://www.tutorialspoint.com/design_pattern/facade_pattern.htm" target="_blank" rel="external">外观模式</a>的时候，你也能够立马懂得他们所指的含义。</p>
<p>给自己定下目标每周学习一个新的设计模式吧。</p>
<p>小贴士：<em>这里有一个<a href="https://github.com/iluwatar/java-design-patterns" target="_blank" rel="external">极好的资源</a>可以作为你的开始。如果你钟情于书籍，那么你肯定会读一读<a href="http://shop.oreilly.com/product/9780596007126.do" target="_blank" rel="external">这个</a>。</em></p>
<p><img src="http://liuqingwen.me/blog/2017/08/14/translation-of-30-bite-sized-pro-tips-to-become-a-better-android-developer/git.png" alt="git"></p>
<p><strong>6. 开始贡献开源库</strong></p>
<p>如果你已经开发出了一些很有用的东西，并在你自己的应用开发中使用到了，那么考虑开源它吧。在这个过程中有许多的东西是需要你学习的，而且这有助于你成长为一名优秀的开发者。</p>
<p>如果你没有可以开源的项目，考虑浏览其它你所感兴趣的开源项目，并尝试修复一些 bug ，改进其文档注释或者写一些测试等。</p>
<p>即使是最小的贡献量，它仍然对项目维护者保持项目的运作有所帮助。</p>
<p>小贴士：<em><a href="https://opensource.guide/" target="_blank" rel="external">这里</a>有一些良好的指导能够让你开始贡献开源项目。</em></p>
<p><strong>7. 让你的 IDE 更好地为你工作</strong></p>
<p>准备花更多的时间来了解你所使用的 IDE —— Android Studio 。它所能做的事情比你想象的更多。许多的酷炫特性和快捷方式隐藏着而不为人知，以至于大部分开发者都不了解甚至从来没有尝试探索使用它们。</p>
<p>养成一个探索开发新的、更佳的方式的习惯，让你的工具更好地为你工作，这样能够有效提升你的工作流程和工作效率。</p>
<p>小贴士：<em><a href="https://stanfy.com/blog/use-android-studio-like-a-pro/" target="_blank" rel="external">这里</a>有一篇很棒的文章能帮助你像专业人士一样掌握 Android Studio 。</em></p>
<p><strong>8. 是时候正确地架构你的应用了</strong></p>
<p>大部分时间里我们都以放置所有代码到一个活动或者碎片里而结束（你也可以因此怪罪我吧），最终让导致他们成了巨神对象而变得很难维护和测试。</p>
<p>让你的应用适配一个好的架构是非常重要的，像 <a href="https://antonioleiva.com/mvp-android/" target="_blank" rel="external">MVP</a> ， <a href="http://mvvm%20android/" target="_blank" rel="external">MVVM</a> ， <a href="https://medium.com/@trikita/writing-a-todo-app-with-redux-on-android-5de31cfbdb4f" target="_blank" rel="external">Redux</a> 框架等等。考虑解耦你的应用程序的业务逻辑，交互界面，以及数据结构到不同的层级里，使得他们能够更容易的被管理和测试。</p>
<p>小贴士：<em>看看<a href="https://github.com/googlesamples/android-architecture" target="_blank" rel="external">这些</a>有用的谷歌蓝图能够让你的安卓应用框架更加容易。</em></p>
<p><strong>9. 学习安卓致简代码指南</strong></p>
<p>你不能忽视了这个。和那些写不出整洁代码的开发者合作会变得很难，至少需要符合安卓开发代码指南。</p>
<p>这根本不是什么高深的技术，而且也不会花费你超过几个小时的时间来学习大部分的 Java 和安卓代码指南基础。这不应该是一次性的学习，而应该是作为开发者的一种习惯上的改变。</p>
<p>小贴士：_<a href="https://github.com/ribot/android-guidelines/blob/master/project_and_code_guidelines.md" target="_blank" rel="external">这里</a>有一篇精彩的资源作为你开始学习标准代码的指南_</p>
<p><strong>10. 花一些时间来学习安卓最佳实践</strong></p>
<p>要使自己比其他开发者更加出众，并能构建出整洁美观而又功能完善的应用，你需要开始学习一些安卓开发最佳实践。</p>
<p>这里有一些该做和不该做的条例，能助你成为一名更优秀的开发者，并能让你的应用从其他应用程序中脱颖而出。</p>
<p>小贴士：<em><a href="https://github.com/futurice/android-best-practices" target="_blank" rel="external">这里</a>有一个最佳实践文章可以让你做出更好的应用</em></p>
<p><strong>11. 通过接听电台来充分地高效地利用你的业余时间</strong></p>
<p>尝试高效合理地利用你的业余时间。这些时间属于你从家到办公室或者离开，在健身房锻炼，开车，烹饪的时间等等。而这个时候你那聪明的大脑却处于无事可做的状态。</p>
<p>你可以充分利用这些时间来听一些安卓广播资源。经常性地保持你的大脑尽可能高效地使用这些有用的信息，并努力做到大部分空闲时间的最大利用化。</p>
<p>小贴士：<em><a href="http://fragmentedpodcast.com/" target="_blank" rel="external">碎片广播</a>和<a href="http://androidbackstage.blogspot.in/" target="_blank" rel="external">安卓开发者后台</a>是两个让你开始行动的超酷资源广播电台。</em></p>
<p><strong>12. 不要过于工程化，现实点。</strong></p>
<p>这不仅仅发生在我自己身上，同时我也在一些和我工作的其他开发者伙伴身上也看到了。在开始进行之前就考虑周全是很不错（是非很好），但是过于考虑和过于分析事情会导致最终一事无成，就如同不必要的迷茫，延误和焦虑。</p>
<p>立刻开始行动做那些项目中正确的部分，这样你总是能够适应在之后需要做出改变的规则。</p>
<p><strong>推荐阅读</strong></p>
<p><a href="https://blog.aritraroy.in/what-my-2-years-of-android-development-have-taught-me-the-hard-way-52b495ba5c51" target="_blank" rel="external">两年的安卓开发教会我的那些困难和经验<br>https://blog.aritraroy.in/what-my-2-years-of-android-development-have-taught-me-the-hard-way-52b495ba5c51</a><a href="https://blog.aritraroy.in/what-my-2-years-of-android-development-have-taught-me-the-hard-way-52b495ba5c51" target="_blank" rel="external"></a></p>
<p><strong>13. 尝试着学习平面设计</strong></p>
<p>我能理解作为一名程序员，你所主要的重心点在于学习编写更好的代码，这是显而易见的。但是如果你要成为一名完完全全的开发者，你应该开始每天花一些时间来学习并理解关于 UI 和 UX 的设计。</p>
<p>这将会颠覆你对待你自己一直正在使用代码编写应用的看法。尝试着和你团队中的 UI 以及 UX 设计师做更多的沟通和交流的机会，你将会更加深入地了解应用设计。</p>
<p>小贴士：<em>读一读<a href="https://www.amazon.com/Design-Everyday-Things-Revised-Expanded/dp/0465050654" target="_blank" rel="external">这本书</a>如果你对理解设计如何工作的原理感兴趣的话</em></p>
<p><strong>14. 开始成为一名完美主义者</strong></p>
<p>这是一个类似：我所谓的“完美主义”并非其他人的“完美主义”的话题。但是作为一个小的建议，始终尝试着帮你所需要发布的版本的产品做到尽可能最好。</p>
<p>不要妥协。不要为了单纯的做事而做事。要对你自己的工作有激情并尝试做得比他人更好。这会让你持续成长并在长远看来会让你成为一名更加成功的开发者。</p>
<p><strong>15. 坚持是成功的关键</strong></p>
<p>如果你想成为一名成功的安卓开发者（或者你生命中其他想要的），那么你需要坚持。</p>
<p>做事情坚持不了几天或者几周就放弃那并不会让你学到什么东西。尝试着描绘一下作为一名安卓开发者在未来几年里你所想要成为的人的模样，坚持并不断挑战自我，最终实现自己的目标。</p>
<p>开始一件事很容易，但是保持同样的激情和奉献精神，长时间坚持下去却很难（非常的难）。</p>
<p><strong>16. 积少成多，逐步深入</strong></p>
<p>作为一名开发者，你应该时常试着把你所遇到的任何复杂的问题或者特性，转化成小型的、简单的和独立的组件，这样做能够很容易地被理解并能快速地解决问题。</p>
<p>不要被一个项目的大小和复杂度所压倒。只要你使用正确的方式，任何问题都能够迎刃而解。从小的部分开始，慢慢积累并逐步扩张。</p>
<p><strong>17. 保持手里有项目的另一个测试版本</strong></p>
<p>经常有一个后台的测试版本项目能够完全改变你学习东西的方式。如果你在安卓开发界遇到什么新的事物，请养成一个立刻就开始新建一个后台测试项目的习惯。</p>
<p>假设你在某个地方发现了一个很有趣的安卓代码库，你应该立刻想到新建一个后台测试项目来使用这个库，而不是仅仅快速地浏览一下它的文档和 API 。这会让你更加熟悉、更加深入地了解这个类库。</p>
<p><strong>18. 开始写一些测试</strong></p>
<p>我没法再强调这个有多重要了。你并不能完全吃透某个特性，除非你用尽心思给它写测试。测试能帮助你的代码构建出一个信心彼岸。</p>
<p>不要犯那种忽略测试或者认为测试只是一个“可选项”的错误了，这会让你的生活更加痛苦并增加许多的问题。记住，一个没有测试的代码很容易立刻变成旧地遗留代码。</p>
<p><strong>推荐阅读</strong></p>
<p><a href="https://blog.aritraroy.in/50-ultimate-resources-to-master-android-development-15165d6bc376" target="_blank" rel="external">50 多个有用的关于掌握安卓开发的资源<br>https://blog.aritraroy.in/50-ultimate-resources-to-master-android-development-15165d6bc376</a><a href="https://blog.aritraroy.in/50-ultimate-resources-to-master-android-development-15165d6bc376" target="_blank" rel="external"></a></p>
<p><strong>19. 考虑适配 TDD</strong></p>
<p>当你在开发一个应用的时候，考虑选择一种机械地而又高效的方式，以便能够顺利地通过测试。</p>
<p>开始遵守 TDD 的“红-绿-重构”周期模式。首先，你所编写的测试可能会失败（红），然后写一些有效的代码让这个测试通过（绿），接着进一步优化并清理整洁这些代码（重构）。</p>
<blockquote>
<p>测试驱动型开发是一种编程期间控制自我焦虑的方式。焦虑感会让你变得很具有试探性。焦虑感让你变得不容易沟通。焦虑感会让你害怕发出反馈。焦虑感让你变得心浮气躁。—— 来自 TDD 的案例</p>
</blockquote>
<p><strong>20. 设立一个合适的自动发布机制</strong></p>
<p>作为一名开发者，尝试着让自己不要操心那些可以自动完成的东西，比如应用程序质量的测试和发布。</p>
<p>你应该使用那些自动检测程序质量的工具，像 <a href="https://plugins.jetbrains.com/plugin/1065-checkstyle-idea" target="_blank" rel="external">CheckStyle</a> ， <a href="https://github.com/pmd/pmd" target="_blank" rel="external">PMD</a> ， <a href="https://developer.android.com/studio/write/lint.html" target="_blank" rel="external">Lint</a> ， <a href="https://plugins.jetbrains.com/plugin/3847-findbugs-idea" target="_blank" rel="external">FindBugs</a> 。在合并主要的改变之前运行所有的单元测试和真机测试是必须要做到的。</p>
<p>当所有这些测试通过后，你就会得到一个允许 APK 发布到 Play 商店或者分发到其他你想要的地方的（比如 <a href="http://try.crashlytics.com/beta/" target="_blank" rel="external">Crashlytics Beta</a> ）的绿色信号。</p>
<p>小贴士：<em>考虑 Play 商店自动发布机制以及使用<a href="https://github.com/Triple-T/gradle-play-publisher" target="_blank" rel="external">这些</a>工具。</em></p>
<p><strong>21. 拥抱 Reactive 编程的到来</strong></p>
<p>如果你作为安卓开发者想要提升自己的技能，你绝对应该考虑拥抱 reactive 的实现。这会迫使你在构建应用的时候采用完全不同的方式思考问题。</p>
<p>采取 reactive 的方式肯定能够有助于你更加快速地写出交互式应用，并且能够让你的开发更加容易且有趣。</p>
<p>小贴士：<em><a href="http://blog.danlew.net/2014/09/15/grokking-rxjava-part-1/" target="_blank" rel="external">这里</a>是一个非常好的学习 RxJava 在安卓应用开发的精彩系列。</em></p>
<p><img src="http://liuqingwen.me/blog/2017/08/14/translation-of-30-bite-sized-pro-tips-to-become-a-better-android-developer/kotlin.png" alt="kotlin.png"></p>
<p><strong>22. 学会使用 Kotlin 进行安卓开发</strong></p>
<p>Kotlin 是目前最受欢迎和热议的语言，自从它来到安卓开发界后。它现在也是开发安卓应用的<a href="https://blog.jetbrains.com/kotlin/2017/05/kotlin-on-android-now-official/" target="_blank" rel="external">官方支持的语言</a>。这个简洁高效的语言给安卓开发界带来了一丝新鲜的空气。</p>
<p>对于那些被古老、繁琐以及易出错的 Java 所困扰的人们来说，这是发生在安卓开发者身上最大的一件幸事之一。尝试着使用它，你将会重新燃起对你的开发生活的热爱。</p>
<p>小贴士：<em>了解更多关于更好的安卓应用开发你需要开始学习并使用 Kotlin 的原因 。</em></p>
<p><a href="https://blog.aritraroy.in/why-you-should-start-using-kotlin-to-supercharge-your-android-development-in-2017-61db1f11d666" target="_blank" rel="external">2017 年为什么你要开始使用 Kotlin 来掌控你的安卓开发<br>https://blog.aritraroy.in/why-you-should-start-using-kotlin-to-supercharge-your-android-development-in-2017-61db1f11d666</a><a href="https://blog.aritraroy.in/why-you-should-start-using-kotlin-to-supercharge-your-android-development-in-2017-61db1f11d666" target="_blank" rel="external"></a></p>
<p><strong>23. 参加聚会并和更多的开发者建立社交关系</strong></p>
<p>我们开发者趋向于内向，喜欢坐在一个角落里，和自己的电脑组成一个自我的世界。</p>
<p>但是请走出你自己的舒适区，和其他开发者发生更多的联系和沟通吧。当你参加开发者会议，社交活动以及和其他有着和你共同兴趣爱好的开发者一起谈论问题的时候，你会学习到很多很多的东西。</p>
<p>小贴士：<em><a href="https://www.meetup.com/" target="_blank" rel="external">这里</a>是一个发现你所感兴趣会谈沙龙的好地方。</em></p>
<p><strong>24. 熟悉使用键盘快捷键</strong></p>
<p>试着养成一个尽可能不使用你的鼠标的习惯。在 Android Studio 上几乎所有的操作都可以由快捷方式完成。</p>
<p>这会显著地减少你的开发时间并提升你的工作流程。记住一些键盘快捷键可能会在初始阶段花上一些时间，但是从长远时间来看，它会有助于你进入一个真正无鼠标的工作流程状态。</p>
<p>小贴士：<em>如果你用古老的方式不能记住快捷键，<a href="https://plugins.jetbrains.com/plugin/1003-key-promoter" target="_blank" rel="external">这里</a>有一个超棒的 AS 插件来帮你搞定。</em></p>
<p><strong>25. 尝试着至少每周学会一个安卓相关的知识</strong></p>
<p>在安卓大千世界里，当你在一开始踏入的时候，有太多需要学习和了解的东西会让你感觉猝不及防。但是如果你给自己下定决心，每周学习一个安卓相关的知识点，那么事情会变得更加容易。</p>
<p>做一个列表记下所有你不会的东西，给他们标上先后顺序和重要性，在接下来每周里开始学习，并一步一步地完成它们。那么在几个月后，你会发现你已经远远不是那个刚开始的自己了。</p>
<p><strong>26. 把所有浪费你时间的事情自动化</strong></p>
<p>我们作为工程师，生来就喜欢偷懒，总是想着找到一种简便的方式来完成一份烦人的工作。</p>
<p>所以，如果你在一天里需要做一些重复且厌烦的事情的时候，尝试着考虑把它自动化吧。这会累计让你每周都节约不少时间，从而可以用来花在做其他高效率以及有用的事情上，并能够减少你的焦虑感。</p>
<p>小贴士：<em>看一下<a href="https://zapier.com/" target="_blank" rel="external">这个</a>神奇的工具，它能帮你连接并自动化你每天所使用的工具之间的沟通。</em></p>
<p><strong>27. 考虑同时运行两个不同版本的 Android Studio</strong></p>
<p>保持使用一个稳定版本的 Android Studio 用来做你每天需要做的那些很重要的事情。但是也同时考虑保持安装使用一个最新候选版本的 Android Studio 。</p>
<p>有时候早期版本中会有很多令人兴奋的新特性，那都是你很乐意去尽可能尝试使用的。</p>
<p><strong>推荐阅读</strong></p>
<p><a href="https://blog.aritraroy.in/30-kickass-tools-to-develop-android-apps-like-a-pro-191e52b9419b" target="_blank" rel="external">30 多个像专业人士一样开发安卓应用的强大工具<br>https://blog.aritraroy.in/30-kickass-tools-to-develop-android-apps-like-a-pro-191e52b9419b</a><a href="https://blog.aritraroy.in/30-kickass-tools-to-develop-android-apps-like-a-pro-191e52b9419b" target="_blank" rel="external"></a></p>
<p><strong>28. 仔细审查所有你一次性添加的第三方类库</strong></p>
<p>在我们需要的时候我们都喜欢使用添加类库，这当然没问题。但是，要养成一个习惯，审查你所一次性添加的所有的第三方类库，并且移除那些你不再需要的库。</p>
<p>如果你仅仅是使用一个类库的一小部分，那么考虑把它分解出来而不是使用整个库。有那么一个可能性的事件是：审查有时候也会帮你更新那些急需更新的旧类库。</p>
<p><strong>29. 学习更好的方法用来重构遗留代码库</strong></p>
<p>不要犯那种一次性重构一个完整的庞大代码库的错误。这样做会把你陷入到没有退路的困境之中。</p>
<p>考虑重构你现在就需要使用的部分代码库，然后慢慢地延伸扩展到你所需要的其他部分。同样，考虑在碰到其他代码之前为你所需要重构而又怀疑会破坏现有功能的那部分写一些测试。</p>
<p>小贴士：<em><a href="http://www.amazon.in/Working-Effectively-Legacy-Robert-Martin/dp/0131177052" target="_blank" rel="external">这本书</a>完全改变了我使用旧代码的方式。你完全值得看一看。</em></p>
<p><strong>30. 经常在低端设备上进行开发和测试</strong></p>
<p>如果你想要像专业人士一样开发应用程序，那么不要犯那种总是在高端设备上开发并测试程序的错误。一般来说，我们开发者手头拥有高端的旗舰产品，并且使用它来做应用的开发和测试用。但是这完全正是你需要克制的地方。</p>
<p>尝试着在市场上买点便宜的、低端的设备，并养成在上面开发应用程序的习惯。你将会看到你的应用的一大堆缺陷，而你之前并不知道它们的存在。</p>
<p><strong>31. 买你所能负担起的最好的设备</strong></p>
<p>不要犯那种购买一个低端的工作用机器来做每天工作的错误，那会有损你的开发经验。</p>
<p>考虑使用一个 Mac （超越 Windows ）来做开发。你会爱上它那简介而又稳定的特性的。</p>
<p>从现在开始，如果你要买一台苹果笔记本，那么考虑买一个最合适你自己的版本。几百块（美元，编者按 <img src="http://liuqingwen.me/blog/images/emoji/joy.png &quot;" alt="joy"> ）的额外开销并不会伤害你，反而你会感谢自己做下了这个决定的。</p>
<hr>
<p>希望这些<strong>小贴士能够帮助你成为一名更好的安卓开发者。</strong>你虽然已经看完并理解了这些条条例例，但是也正是时候把它们转化成实际行动了，只有这样你才能感受到他们的强大之处。</p>
<p>如果你发现这是一篇有用的文章，请考虑推荐它给你的朋友们、室友同学们、竞争对手或者你通过社交媒体认识的任何人。</p>
<p><em>这篇文章最初发布于： <a href="http://techbeacon.com/" target="_blank" rel="external">TechBeacon</a></em></p>
<hr>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Glide缓存知识梳理]]></title>
      <url>/2017/08/23/Glide%E7%BC%93%E5%AD%98%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86/</url>
      <content type="html"><![CDATA[<hr>
<h2 id="style-candy"><a href="#style-candy" class="headerlink" title="style: candy"></a>style: candy</h2><h1 id="Glide缓存知识梳理"><a href="#Glide缓存知识梳理" class="headerlink" title="Glide缓存知识梳理"></a>Glide缓存知识梳理</h1><h3 id="Glide磁盘缓存策略分为四种，默认的是RESULT"><a href="#Glide磁盘缓存策略分为四种，默认的是RESULT" class="headerlink" title="Glide磁盘缓存策略分为四种，默认的是RESULT"></a>Glide磁盘缓存策略分为四种，默认的是RESULT</h3><ul>
<li><p>1.ALL:缓存原图(SOURCE)和处理图(RESULT)</p>
</li>
<li><p>2.NONE:什么都不缓存</p>
</li>
<li><p>3.SOURCE:只缓存原图(SOURCE)</p>
</li>
<li><p>*4.RESULT:只缓存处理图(RESULT) —默认值</p>
</li>
</ul>
<p>tips:这里原图的意思是假设你的ImageView长100，宽100。图片长300，宽200。那么Glide只缓存300<em>200的图片。处理图的意思是Glide只缓存100</em>100的图片。</p>
<h5 id="组合策略"><a href="#组合策略" class="headerlink" title="组合策略"></a>组合策略</h5><p>1.内存不缓存,磁盘缓存缓存所有图片<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Glide.with(this).load(mUrl).skipMemoryCache(true).diskCacheStrategy(DiskCacheStrategy.ALL).into(mIv);</div></pre></td></tr></table></figure></p>
<p>2.内存缓存处理图,磁盘缓存原图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Glide.with(this).load(mUrl).skipMemoryCache(false).diskCacheStrategy(DiskCacheStrategy.SOURCE).into(mIv);</div></pre></td></tr></table></figure>
<h3 id="Glide默认缓存路径"><a href="#Glide默认缓存路径" class="headerlink" title="Glide默认缓存路径"></a>Glide默认缓存路径</h3><pre><code>默认缓存路径为DiskCache中定义的DEFAULT_DISK_CACHE_DIR，这个值为image_manager_disk_cache。如果不自定义缓存路径，那么默认的缓存完整路径为/data/user/0/包名/cache/image_manager_disk_cache这个目录。
</code></pre><h3 id="Glide默认缓存大小"><a href="#Glide默认缓存大小" class="headerlink" title="Glide默认缓存大小"></a>Glide默认缓存大小</h3><pre><code>默认缓存大小为DiskCache中定义的DEFAULT_DISK_CACHE_SIZE，这个值为250 * 1024 * 1024，即250MB。
</code></pre><h3 id="自定义缓存路径和缓存大小"><a href="#自定义缓存路径和缓存大小" class="headerlink" title="自定义缓存路径和缓存大小"></a>自定义缓存路径和缓存大小</h3><ol>
<li>自定义一个实现了<code>GlideModule</code>接口的类，重写<code>applyOptions</code>方法。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class MyGlideModule implements GlideModule &#123;</div><div class="line"></div><div class="line">  // 图片缓存最大容量，150M，根据自己的需求进行修改</div><div class="line">  public static final int GLIDE_CATCH_SIZE = 100 * 1000 * 1000;    </div><div class="line">  //图片缓存子目录</div><div class="line">  public static final String GLIDE_CARCH_DIR = &quot;my_cache_dir&quot;;    @Override</div><div class="line">  public void applyOptions(Context context, GlideBuilder builder) &#123;</div><div class="line">     //自定义缓存目录和大小</div><div class="line">	 builder.setDiskCache(new InternalCacheDiskCacheFactory(context,GLIDE_CARCH_DIR,GLIDE_CATCH_SIZE));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  @Override</div><div class="line">  public void registerComponents(Context context, Glide glide) &#123;</div><div class="line"></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.在<code>AndroidManifest.xml</code>中的<code>&lt;application&gt;</code>标签下定义<code>&lt;meta-data&gt;</code>，这样<code>Glide</code>才能知道我们定义了这么一个类，其中<code>android:name</code>是我们自定义的<code>GlideModule</code>的完整路径，而<code>android:value</code>是固定值<code>GlideModule</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;meta-data</div><div class="line">  android:name=&quot;com.demo.glide.MyGlideModule&quot;</div><div class="line">  android:value=&quot;GlideModule&quot; /&gt;</div></pre></td></tr></table></figure>
<h3 id="Glide清除缓存"><a href="#Glide清除缓存" class="headerlink" title="Glide清除缓存"></a>Glide清除缓存</h3><ol>
<li>Glide提供两个方法清除缓存，其中<code>Glide.get(context).clearMemory();</code>这个方法会清除所有的内存缓存。需要在UI线程操作。<code>Glide.get(context).clearDiskCache();</code>这个方法会清除所有的磁盘缓存，需要在子线程操作。</li>
<li>工具类安利<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div></pre></td><td class="code"><pre><div class="line">public class GlideCacheUtil &#123;</div><div class="line">    private static GlideCacheUtil instance;</div><div class="line"></div><div class="line">    public static GlideCacheUtil getInstance() &#123;</div><div class="line">        if (null == instance) &#123;</div><div class="line">            instance = new GlideCacheUtil();</div><div class="line">        &#125;</div><div class="line">        return instance;</div><div class="line">    &#125;</div><div class="line">    // 获取Glide磁盘缓存大小</div><div class="line">    public String getCacheSize(Context context) &#123;</div><div class="line">        return getCacheSize(context,null);</div><div class="line">    &#125;</div><div class="line">    // 获取Glide磁盘缓存大小</div><div class="line">    public String getCacheSize(Context context,String fileName) &#123;</div><div class="line">        try &#123;</div><div class="line">            File cacheFile = null;</div><div class="line">            if (fileName==null)&#123;</div><div class="line">                cacheFile = new File(context.getCacheDir() + &quot;/&quot; + InternalCacheDiskCacheFactory.DEFAULT_DISK_CACHE_DIR);</div><div class="line">            &#125;else&#123;</div><div class="line">                cacheFile = new File(context.getCacheDir() + &quot;/&quot; + fileName);</div><div class="line">            &#125;</div><div class="line">            return getFormatSize(getFolderSize(cacheFile));</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            return &quot;&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 清除图片磁盘缓存，调用Glide自带方法</div><div class="line">    public boolean clearCacheDiskSelf(final Context context) &#123;</div><div class="line">        try &#123;</div><div class="line">            if (Looper.myLooper() == Looper.getMainLooper()) &#123;</div><div class="line">                new Thread(new Runnable() &#123;</div><div class="line">                    @Override</div><div class="line">                    public void run() &#123;</div><div class="line">                        Glide.get(context).clearDiskCache();</div><div class="line">                    &#125;</div><div class="line">                &#125;).start();</div><div class="line">            &#125; else &#123;</div><div class="line">                Glide.get(context).clearDiskCache();</div><div class="line">            &#125;</div><div class="line">            return true;</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 清除Glide内存缓存</div><div class="line">    public boolean clearCacheMemory(Contenxt context) &#123;</div><div class="line">        try &#123;</div><div class="line">            if (Looper.myLooper() == Looper.getMainLooper()) &#123; //只能在主线程执行</div><div class="line">                Glide.get(context).clearMemory();</div><div class="line">                return true;</div><div class="line">            &#125;</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    // 获取指定文件夹内所有文件大小的和</div><div class="line">    private long getFolderSize(File file) throws Exception &#123;</div><div class="line">        long size = 0;</div><div class="line">        try &#123;</div><div class="line">            File[] fileList = file.listFiles();</div><div class="line">            for (File aFileList : fileList) &#123;</div><div class="line">                if (aFileList.isDirectory()) &#123;</div><div class="line">                    size = size + getFolderSize(aFileList);</div><div class="line">                &#125; else &#123;</div><div class="line">                    size = size + aFileList.length();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return size;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 格式化单位</div><div class="line">    private static String getFormatSize(double size) &#123;</div><div class="line">        double kiloByte = size / 1024;</div><div class="line">        if (kiloByte &lt; 1) &#123;</div><div class="line">            return size + &quot;Byte&quot;;</div><div class="line">        &#125;</div><div class="line">        double megaByte = kiloByte / 1024;</div><div class="line">        if (megaByte &lt; 1) &#123;</div><div class="line">            BigDecimal result1 = new BigDecimal(Double.toString(kiloByte));</div><div class="line">            return result1.setScale(2, BigDecimal.ROUND_HALF_UP).toPlainString() + &quot;KB&quot;;</div><div class="line">        &#125;</div><div class="line">        double gigaByte = megaByte / 1024;</div><div class="line">        if (gigaByte &lt; 1) &#123;</div><div class="line">            BigDecimal result2 = new BigDecimal(Double.toString(megaByte));</div><div class="line">            return result2.setScale(2, BigDecimal.ROUND_HALF_UP).toPlainString() + &quot;MB&quot;;</div><div class="line">        &#125;</div><div class="line">        double teraBytes = gigaByte / 1024;</div><div class="line">        if (teraBytes &lt; 1) &#123;</div><div class="line">            BigDecimal result3 = new BigDecimal(Double.toString(gigaByte));</div><div class="line">            return result3.setScale(2, BigDecimal.ROUND_HALF_UP).toPlainString() + &quot;GB&quot;;</div><div class="line">        &#125;</div><div class="line">        BigDecimal result4 = new BigDecimal(teraBytes);</div><div class="line">        return result4.setScale(2, BigDecimal.ROUND_HALF_UP).toPlainString() + &quot;TB&quot;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 按目录删除文件夹文件方法</div><div class="line">    private boolean deleteFolderFile(String filePath, boolean deleteThisPath) &#123;</div><div class="line">        try &#123;</div><div class="line">            File file = new File(filePath);</div><div class="line">            if (file.isDirectory()) &#123;</div><div class="line">                File files[] = file.listFiles();</div><div class="line">                for (File file1 : files) &#123;</div><div class="line">                    deleteFolderFile(file1.getAbsolutePath(), true);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            if (deleteThisPath) &#123;</div><div class="line">                if (!file.isDirectory()) &#123;</div><div class="line">                    file.delete();</div><div class="line">                &#125; else &#123;</div><div class="line">                    if (file.listFiles().length == 0) &#123;</div><div class="line">                        file.delete();</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            return true;</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
            <category> Glide </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Glide </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Handler源码浅析]]></title>
      <url>/2017/06/28/Android-Handler%E6%BA%90%E7%A0%81%E6%B5%85%E6%9E%90/</url>
      <content type="html"><![CDATA[<h3 id="Android-Handler源码浅析"><a href="#Android-Handler源码浅析" class="headerlink" title="Android Handler源码浅析"></a>Android Handler源码浅析</h3><blockquote>
<p>相关对象</p>
</blockquote>
<ol>
<li>Handler可以看作CEO，负责消息的处理和发送，Handler发送消息给MessageQueue,，然后Looper取出其中的消息给Handler。</li>
<li>Looper,Handler的管家，可以看作秘书，负责管理MessageQueue,她会不断的从MessageQueue中取出消息，交给Handler处理。</li>
<li>MessageQueue是存放消息的队列，负责存放Handler发来的消息。</li>
</ol>
<blockquote>
<p>Looper部分源码讲解</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">public static void prepare() &#123;</div><div class="line">        prepare(true);</div><div class="line">&#125;</div><div class="line"></div><div class="line">private static void prepare(boolean quitAllowed) &#123;</div><div class="line">    if (sThreadLocal.get() != null) &#123;</div><div class="line">        throw new RuntimeException(&quot;Only one Looper may be created per thread&quot;);</div><div class="line">    &#125;</div><div class="line">    sThreadLocal.set(new Looper(quitAllowed));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">static final ThreadLocal&lt;Looper&gt; sThreadLocal = new ThreadLocal&lt;Looper&gt;();</div></pre></td></tr></table></figure>
<p>Looper实例化是在Looper.prepare()方法中。</p>
<blockquote>
<p>小插曲</p>
</blockquote>
<p>ThreadLocal是一个和多线程并发相关的类。当使用ThreadLocal维护变量时，ThreadLocal为每个使用该变量的线程提供独立的变量副本，所以每一个线程都可以独立地改变自己的副本，而不会影响其它线程所对应的副本。</p>
<p>ThreadLocal维护了一个Map集合，其中键为当前线程，值就是不同线程的变量。</p>
<p>ThreadLocal中的方法不多。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public T get() &#123;</div><div class="line">    Thread t = Thread.currentThread();</div><div class="line">    ThreadLocalMap map = getMap(t);</div><div class="line">    if (map != null) &#123;</div><div class="line">        ThreadLocalMap.Entry e = map.getEntry(this);</div><div class="line">        if (e != null)</div><div class="line">            return (T)e.value;</div><div class="line">    &#125;</div><div class="line">    return setInitialValue();</div><div class="line">&#125;</div><div class="line">public void set(T value) &#123;</div><div class="line">    Thread t = Thread.currentThread();</div><div class="line">    ThreadLocalMap map = getMap(t);</div><div class="line">    if (map != null)</div><div class="line">        map.set(this, value);</div><div class="line">    else</div><div class="line">        createMap(t, value);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>set方法很容易理解，首先获取当前线程，再用当前线程当键来获取map集合，如果map为空，则重新创建一个map并设置值进去，否则的话，直接设置值进去。get同理。</p>
<p>回到主题。所以Looper的prepare只能获取当前线程的Looper对象，并且如果已经存在一个Looper对象则会报异常，所以这也说明了一个线程中只能存在一个Lopper对象。并且prepare只能调用一次。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">private Looper(boolean quitAllowed) &#123;</div><div class="line">    mQueue = new MessageQueue(quitAllowed);</div><div class="line">    mThread = Thread.currentThread();</div><div class="line">&#125;</div><div class="line">public static void loop() &#123;</div><div class="line">    final Looper me = myLooper();</div><div class="line">    //此处只展示了关键代码</div><div class="line">    final MessageQueue queue = me.mQueue;</div><div class="line"></div><div class="line">    for (;;) &#123;</div><div class="line">        Message msg = queue.next(); // might block</div><div class="line">        if (msg == null) &#123;</div><div class="line">            // No message indicates that the message queue is quitting.</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        try &#123;</div><div class="line">            msg.target.dispatchMessage(msg);</div><div class="line">        &#125; finally &#123;</div><div class="line">            if (traceTag != 0) &#123;</div><div class="line">                Trace.traceEnd(traceTag);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        msg.recycleUnchecked();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Looper中创建了一个MessageQueue，并且在Looper的loop方法中，开启无限循环去遍历MessageQueue，如果消息不为空，则将消息发送给Handler。这个msg.target其实就是Handler对象。</p>
<p>我们一般都会重写Handler的handleMessage方法，其中缘由也在源码里。<br>我们不管sendEmptyMessage也好，postDelayed也罢，最终都会调用到一个方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">private boolean enqueueMessage(MessageQueue queue, Message msg, long uptimeMillis) &#123;</div><div class="line">    msg.target = this;</div><div class="line">    if (mAsynchronous) &#123;</div><div class="line">        msg.setAsynchronous(true);</div><div class="line">    &#125;</div><div class="line">    return queue.enqueueMessage(msg, uptimeMillis);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>msg.target = this。这句话中的this就是Handler对象。<br>同时把消息放入MessageQueue中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public void dispatchMessage(Message msg) &#123;</div><div class="line">    if (msg.callback != null) &#123;</div><div class="line">        handleCallback(msg);</div><div class="line">    &#125; else &#123;</div><div class="line">        if (mCallback != null) &#123;</div><div class="line">            if (mCallback.handleMessage(msg)) &#123;</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        handleMessage(msg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在Looper的loop方法中，她把消息用dispatchMessage传了过来。在dispatchMessage中。优先级有三种。优先级最高的是message自己的callback，然后是Handler的callback，当两者都没有的时候，就由我们重写来处理。这也是我们最常用的一种方法。</p>
<blockquote>
<p>那么Looper是什么时候启动的呢?</p>
</blockquote>
<p>答案在ActivityThread中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) &#123;</div><div class="line">    //部分代码</div><div class="line">    Looper.prepareMainLooper();</div><div class="line"></div><div class="line">    ActivityThread thread = new ActivityThread();</div><div class="line">    thread.attach(false);</div><div class="line"></div><div class="line">    if (sMainThreadHandler == null) &#123;</div><div class="line">        sMainThreadHandler = thread.getHandler();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (false) &#123;</div><div class="line">        Looper.myLooper().setMessageLogging(new</div><div class="line">                LogPrinter(Log.DEBUG, &quot;ActivityThread&quot;));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // End of event ActivityThreadMain.</div><div class="line">    Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class="line">    Looper.loop();</div><div class="line"></div><div class="line">    throw new RuntimeException(&quot;Main thread loop unexpectedly exited&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中Looper.prepareMainLooper()和Looper.prepare()等价。这个ActivityThread也就是我们所说的UI线程，Looper在UI线程启动的时候，就一直在后台默默工作了。</p>
<blockquote>
<p>思考，Handler怎么做到线程切换处理对象的。</p>
</blockquote>
<p>因为不同线程共享内存，Handler在A线程发送了一个消息，然后主线程的Looper在主线程把消息取了出来，同时交给了Handler，所以Handler一取一存就做到了线程切换。</p>
<blockquote>
<p>小结</p>
</blockquote>
<p>其实看源码本没有那么复杂，有时候根本不需要抽丝剥茧一条条代码看，代码量很多，难度确实是有的。但是我们只要有一个目标，有一条主线，只寻找最关键的代码，就能很快的理清它的脉络。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android 日常bug集锦]]></title>
      <url>/2017/05/19/Android-%E6%97%A5%E5%B8%B8bug%E9%9B%86%E9%94%A6/</url>
      <content type="html"><![CDATA[<ol>
<li>今天开发的时候遇到了一个bug，一直报xml inflate异常，我检查了好多遍就是没问题，后来才发现是资源文件格式的问题，好神奇的bug。就是图片格式后面带V21的，查阅资料才知道，v21只能在api21以上使用，否则会报xml布局错误，我的解决方法是把图片再copy 覆盖一下，就会自动生成不是v21的图片，bug完美解决。</li>
<li>ScrollView中放ViewPager时,有时候不显示，原因是这个时候的测量模式是UNSPECIFIED<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;  </div><div class="line">// For simple implementation, our internal size is always 0.  </div><div class="line">// We depend on the container to specify the layout size of  </div><div class="line">// our view.  We can&apos;t really know what it is since we will be  </div><div class="line">// adding and removing different arbitrary views and do not  </div><div class="line">// want the layout to change as this happens.  </div><div class="line">setMeasuredDimension(getDefaultSize(0, widthMeasureSpec),  </div><div class="line">getDefaultSize(0, heightMeasureSpec));  </div><div class="line">&#125;  </div><div class="line">public static int getDefaultSize(int size, int measureSpec) &#123;  </div><div class="line">int result = size;  </div><div class="line">int specMode = MeasureSpec.getMode(measureSpec);  </div><div class="line">int specSize = MeasureSpec.getSize(measureSpec);  </div><div class="line"></div><div class="line">switch (specMode) &#123;  </div><div class="line">case MeasureSpec.UNSPECIFIED:  </div><div class="line">result = size;  </div><div class="line">break;  </div><div class="line">case MeasureSpec.AT_MOST:  </div><div class="line">case MeasureSpec.EXACTLY:  </div><div class="line">result = specSize;  </div><div class="line">break;  </div><div class="line">&#125;  </div><div class="line">return result;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>而UNSPECIFIED这个时候返回的大小是0，所以不显示<br>3.有时候程序出现”cannot be resolved or is not a field”这个错误，有可能是复制项目的时候，把R文件复制过来了，删除错误的R文件，重新Build,搞定！<br>4.ToolBar的setTitle无效，把它放在setSupportActionBar之前就ok,但是setNavigationOnClickListener要放在setSupportActionBar之年才会调用。<br>5.More than one file was found with OS independent path ‘META-INF/ASL2.0’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">packagingOptions &#123;</div><div class="line">        exclude &apos;META-INF/DEPENDENCIES&apos;</div><div class="line">        exclude &apos;META-INF/NOTICE&apos;</div><div class="line">        exclude &apos;META-INF/LICENSE&apos;</div><div class="line">        exclude &apos;META-INF/LICENSE.txt&apos;</div><div class="line">        exclude &apos;META-INF/NOTICE.txt&apos;</div><div class="line">        exclude &apos;META-INF/ASL2.0&apos;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>ArrayList继承自AbstractList,前者实现了Serializable接口，后者未实现，所以慎用ArrayList的subList方法，它返回的是一个AbstractList。</li>
</ol>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> bug </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kotlin资源合集(转)]]></title>
      <url>/2017/05/19/Kotlin%E8%B5%84%E6%BA%90%E5%90%88%E9%9B%86-%E8%BD%AC/</url>
      <content type="html"><![CDATA[<h4 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h4><ol>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=e6d199cf7d&amp;e=983f3566e1" target="_blank" rel="external">Kotlin Primer</a></p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=0481cba3f1&amp;e=983f3566e1" target="_blank" rel="external">Kotlin在Android中的应用</a></p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage1.com/track/click?u=3f24a71686f577759d1824501&amp;id=198c512bb7&amp;e=983f3566e1" target="_blank" rel="external">Kotlin实践</a></p>
</li>
</ol>
<h4 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h4><ol>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=b8f8b15288&amp;e=983f3566e1" target="_blank" rel="external">官方文档</a></p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=90fe84cfe7&amp;e=983f3566e1" target="_blank" rel="external">kotlin-reference-chinese</a></p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=8eda093fa9&amp;e=983f3566e1" target="_blank" rel="external">kotlin-in-chinese</a></p>
</li>
</ol>
<h4 id="开源库"><a href="#开源库" class="headerlink" title="开源库"></a>开源库</h4><ol>
<li><p><a href="http://androidweekly.us9.list-manage2.com/track/click?u=3f24a71686f577759d1824501&amp;id=62eb03dcdc&amp;e=983f3566e1" target="_blank" rel="external">kotlin-koans</a><br>Kotlin Koans are a series of exercises to get you familiar with the Kotlin Syntax.</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage2.com/track/click?u=3f24a71686f577759d1824501&amp;id=a37dbfffbe&amp;e=983f3566e1" target="_blank" rel="external">kotlin-native</a><br>Kotlin/Native is a LLVM backend for the Kotlin compiler, runtime implementation and native code generation facility using LLVM toolchain.</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=5570f45de2&amp;e=983f3566e1" target="_blank" rel="external">ktor</a><br>Web backend framework for Kotlin</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=50effb2d9e&amp;e=983f3566e1" target="_blank" rel="external">kotlinpoet</a><br>A Kotlin API for generating .kt source files.</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage2.com/track/click?u=3f24a71686f577759d1824501&amp;id=c9ad0f87c1&amp;e=983f3566e1" target="_blank" rel="external">Lattekit</a><br>一个灵感来自 React.js， 可以让你在 Kotlin 项目种快速创建 UI 的框架</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=2939e0463b&amp;e=983f3566e1" target="_blank" rel="external">mockito-kotlin</a><br>Using Mockito with Kotlin</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=763edd8648&amp;e=983f3566e1" target="_blank" rel="external">Frodo</a><br>Android Library for Logging RxJava Observables and Subscribers.</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=cf5813b964&amp;e=983f3566e1" target="_blank" rel="external">sentry-beaconfire</a><br>Kotlin based sentry android application</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage2.com/track/click?u=3f24a71686f577759d1824501&amp;id=d630e82735&amp;e=983f3566e1" target="_blank" rel="external">anko</a><br>Anko is a Kotlin library which makes Android application development faster and easier.</p>
</li>
</ol>
<h4 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h4><ol>
<li><p><a href="http://androidweekly.us9.list-manage1.com/track/click?u=3f24a71686f577759d1824501&amp;id=a0a0bdd31a&amp;e=983f3566e1" target="_blank" rel="external">Kotlin从入门到『放弃』系列 视频教程</a></p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=d4db40774a&amp;e=983f3566e1" target="_blank" rel="external">Android Development with Kotlin</a>(需要梯子)</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=cc211d5380&amp;e=983f3566e1" target="_blank" rel="external">Functional Programming with Kotlin</a>(需要梯子)</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=b53c3e3753&amp;e=983f3566e1" target="_blank" rel="external">Advancing Android Development with the Kotlin Language</a>(需要梯子)</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=41a74be847&amp;e=983f3566e1" target="_blank" rel="external">Flexible Types in Kotlin</a>(需要梯子)</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage1.com/track/click?u=3f24a71686f577759d1824501&amp;id=9c43128dd1&amp;e=983f3566e1" target="_blank" rel="external">Kotlin on Android</a>(需要梯子)</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage1.com/track/click?u=3f24a71686f577759d1824501&amp;id=d960d528ae&amp;e=983f3566e1" target="_blank" rel="external">I built an app in Kotlin, and my client still paid me</a></p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage2.com/track/click?u=3f24a71686f577759d1824501&amp;id=7208d7e398&amp;e=983f3566e1" target="_blank" rel="external">Kotlin: the swift of Android</a>(需要梯子)</p>
</li>
<li><p><a href="http://androidweekly.us9.list-manage.com/track/click?u=3f24a71686f577759d1824501&amp;id=dc35f67a45&amp;e=983f3566e1" target="_blank" rel="external">Type-Safe Web with Kotlin</a>(需要梯子)</p>
</li>
</ol>
<h4 id="资源合集"><a href="#资源合集" class="headerlink" title="资源合集"></a>资源合集</h4><ol>
<li><a href="http://androidweekly.us9.list-manage1.com/track/click?u=3f24a71686f577759d1824501&amp;id=d9ed44853b&amp;e=983f3566e1" target="_blank" rel="external">awesome-kotlin</a></li>
</ol>
<p>###本文转载自<a href="http://us9.campaign-archive2.com/?e=983f3566e1&amp;u=3f24a71686f577759d1824501&amp;id=c131fc5a5d" target="_blank" rel="external">Android开发技术周报特刊之Kotlin Issue#0</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
            <category> Kotlin </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Kotlin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Studio 配置Kotlin详解]]></title>
      <url>/2017/05/19/Android-Studio-%E9%85%8D%E7%BD%AEKotlin%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<h4 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h4><p>安装这个kotlin插件<br><img src="http://upload-images.jianshu.io/upload_images/2839845-9771b5cd4ac62a04.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<blockquote>
<ol>
<li>project的build.gradle配置</li>
</ol>
</blockquote>
<ol>
<li><p>buildscript新增<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2. dependencies新增```classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;</div></pre></td></tr></table></figure></p>
</li>
<li><p>allprojects新增<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&gt; 2. module的build.gradle配置</div><div class="line"></div><div class="line">1. 新增插件支持</div></pre></td></tr></table></figure></p>
</li>
</ol>
<p>apply plugin: ‘kotlin-android’<br>apply plugin: ‘kotlin-android-extensions’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2. android新增</div></pre></td></tr></table></figure></p>
<p> sourceSets {<br>        main.java.srcDirs += ‘src/main/kotlin’<br>    }<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">3. dependencies新增</div></pre></td></tr></table></figure></p>
<p>compile “org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#### 总配置</div></pre></td></tr></table></figure></p>
<p>// Top-level build file where you can add configuration options common to all sub-projects/modules.</p>
<p>buildscript {<br>    ext.kotlin_version = ‘1.1.2-4’<br>    repositories {<br>        jcenter()<br>    }<br>    dependencies {<br>        classpath ‘com.android.tools.build:gradle:2.3.1’<br>        classpath “org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version”<br>        // NOTE: Do not place your application dependencies here; they belong<br>        // in the individual module build.gradle files<br>    }<br>}</p>
<p>allprojects {<br>    repositories {<br>        jcenter()<br>        mavenCentral()<br>    }<br>}</p>
<p>task clean(type: Delete) {<br>    delete rootProject.buildDir<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">```</div><div class="line">apply plugin: &apos;com.android.application&apos;</div><div class="line">apply plugin: &apos;kotlin-android&apos;</div><div class="line">apply plugin: &apos;kotlin-android-extensions&apos;</div><div class="line">android &#123;</div><div class="line">    compileSdkVersion 25</div><div class="line">    buildToolsVersion &quot;25.0.2&quot;</div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId &quot;com.happy.kotlindemo&quot;</div><div class="line">        minSdkVersion 15</div><div class="line">        targetSdkVersion 25</div><div class="line">        versionCode 1</div><div class="line">        versionName &quot;1.0&quot;</div><div class="line">        testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled false</div><div class="line">            proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    sourceSets &#123;</div><div class="line">        main.java.srcDirs += &apos;src/main/kotlin&apos;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">dependencies &#123;</div><div class="line">    compile fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;])</div><div class="line">    androidTestCompile(&apos;com.android.support.test.espresso:espresso-core:2.2.2&apos;, &#123;</div><div class="line">        exclude group: &apos;com.android.support&apos;, module: &apos;support-annotations&apos;</div><div class="line">    &#125;)</div><div class="line">    compile &apos;com.android.support:appcompat-v7:25.3.1&apos;</div><div class="line">    compile &apos;com.android.support.constraint:constraint-layout:1.0.2&apos;</div><div class="line">    testCompile &apos;junit:junit:4.12&apos;</div><div class="line">    compile &quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>所有都配置好了之后，选择一个Activity文件，选择code-&gt;convet java file…</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2839845-5306da57a72951f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p>大功告成</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2839845-c311aa4e14725b1b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
            <category> Kotlin </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Kotlin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android KeyCode列表]]></title>
      <url>/2017/05/13/Android-KeyCode%E5%88%97%E8%A1%A8/</url>
      <content type="html"><![CDATA[<h2 id="KEYCODE列表"><a href="#KEYCODE列表" class="headerlink" title="KEYCODE列表"></a>KEYCODE列表</h2><h4 id="电话键"><a href="#电话键" class="headerlink" title="电话键"></a>电话键</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">Name</th>
<th style="text-align:right">Num</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_CALL</td>
<td style="text-align:center">拨号键</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td>KEYCODE_ENDCALL</td>
<td style="text-align:center">挂机键</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td>KEYCODE_HOME</td>
<td style="text-align:center">按键Home</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td>KEYCODE_MENU</td>
<td style="text-align:center">菜单键</td>
<td style="text-align:right">82</td>
</tr>
<tr>
<td>KEYCODE_BACK</td>
<td style="text-align:center">返回键</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td>KEYCODE_SEARCH</td>
<td style="text-align:center">搜索键</td>
<td style="text-align:right">84</td>
</tr>
<tr>
<td>KEYCODE_CAMERA</td>
<td style="text-align:center">拍照键</td>
<td style="text-align:right">27</td>
</tr>
<tr>
<td>KEYCODE_FOCUS</td>
<td style="text-align:center">拍照对焦键</td>
<td style="text-align:right">80</td>
</tr>
<tr>
<td>KEYCODE_POWER</td>
<td style="text-align:center">电源键</td>
<td style="text-align:right">26</td>
</tr>
<tr>
<td>KEYCODE_NOTIFICATION</td>
<td style="text-align:center">通知键</td>
<td style="text-align:right">83</td>
</tr>
<tr>
<td>KEYCODE_MUTE</td>
<td style="text-align:center">话筒静音键</td>
<td style="text-align:right">91</td>
</tr>
<tr>
<td>KEYCODE_VOLUME_MUTE</td>
<td style="text-align:center">扬声器静音键</td>
<td style="text-align:right">164</td>
</tr>
<tr>
<td>KEYCODE_VOLUME_UP</td>
<td style="text-align:center">音量增加键</td>
<td style="text-align:right">24</td>
</tr>
<tr>
<td>KEYCODE_VOLUME_DOWN</td>
<td style="text-align:center">音量减小键</td>
<td style="text-align:right">25</td>
</tr>
</tbody>
</table>
<h4 id="控制键"><a href="#控制键" class="headerlink" title="控制键"></a>控制键</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">键位名称</th>
<th style="text-align:right">Num</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_ENTER</td>
<td style="text-align:center">回车键</td>
<td style="text-align:right">66</td>
</tr>
<tr>
<td>KEYCODE_ESCAPE</td>
<td style="text-align:center">ESC键</td>
<td style="text-align:right">111</td>
</tr>
<tr>
<td>KEYCODE_DPAD_CENTER</td>
<td style="text-align:center">导航键 确定键</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td>KEYCODE_DPAD_UP</td>
<td style="text-align:center">导航键 向上</td>
<td style="text-align:right">19</td>
</tr>
<tr>
<td>KEYCODE_DPAD_DOWN</td>
<td style="text-align:center">导航键 向下</td>
<td style="text-align:right">20</td>
</tr>
<tr>
<td>KEYCODE_DPAD_LEFT</td>
<td style="text-align:center">导航键 向左</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td>KEYCODE_DPAD_RIGHT</td>
<td style="text-align:center">导航键 向右</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td>KEYCODE_MOVE_HOME</td>
<td style="text-align:center">光标移动到开始键</td>
<td style="text-align:right">122</td>
</tr>
<tr>
<td>KEYCODE_MOVE_END</td>
<td style="text-align:center">光标移动到末尾键</td>
<td style="text-align:right">123</td>
</tr>
<tr>
<td>KEYCODE_PAGE_UP</td>
<td style="text-align:center">向上翻页键</td>
<td style="text-align:right">92</td>
</tr>
<tr>
<td>KEYCODE_PAGE_DOWN</td>
<td style="text-align:center">向下翻页键</td>
<td style="text-align:right">93</td>
</tr>
<tr>
<td>KEYCODE_DEL</td>
<td style="text-align:center">退格键</td>
<td style="text-align:right">67</td>
</tr>
<tr>
<td>KEYCODE_FORWARD_DEL</td>
<td style="text-align:center">删除键</td>
<td style="text-align:right">112</td>
</tr>
<tr>
<td>KEYCODE_INSERT</td>
<td style="text-align:center">插入键</td>
<td style="text-align:right">124</td>
</tr>
<tr>
<td>KEYCODE_TAB</td>
<td style="text-align:center">Tab键</td>
<td style="text-align:right">61</td>
</tr>
<tr>
<td>KEYCODE_NUM_LOCK</td>
<td style="text-align:center">小键盘锁</td>
<td style="text-align:right">143</td>
</tr>
<tr>
<td>KEYCODE_CAPS_LOCK</td>
<td style="text-align:center">大写锁定键</td>
<td style="text-align:right">115</td>
</tr>
<tr>
<td>KEYCODE_BREAK</td>
<td style="text-align:center">Break/Pause键</td>
<td style="text-align:right">121</td>
</tr>
<tr>
<td>KEYCODE_SCROLL_LOCK</td>
<td style="text-align:center">滚动锁定键</td>
<td style="text-align:right">116</td>
</tr>
<tr>
<td>KEYCODE_ZOOM_IN</td>
<td style="text-align:center">放大键</td>
<td style="text-align:right">168</td>
</tr>
<tr>
<td>KEYCODE_ZOOM_OUT</td>
<td style="text-align:center">缩小键</td>
<td style="text-align:right">169</td>
</tr>
</tbody>
</table>
<h4 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">键位名称</th>
<th style="text-align:right">Num</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_0</td>
<td style="text-align:center">按键’0’</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td>KEYCODE_1</td>
<td style="text-align:center">按键’1’</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td>KEYCODE_2</td>
<td style="text-align:center">按键’2’</td>
<td style="text-align:right">9</td>
</tr>
<tr>
<td>KEYCODE_3</td>
<td style="text-align:center">按键’3’</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td>KEYCODE_4</td>
<td style="text-align:center">按键’4’</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td>KEYCODE_5</td>
<td style="text-align:center">按键’5’</td>
<td style="text-align:right">12</td>
</tr>
<tr>
<td>KEYCODE_6</td>
<td style="text-align:center">按键’6’</td>
<td style="text-align:right">13</td>
</tr>
<tr>
<td>KEYCODE_7</td>
<td style="text-align:center">按键’7’</td>
<td style="text-align:right">14</td>
</tr>
<tr>
<td>KEYCODE_8</td>
<td style="text-align:center">按键’8’</td>
<td style="text-align:right">15</td>
</tr>
<tr>
<td>KEYCODE_9</td>
<td style="text-align:center">按键’9’</td>
<td style="text-align:right">16</td>
</tr>
<tr>
<td>KEYCODE_A</td>
<td style="text-align:center">按键’A’</td>
<td style="text-align:right">29</td>
</tr>
<tr>
<td>KEYCODE_B</td>
<td style="text-align:center">按键’B’</td>
<td style="text-align:right">30</td>
</tr>
<tr>
<td>KEYCODE_C</td>
<td style="text-align:center">按键’C’</td>
<td style="text-align:right">31</td>
</tr>
<tr>
<td>KEYCODE_D</td>
<td style="text-align:center">按键’D’</td>
<td style="text-align:right">32</td>
</tr>
<tr>
<td>KEYCODE_E</td>
<td style="text-align:center">按键’E’</td>
<td style="text-align:right">33</td>
</tr>
<tr>
<td>KEYCODE_F</td>
<td style="text-align:center">按键’F’</td>
<td style="text-align:right">34</td>
</tr>
<tr>
<td>KEYCODE_G</td>
<td style="text-align:center">按键’G’</td>
<td style="text-align:right">35</td>
</tr>
<tr>
<td>KEYCODE_H</td>
<td style="text-align:center">按键’H’</td>
<td style="text-align:right">36</td>
</tr>
<tr>
<td>KEYCODE_I</td>
<td style="text-align:center">按键’I’</td>
<td style="text-align:right">37</td>
</tr>
<tr>
<td>KEYCODE_J</td>
<td style="text-align:center">按键’J’</td>
<td style="text-align:right">38</td>
</tr>
<tr>
<td>KEYCODE_K</td>
<td style="text-align:center">按键’K’</td>
<td style="text-align:right">39</td>
</tr>
<tr>
<td>KEYCODE_L</td>
<td style="text-align:center">按键’L’</td>
<td style="text-align:right">40</td>
</tr>
<tr>
<td>KEYCODE_M</td>
<td style="text-align:center">按键’M’</td>
<td style="text-align:right">41</td>
</tr>
<tr>
<td>KEYCODE_N</td>
<td style="text-align:center">按键’N’</td>
<td style="text-align:right">42</td>
</tr>
<tr>
<td>KEYCODE_O</td>
<td style="text-align:center">按键’O’</td>
<td style="text-align:right">43</td>
</tr>
<tr>
<td>KEYCODE_P</td>
<td style="text-align:center">按键’P’</td>
<td style="text-align:right">44</td>
</tr>
<tr>
<td>KEYCODE_Q</td>
<td style="text-align:center">按键’Q’</td>
<td style="text-align:right">45</td>
</tr>
<tr>
<td>KEYCODE_R</td>
<td style="text-align:center">按键’R’</td>
<td style="text-align:right">46</td>
</tr>
<tr>
<td>KEYCODE_S</td>
<td style="text-align:center">按键’S’</td>
<td style="text-align:right">47</td>
</tr>
<tr>
<td>KEYCODE_T</td>
<td style="text-align:center">按键’T’</td>
<td style="text-align:right">48</td>
</tr>
<tr>
<td>KEYCODE_U</td>
<td style="text-align:center">按键’U’</td>
<td style="text-align:right">49</td>
</tr>
<tr>
<td>KEYCODE_V</td>
<td style="text-align:center">按键’V’</td>
<td style="text-align:right">50</td>
</tr>
<tr>
<td>KEYCODE_W</td>
<td style="text-align:center">按键’W’</td>
<td style="text-align:right">51</td>
</tr>
<tr>
<td>KEYCODE_X</td>
<td style="text-align:center">按键’X’</td>
<td style="text-align:right">52</td>
</tr>
<tr>
<td>KEYCODE_Y</td>
<td style="text-align:center">按键’Y’</td>
<td style="text-align:right">53</td>
</tr>
<tr>
<td>KEYCODE_Z</td>
<td style="text-align:center">按键’Z’</td>
<td style="text-align:right">54</td>
</tr>
</tbody>
</table>
<h4 id="符号"><a href="#符号" class="headerlink" title="符号"></a>符号</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">键位名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_PLUS</td>
<td style="text-align:center">按键’+’</td>
</tr>
<tr>
<td>KEYCODE_MINUS</td>
<td style="text-align:center">按键’-‘</td>
</tr>
<tr>
<td>KEYCODE_STAR</td>
<td style="text-align:center">按键’*’</td>
</tr>
<tr>
<td>KEYCODE_SLASH</td>
<td style="text-align:center">按键’/‘</td>
</tr>
<tr>
<td>KEYCODE_EQUALS</td>
<td style="text-align:center">按键’=’</td>
</tr>
<tr>
<td>KEYCODE_AT</td>
<td style="text-align:center">按键’@’</td>
</tr>
<tr>
<td>KEYCODE_POUND</td>
<td style="text-align:center">按键’#’</td>
</tr>
<tr>
<td>KEYCODE_APOSTROPHE</td>
<td style="text-align:center">按键’’’ (单引号)</td>
</tr>
<tr>
<td>KEYCODE_BACKSLASH</td>
<td style="text-align:center">按键’\’</td>
</tr>
<tr>
<td>KEYCODE_COMMA</td>
<td style="text-align:center">按键’,’</td>
</tr>
<tr>
<td>KEYCODE_PERIOD</td>
<td style="text-align:center">按键’.’</td>
</tr>
<tr>
<td>KEYCODE_LEFT_BRACKET</td>
<td style="text-align:center">按键’[‘</td>
</tr>
<tr>
<td>KEYCODE_RIGHT_BRACKET</td>
<td style="text-align:center">按键’]’</td>
</tr>
<tr>
<td>KEYCODE_SEMICOLON</td>
<td style="text-align:center">按键’;’</td>
</tr>
<tr>
<td>KEYCODE_GRAVE</td>
<td style="text-align:center">按键’`’</td>
</tr>
<tr>
<td>KEYCODE_SPACE</td>
<td style="text-align:center">空格键</td>
</tr>
</tbody>
</table>
<h4 id="小键盘"><a href="#小键盘" class="headerlink" title="小键盘"></a>小键盘</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">键位名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_NUMPAD_0</td>
<td style="text-align:center">小键盘按键’0’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_1</td>
<td style="text-align:center">小键盘按键’1’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_2</td>
<td style="text-align:center">小键盘按键’2’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_3</td>
<td style="text-align:center">小键盘按键’3’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_4</td>
<td style="text-align:center">小键盘按键’4’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_5</td>
<td style="text-align:center">小键盘按键’5’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_6</td>
<td style="text-align:center">小键盘按键’6’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_7</td>
<td style="text-align:center">小键盘按键’7’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_8</td>
<td style="text-align:center">小键盘按键’8’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_9</td>
<td style="text-align:center">小键盘按键’9’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_ADD</td>
<td style="text-align:center">小键盘按键’+’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_SUBTRACT</td>
<td style="text-align:center">小键盘按键’-‘</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_MULTIPLY</td>
<td style="text-align:center">小键盘按键’*’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_DIVIDE</td>
<td style="text-align:center">小键盘按键’/‘</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_EQUALS</td>
<td style="text-align:center">小键盘按键’=’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_COMMA</td>
<td style="text-align:center">小键盘按键’,’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_DOT</td>
<td style="text-align:center">小键盘按键’.’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_LEFT_PAREN</td>
<td style="text-align:center">小键盘按键’(‘</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_RIGHT_PAREN</td>
<td style="text-align:center">小键盘按键’)’</td>
</tr>
<tr>
<td>KEYCODE_NUMPAD_ENTER</td>
<td style="text-align:center">小键盘按键回车</td>
</tr>
</tbody>
</table>
<h4 id="功能键"><a href="#功能键" class="headerlink" title="功能键"></a>功能键</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">键位名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_F1</td>
<td style="text-align:center">按键F1</td>
</tr>
<tr>
<td>KEYCODE_F2</td>
<td style="text-align:center">按键F2</td>
</tr>
<tr>
<td>KEYCODE_F3</td>
<td style="text-align:center">按键F3</td>
</tr>
<tr>
<td>KEYCODE_F4</td>
<td style="text-align:center">按键F4</td>
</tr>
<tr>
<td>KEYCODE_F5</td>
<td style="text-align:center">按键F5</td>
</tr>
<tr>
<td>KEYCODE_F6</td>
<td style="text-align:center">按键F6</td>
</tr>
<tr>
<td>KEYCODE_F7</td>
<td style="text-align:center">按键F7</td>
</tr>
<tr>
<td>KEYCODE_F8</td>
<td style="text-align:center">按键F8</td>
</tr>
<tr>
<td>KEYCODE_F9</td>
<td style="text-align:center">按键F9</td>
</tr>
<tr>
<td>KEYCODE_F10</td>
<td style="text-align:center">按键F10</td>
</tr>
<tr>
<td>KEYCODE_F11</td>
<td style="text-align:center">按键F11</td>
</tr>
<tr>
<td>KEYCODE_F12</td>
<td style="text-align:center">按键F12</td>
</tr>
</tbody>
</table>
<h4 id="多媒体键"><a href="#多媒体键" class="headerlink" title="多媒体键"></a>多媒体键</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">键位名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_MEDIA_PLAY</td>
<td style="text-align:center">多媒体键 播放</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_STOP</td>
<td style="text-align:center">多媒体键 停止</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_PAUSE</td>
<td style="text-align:center">多媒体键 暂停</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_PLAY_PAUSE</td>
<td style="text-align:center">多媒体键 播放/暂停</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_FAST_FORWARD</td>
<td style="text-align:center">多媒体键 快进</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_REWIND</td>
<td style="text-align:center">多媒体键 快退</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_NEXT</td>
<td style="text-align:center">多媒体键 下一首</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_PREVIOUS</td>
<td style="text-align:center">多媒体键 上一首</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_CLOSE</td>
<td style="text-align:center">多媒体键 关闭</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_EJECT</td>
<td style="text-align:center">多媒体键 弹出</td>
</tr>
<tr>
<td>KEYCODE_MEDIA_RECORD</td>
<td style="text-align:center">多媒体键 录音</td>
</tr>
</tbody>
</table>
<h4 id="手柄按键"><a href="#手柄按键" class="headerlink" title="手柄按键"></a>手柄按键</h4><table>
<thead>
<tr>
<th>KeyCode</th>
<th style="text-align:center">键位名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYCODE_BUTTON_1</td>
<td style="text-align:center">通用游戏手柄按钮#1</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_2</td>
<td style="text-align:center">通用游戏手柄按钮 #2</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_3</td>
<td style="text-align:center">通用游戏手柄按钮 #3</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_4</td>
<td style="text-align:center">通用游戏手柄按钮 #4</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_5</td>
<td style="text-align:center">通用游戏手柄按钮 #5</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_6</td>
<td style="text-align:center">通用游戏手柄按钮 #6</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_7</td>
<td style="text-align:center">通用游戏手柄按钮 #7</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_8</td>
<td style="text-align:center">通用游戏手柄按钮 #8</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_9</td>
<td style="text-align:center">通用游戏手柄按钮 #9</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_10</td>
<td style="text-align:center">通用游戏手柄按钮 #10</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_11</td>
<td style="text-align:center">通用游戏手柄按钮 #11</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_12</td>
<td style="text-align:center">通用游戏手柄按钮 #12</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_13</td>
<td style="text-align:center">通用游戏手柄按钮 #13</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_14</td>
<td style="text-align:center">通用游戏手柄按钮 #14</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_15</td>
<td style="text-align:center">通用游戏手柄按钮 #15</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_16</td>
<td style="text-align:center">通用游戏手柄按钮 #16</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_A</td>
<td style="text-align:center">游戏手柄按钮 A</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_B</td>
<td style="text-align:center">游戏手柄按钮 B</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_C</td>
<td style="text-align:center">游戏手柄按钮 C</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_X</td>
<td style="text-align:center">游戏手柄按钮 X</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_Y</td>
<td style="text-align:center">游戏手柄按钮 Y</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_Z</td>
<td style="text-align:center">游戏手柄按钮 Z</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_L1</td>
<td style="text-align:center">游戏手柄按钮 L1</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_L2</td>
<td style="text-align:center">游戏手柄按钮 L2</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_R1</td>
<td style="text-align:center">游戏手柄按钮 R1</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_R2</td>
<td style="text-align:center">游戏手柄按钮 R2</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_MODE</td>
<td style="text-align:center">游戏手柄按钮 Mode</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_SELECT</td>
<td style="text-align:center">游戏手柄按钮 Select</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_START</td>
<td style="text-align:center">游戏手柄按钮 Start</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_THUMBL</td>
<td style="text-align:center">Left Thumb Button</td>
</tr>
<tr>
<td>KEYCODE_BUTTON_THUMBR</td>
<td style="text-align:center">Right Thumb Button</td>
</tr>
</tbody>
</table>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> KeyCode </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android中键盘的一些小tip]]></title>
      <url>/2017/05/13/Android%E4%B8%AD%E9%94%AE%E7%9B%98%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8Ftip/</url>
      <content type="html"></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Android原生的夜间模式]]></title>
      <url>/2017/04/28/Android%E5%8E%9F%E7%94%9F%E7%9A%84%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[RxJava 教程第一部分：入门之 关键的类]]></title>
      <url>/2017/04/28/RxJava%20%E6%95%99%E7%A8%8B%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A%E5%85%A5%E9%97%A8%E4%B9%8B%20%E5%85%B3%E9%94%AE%E7%9A%84%E7%B1%BB/</url>
      <content type="html"><![CDATA[<p>Rx 有两个最基础的类型，和其他一些扩展这两种类型的类。两个核心的类为： Observable 和 Observer。Subject 是同时继承了 Observable 和 Observer。</p>
<p>Rx 是在 Observer 模式之上建立起来的。这种模式很常见，在 Java中有很多地方都使用了该模式，比如 JavaFx 中的 EventHandler。 这些简单的使用方式和 Rx 对比有如下区别：</p>
<ul>
<li>使用 event handler 来处理事件很难组合使用</li>
<li>无法延时处理查询事件</li>
<li>可能会导致内存泄露</li>
<li>没有标准的标示完成的方式</li>
<li>需要手工的来处理并行和多线程</li>
</ul>
<h3 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h3><p>Observable 是第一个核心类。该类包含了 Rx 中的很多实现，以及所有核心的操作函数（operator、或者说 操作符）。在本系列教程中会逐步介绍每个操作函数。现在我们只需要理解 subscribe 函数即可，下面是该函数的一种定义：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public final Subscription subscribe(Subscriber&lt;? super T&gt; subscriber)</div></pre></td></tr></table></figure></p>
<p>该函数是用来接收 observable 发射的事件的。当事件被发射后，他们就丢给了 subscriber， subscriber 是用来处理事件的实现。这里的 Subscriber 参数实现了 Observer 接口。</p>
<p>一个 Observable 发射 三种类型的事件：</p>
<ul>
<li>Values （数据）</li>
<li>完成状态，告诉 Subscriber 事件（数据） 发射完毕，没有其他数据了</li>
<li>Error， 错误状态，如果在发射数据的过程中出现错误了。会发送该事件。</li>
</ul>
<h3 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h3><p>Subscriber 是 Observer 的一个实现。 Subscriber 实现了其他一些额外的功能，可以作为我们实现 Observer 的基类。现在先看看 Observer 的接口定义：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">interface Observer&lt;T&gt; &#123; void onCompleted(); void onError(java.lang.Throwable e); void onNext(T t);&#125;</div></pre></td></tr></table></figure></p>
<p>每次 Observable 发射事件的时候就会执行这三个对应的函数。Observer 的 onNext 函数会被调用0次或者多次，然后会调用 onCompleted 或者 onError。在 onCompleted 或者 onError 发生以后就不会再有其他事件发射出来了。</p>
<p>在使用 Rx 开发的过程中，你会看到很多 Observable，但是 Observer 出场的时候很少。但是理解 Observer 的概念是非常重要的，虽然有很多简写方式来帮助更加简洁的使用 Observer。</p>
<h3 id="实现-Observable-和-Observer"><a href="#实现-Observable-和-Observer" class="headerlink" title="实现 Observable 和 Observer"></a>实现 Observable 和 Observer</h3><p>你可以手工的实现 Observer 或者扩展 Observable。 在真实场景中并不需要这样做，Rx 已经提供了很多可以直接使用的工厂方法了。使用 Rx 提供的工具来创建 Observable 和 Observer 比手工实现要更加安全和简洁。</p>
<p>要订阅到一个 Observable，并不需要提供一个 Observer 示例。subscribe 函数有各种重载方法可以使用，你可以只订阅 onNext 事件，有可以只订阅 onError 事件，这样就不用提供 Observer 对象就可以接受事件了。每次只需要提供你关心的函数即可，例如 如果你不关心 error 和完成事件，则只提供 onNext 来接收每次发送的数据即可。</p>
<p>配合 Java 8 的 Lambda 表达式则使用起来代码看起来会更加简洁，所以本系列示例代码会使用 lambda 表达式，如果你不了解的话，可以先看看掌握 Java 8 Lambda 表达式。</p>
<h3 id="Subject"><a href="#Subject" class="headerlink" title="Subject"></a>Subject</h3><p>Subject 是 Observable 的一个扩展，同时还实现了 Observer 接口。第一眼看上去可能有点奇怪，但是在有些场合下使用 Subject 将会非常便捷。他们可以像 Observer 一样接收事件，同时还可以像 Observable 一样把接收到的事件再发射出去。这种特性非常适合 Rx 中的接入点，当你的事件来至于 Rx 框架之外的代码的时候，你可以把这些数据先放到 Subject 中，然后再把 Subject转换为一个<br>Observable，就可以在 Rx 中使用它们了。你可以把 Subject 当做 Rx 中的 事件管道。</p>
<p>Subject 有两个参数类型：输入参数和输出参数。这样设计是为了抽象而不是应为使用 Subject 是为了转换数据类型。转换数据应该使用转换操作函数来完成，后面我们将介绍各种操作函数。<br>Subject 有各种不同的具体实现。下面将介绍一些非常重要的实现以及他们之间的区别。</p>
<h3 id="PublishSubject"><a href="#PublishSubject" class="headerlink" title="PublishSubject"></a>PublishSubject</h3><p>PublishSubject 是最直接的一个 Subject。当一个数据发射到 PublishSubject 中时，PublishSubject 将立刻把这个数据发射到订阅到该 subject 上的所有 subscriber 中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) &#123;</div><div class="line">   PublishSubject&lt;Integer&gt; subject = PublishSubject.create(); </div><div class="line">   subject.onNext(1);</div><div class="line">   subject.subscribe(System.out::println);  </div><div class="line">   subject.onNext(2);</div><div class="line">   subject.onNext(3);</div><div class="line">   subject.onNext(4);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td></tr></table></figure></p>
<blockquote>
<p>上面的 System.out::println 是 Lambda 表达式中的函数引用，如果表达式代码块只有一个函数调用，则可以直接使用函数引用来简化代码</p>
</blockquote>
<p>可以看到，数据 1 并没有打印出来，原因是当我们订阅到 subject 的时候，1 已经发射出去了。当订阅到 subject 后就开始接收 发射到 subject 中的数据了。</p>
<p>这是我们初次看到如何使用 subscribe 函数，值得详细研究下是如何用的。 这里我们使用了一个重载的参数只有一个 Function 类型。这个参数 Function 接收一个参数 Integer 并且没有返回值。 没有返回值的 Function 在 Rx 中被称之为 action。 可以使用下面几种方式来提供这个 Function：</p>
<ul>
<li>提供一个 Action1 的实现对象</li>
<li>使用 Lambda 表达式 实现</li>
<li>使用符合该接口定义类型的 Lambda 表达式函数引用。这里 System.out::println 函数可以接受一个 Object 对象，符合 Action 的定义（接受一个参数并没有返回值），所以我们可以把该函数作为函数应用使用。 subscribe 将会使用他收到的值作为 println 函数的参数来调用 println 函数。</li>
</ul>
<h3 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a>ReplaySubject</h3><p>ReplaySubject 可以缓存所有发射给他的数据。当一个新的订阅者订阅的时候，缓存的所有数据都会发射给这个订阅者。 由于使用了缓存，所以每个订阅者都会收到所以的数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ReplaySubject&lt;Integer&gt; s = ReplaySubject.create(); </div><div class="line">s.subscribe(v -&gt; System.out.println(&quot;Early:&quot; + v));</div><div class="line">s.onNext(0);</div><div class="line">s.onNext(1);</div><div class="line">s.subscribe(v -&gt; System.out.println(&quot;Late: &quot; + v));</div><div class="line">s.onNext(2);</div></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Early:0</div><div class="line">Early:1</div><div class="line">Late: 0</div><div class="line">Late: 1</div><div class="line">Early:2</div><div class="line">Late: 2</div></pre></td></tr></table></figure></p>
<p>不管是何时订阅的，每个订阅者都收到了所有的数据。注意后一个订阅者在处理 2 之前就先收到了之前发射的数据 0和1.</p>
<p>缓存所有的数据并不是一个十分理想的情况，如果 Observable 事件流运行很长时间，则缓存所有的数据会消耗很多内存。可以限制缓存数据的数量和时间。 ReplaySubject.createWithSize 限制缓存多少个数据；而 ReplaySubject.createWithTime 限制一个数据可以在缓存中保留多长时间。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ReplaySubject&lt;Integer&gt; s ReplaySubject.createWithSize(2);</div><div class="line">s.onNext(0);</div><div class="line">s.onNext(1);</div><div class="line">s.onNext(2);</div><div class="line">s.subscribe(v -&gt; System.out.println(&quot;Late: &quot; + v));</div><div class="line">s.onNext(3);</div></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Late: 1</div><div class="line">Late: 2</div><div class="line">Late: 3</div></pre></td></tr></table></figure></p>
<p>由于指定只缓存两个数据，所以当订阅的时候第一个数据 0 就收不到了。 限制缓存的时间也是一样的情况：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">ReplaySubject&lt;Integer&gt; s = ReplaySubject.createWithTime(150, TimeUnit.MILLISECONDS, Schedulers.immediate());</div><div class="line">s.onNext(0);</div><div class="line">Thread.sleep(100);</div><div class="line">s.onNext(1);</div><div class="line">Thread.sleep(100);</div><div class="line">s.onNext(2);</div><div class="line">s.subscribe(v -&gt; System.out.println(&quot;Late: &quot; + v));</div><div class="line">s.onNext(3);</div></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Late: 1</div><div class="line">Late: 2</div><div class="line">Late: 3</div></pre></td></tr></table></figure></p>
<p>使用时间缓存创建 ReplaySubject 需要指定一个 Scheduler， Scheduler 是 Rx 中保持时间的方式。现在可以假装他不存在，不用关心他。<br>ReplaySubject.createWithTimeAndSize 则可以同时限制时间和个数。</p>
<h3 id="BehaviorSubject"><a href="#BehaviorSubject" class="headerlink" title="BehaviorSubject"></a>BehaviorSubject</h3><p>BehaviorSubject 只保留最后一个值。 等同于限制 ReplaySubject 的个数为 1 的情况。在创建的时候可以指定一个初始值，这样可以确保党订阅者订阅的时候可以立刻收到一个值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">BehaviorSubject&lt;Integer&gt; s = BehaviorSubject.create();</div><div class="line">s.onNext(0);</div><div class="line">s.onNext(1);</div><div class="line">s.onNext(2);</div><div class="line">s.subscribe(v -&gt; System.out.println(&quot;Late: &quot; + v));</div><div class="line">s.onNext(3);</div></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Late: 2</div><div class="line">Late: 3</div></pre></td></tr></table></figure></p>
<p>下面的示例只是打印出 Completed， 由于最后一个事件就是 Completed。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">BehaviorSubject&lt;Integer&gt; s = BehaviorSubject.create();</div><div class="line">s.onNext(0);</div><div class="line">s.onNext(1);</div><div class="line">s.onNext(2);</div><div class="line">s.onCompleted();</div><div class="line">s.subscribe(</div><div class="line">  v -&gt; System.out.println(&quot;Late: &quot; + v), </div><div class="line">  e -&gt; System.out.println(&quot;Error&quot;),</div><div class="line"> () -&gt; System.out.println(&quot;Completed&quot;));</div></pre></td></tr></table></figure></p>
<blockquote>
<p>这里使用了 subscribe 函数的另外一种重载形式，接受三个参数。</p>
</blockquote>
<p>下面使用了默认初始化值，如果订阅者的发射数据之前就订阅了，则会收到这个初始化的值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">BehaviorSubject&lt;Integer&gt; s = BehaviorSubject.create(0);</div><div class="line">s.subscribe(v -&gt; System.out.println(v));</div><div class="line">s.onNext(1);</div></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">0</div><div class="line">1</div></pre></td></tr></table></figure></p>
<p>由于 BehaviorSubject 的定义就是总是有可用的数据，所以一般都会使用初始化值来创建 BehaviorSubject 。</p>
<h3 id="AsyncSubject"><a href="#AsyncSubject" class="headerlink" title="AsyncSubject"></a>AsyncSubject</h3><p>AsyncSubject 也缓存最后一个数据。区别是 AsyncSubject 只有当数据发送完成时（onCompleted 调用的时候）才发射这个缓存的最后一个数据。可以使用 AsyncSubject 发射一个数据并立刻结束。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">AsyncSubject&lt;Integer&gt; s = AsyncSubject.create();</div><div class="line">s.subscribe(v -&gt; System.out.println(v));</div><div class="line">s.onNext(0);</div><div class="line">s.onNext(1);</div><div class="line">s.onNext(2);</div><div class="line">s.onCompleted();</div></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2</div></pre></td></tr></table></figure></p>
<p>如果上面的示例不调用 s.onCompleted(); 则什么结果都不会打印出来。</p>
<h3 id="隐含的规则"><a href="#隐含的规则" class="headerlink" title="隐含的规则"></a>隐含的规则</h3><p>Rx 中有一些隐含的规则在代码中并不太容易看到。一个重要的规则就是当一个事件流结束（onError 或者 onCompleted 都会导致事件流结束）后就不会发射任何数据了。这些 Subject 的实现都遵守这个规则，subscribe 函数也拒绝违反该规则的情况。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Subject&lt;Integer, Integer&gt; s = ReplaySubject.create();</div><div class="line">s.subscribe(v -&gt; System.out.println(v));</div><div class="line">s.onNext(0);</div><div class="line">s.onCompleted();</div><div class="line">s.onNext(1);</div><div class="line">s.onNext(2);</div></pre></td></tr></table></figure></p>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0</div></pre></td></tr></table></figure></p>
<p>但是在 Rx 实现中并没有完全确保这个规则，所以你在使用 Rx 的过程中要注意遵守该规则，否则会出现意料不到的情况。</p>
<p>本文出自 云在千峰 <a href="http://blog.chengyunfeng.com/?p=948" target="_blank" rel="external">http://blog.chengyunfeng.com/?p=948</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Rxjava </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ContentProvider入门]]></title>
      <url>/2017/04/22/ContentProvider%E5%85%A5%E9%97%A8/</url>
      <content type="html"><![CDATA[<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>1.什么是Content Provider(内容提供器)</p>
<blockquote>
<p>Content Provider主要用于在不同的应用程序之间实现数据共享的功能，它提供了一套完整的机制，允许一个应用程序访问另一个程序中的数据，还能保证被访问数据的安全性。</p>
</blockquote>
<p>2.ContentResolver简介</p>
<blockquote>
<p>Content providers是以类似数据库中表的方式将数据暴露。它提供了一系列方法用于对数据进行CRUD操作，其中insert()方法用于添加数据，delete()方法用于删除数据，update()方法用于更新数据，query()方法用于查询数据。它进行CRUD的时候是以Uri参数进行的。</p>
</blockquote>
<p>3.什么是Uri</p>
<blockquote>
<p>Uri一般由四部分组成。</p>
<ul>
<li>前缀 固定格式为”content://“</li>
<li>标识 为了唯一性，一般使用应用程序的包名来表示</li>
<li>表名 例如”content://com.example.demo/user”</li>
<li>如果Uri中含有某一条记录的id，则可以这样表示”content://com.example.demo/user/1”，代表访问user表中id为1的那一条数据</li>
</ul>
<p>因为内容Uri的格式只有两种，有id和没id，所以我们可以用通配符来匹配这两种格式所有的Uri</p>
<ul>
<li>*：表示匹配任意长度的任意字符。</li>
<li>#： 表示匹配任意长度的数字。<br>所以一个能够匹配任意表内容的Uri就可以写成”content://com.example.demo/*”。<br>所以一个能够匹配sser表任意一条数据的Uri就可以写成”content://com.example.demo/user/#”。</li>
</ul>
</blockquote>
<p>4.什么是UriMatcher</p>
<blockquote>
<p>是一个工具类，专门用来匹配Uri，主要方法有两个</p>
<ul>
<li>addURI<br>这个方法接受3个参数，分别把authority、path和一个自定义代码传进去。<br>authority一般为包名，path为表名。</li>
<li>match<br>这个方法接受Uri作为参数，返回能够匹配这个Uri对象所对应的自定义代码，利用这个代码，我们可以判断调用者希望访问的是哪张表。</li>
</ul>
</blockquote>
<h3 id="编码实现"><a href="#编码实现" class="headerlink" title="编码实现"></a>编码实现</h3><p>1.创建内容提供器的步骤<br>新建一个ProviderDemo项目和新建一个类，继承自ContentProvider。重写它的子类方法。<br>android studio用户可以直接使用new -&gt; other -&gt; Content Provider实现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line">public class MyContentProvider extends ContentProvider &#123;</div><div class="line"></div><div class="line">    public static final int USER_DIR = 0;</div><div class="line">	</div><div class="line">    public static final int USER_ITEM = 1;</div><div class="line"></div><div class="line">    public static final String AUTHORITY = &quot;com.example.changqin.provider&quot;;</div><div class="line"></div><div class="line">    private DbHelper mDbHelper;</div><div class="line"></div><div class="line">    private static UriMatcher uriMatcher;</div><div class="line"></div><div class="line">    static &#123;</div><div class="line">        uriMatcher = new UriMatcher(UriMatcher.NO_MATCH);</div><div class="line">        uriMatcher.addURI(AUTHORITY, &quot;user&quot;, USER_DIR);</div><div class="line">        uriMatcher.addURI(AUTHORITY, &quot;user/#&quot;, USER_ITEM);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public boolean onCreate() &#123;</div><div class="line">        mDbHelper = new DbHelper(getContext(), &quot;school&quot;, null, 1);</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public MyContentProvider() &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public String getType(Uri uri) &#123;</div><div class="line">        switch (uriMatcher.match(uri)) &#123;</div><div class="line">            case USER_DIR:</div><div class="line">                return &quot;vnd.android.cursor.dir/cnd.com.example.changqin.provider.user&quot;;</div><div class="line">            case USER_ITEM:</div><div class="line">                return &quot;vnd.android.cursor.item/cnd.com.example.changqin.provider.user&quot;;</div><div class="line">        &#125;</div><div class="line">        return null;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public int delete(Uri uri, String selection, String[] selectionArgs) &#123;</div><div class="line">        SQLiteDatabase db = mDbHelper.getWritableDatabase();</div><div class="line">        int result = 0;</div><div class="line">        switch (uriMatcher.match(uri)) &#123;</div><div class="line">            case USER_DIR:</div><div class="line">                result = db.delete(&quot;user&quot;, selection, selectionArgs);</div><div class="line">                break;</div><div class="line">            case USER_ITEM:</div><div class="line">                String id = uri.getPathSegments().get(1);</div><div class="line">                result = db.delete(&quot;user&quot;, &quot;id=?&quot;, new String[]&#123;id&#125;);</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public Uri insert(Uri uri, ContentValues values) &#123;</div><div class="line">        SQLiteDatabase db = mDbHelper.getWritableDatabase();</div><div class="line">        Uri uriReturn = null;</div><div class="line">        switch (uriMatcher.match(uri)) &#123;</div><div class="line">            case USER_DIR:</div><div class="line">            case USER_ITEM:</div><div class="line">                long newUserId = db.insert(&quot;user&quot;, null, values);</div><div class="line">                uriReturn = Uri.parse(&quot;content://&quot; + AUTHORITY + &quot;/user/&quot; + newUserId);</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        return uriReturn;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public Cursor query(Uri uri, String[] projection, String selection,</div><div class="line">                        String[] selectionArgs, String sortOrder) &#123;</div><div class="line">        SQLiteDatabase db = mDbHelper.getReadableDatabase();</div><div class="line">        Cursor cursor = null;</div><div class="line">        switch (uriMatcher.match(uri)) &#123;</div><div class="line">            case USER_DIR:</div><div class="line">                cursor = db.query(&quot;user&quot;, projection, selection, selectionArgs, null, null, sortOrder);</div><div class="line">                break;</div><div class="line">            case USER_ITEM:</div><div class="line">                String userId = uri.getPathSegments().get(1);</div><div class="line">                cursor = db.query(&quot;user&quot;, projection, &quot;id=?&quot;, new String[]&#123;userId&#125;, null, null, sortOrder);</div><div class="line">                break;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        return cursor;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public int update(Uri uri, ContentValues values, String selection,</div><div class="line">                      String[] selectionArgs) &#123;</div><div class="line">        SQLiteDatabase db = mDbHelper.getWritableDatabase();</div><div class="line">        int result = 0;</div><div class="line">        switch (uriMatcher.match(uri)) &#123;</div><div class="line">            case USER_DIR:</div><div class="line">                result = db.update(&quot;user&quot;, values, selection, selectionArgs);</div><div class="line">            case USER_ITEM:</div><div class="line">                String id = uri.getPathSegments().get(1);</div><div class="line">                result = db.update(&quot;user&quot;, values, &quot;id=?&quot;, new String[]&#123;id&#125;);</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.query方法解释，其他同理<br>因为我们已经创建过数据库了，在query方法中，获取SQLiteDatabase的实例，然后用uriMatcher.match(uri)方法可以进行判断，用户希望访问的是哪一张表，然后按照数据库的方法，进行查询，然后返回Cursor就可以了。</p>
<blockquote>
<p>uri.getPathSegments().get(1)<br>这个方法返回的是一个List<string>，例如我们请求的Uri是”content://com.example.demo/user/1”，这个方法会将最后一个”/“后面的数据进行list存储，所以上面方法get(1)取得的就是<strong>1</strong>这个id。</string></p>
</blockquote>
<p>3.附DbHelper类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">public class DbHelper extends SQLiteOpenHelper &#123;</div><div class="line">    private static final String CREATE_USER = &quot;create table user (&quot;</div><div class="line">            + &quot;id integer primary key autoincrement ,&quot;</div><div class="line">            + &quot; username text,&quot;</div><div class="line">            + &quot;password text&quot;</div><div class="line">            + &quot;)&quot;;</div><div class="line">    private static String user0 = &quot;insert into user(username,password)values(&apos;wcq&apos;,&apos;qqq&apos;)&quot;;</div><div class="line">    private static String user1 = &quot;insert into user(username,password)values(&apos;wcq123&apos;,&apos;qqq123&apos;)&quot;;</div><div class="line">    private static String user2 = &quot;insert into user(username,password)values(&apos;hyx&apos;,&apos;548&apos;)&quot;;</div><div class="line">    private static String user3 = &quot;insert into user(username,password)values(&apos;xhkda&apos;,&apos;7891&apos;)&quot;;</div><div class="line"></div><div class="line">    public DbHelper(Context context, String name, SQLiteDatabase.CursorFactory factory,</div><div class="line">                    int version) &#123;</div><div class="line">        super(context, name, factory, version);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void onCreate(SQLiteDatabase db) &#123;</div><div class="line">        db.execSQL(CREATE_USER);</div><div class="line"></div><div class="line">        db.execSQL(user0);</div><div class="line">        db.execSQL(user1);</div><div class="line">        db.execSQL(user2);</div><div class="line">        db.execSQL(user3);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void onUpgrade(SQLiteDatabase sqLiteDatabase, int i, int i1) &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4.创建ProviderTest项目，编写代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Button quary_data = (Button) findViewById(R.id.btn_query);</div><div class="line">        quary_data.setOnClickListener(new View.OnClickListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                Uri uri = Uri.parse(&quot;content://com.example.changqin.provider/user/1&quot;);</div><div class="line">                //Cursor cursor = getContentResolver().query(uri, null, &quot;id=?&quot;, new String[]&#123;&quot;1&quot;&#125;, null);</div><div class="line">                Cursor cursor = getContentResolver().query(uri, null, null, null, null);</div><div class="line">                if (cursor != null) &#123;</div><div class="line">                    while (cursor.moveToNext())&#123;</div><div class="line">                        int userId = cursor.getInt(0);</div><div class="line">                        String username = cursor.getString(1);</div><div class="line">                        String password = cursor.getString(2);</div><div class="line"></div><div class="line">                        Log.e(&quot;wcq&quot;,userId+&quot; &quot;+username+&quot; &quot;+password);</div><div class="line">                    &#125;</div><div class="line">                    cursor.close();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<p>查看控制台可以看到，我们成功的访问了ProviderDemo中数据库的数据。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2839845-2b5a6af212a66cb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p>5.其他的操作和查询差不多，基本入门知识就先讲解到这里。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> 四大组件 </tag>
            
        </tags>
        
    </entry>
    
  
  
    
  
</search>
